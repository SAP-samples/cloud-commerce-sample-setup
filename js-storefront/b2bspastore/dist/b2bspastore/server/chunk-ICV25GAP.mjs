import './polyfills.server.mjs';
import{g as w,h as kt,i as Vt,j as $t}from"./chunk-VWYMWH42.mjs";import"./chunk-FFOIH6LC.mjs";import{s as wt}from"./chunk-7XNR6YBG.mjs";import{c as Mt}from"./chunk-CGB7QI3H.mjs";import"./chunk-24RVCK6Y.mjs";import"./chunk-N2KSBNCQ.mjs";import"./chunk-YXEEZUH4.mjs";import"./chunk-B45L5KU2.mjs";import{C as yt,Ca as Lt,E as It,Ea as Ft,Na as bt,Qa as Tt,Ta as Pt,aa as Ct,b as ft,c as xt,d as At,e as ht,l as Dt,p as Et,pa as Rt,s as St,z as Ot}from"./chunk-A7Q3BSDL.mjs";import{$ as st,A as ae,Ga as ct,J as at,Ka as le,Lb as gt,Q as Pe,Sa as dt,Sb as we,Ta as vt,Tb as ke,V as g,Wa as M,X as pe,Za as q,_ as pt,_a as ce,ac as _t,db as mt,e as et,f as tt,g as re,h as K,i as it,ib as Me,j as rt,jb as ut,ka as lt,m as ne,mb as de,n as nt,o as oe,oa as se,p as ot,rc as ve,sc as Ve,y as Te}from"./chunk-HIT2747W.mjs";import{$a as y,$b as P,Aa as Q,Bc as Ye,Cc as h,Dc as Qe,Dd as te,Fa as S,Ga as L,Ia as z,Ic as p,Jc as s,Ka as f,Kc as Le,L as C,La as Je,Ld as ie,Nc as Fe,Pb as A,Qb as We,Ra as X,Rb as m,S as Y,Sa as F,Xb as c,Yb as l,Zb as V,_a as O,_b as T,_d as Xe,bc as $,dc as I,ec as u,j as ye,o as Ie,pc as Re,q as W,qc as d,rc as D,sc as v,ta as Ze,wb as o,x,xa as R,xb as b,xd as be,y as Ce,yd as ee}from"./chunk-PGJP43LT.mjs";import{a as G}from"./chunk-GHFNAT2I.mjs";var Xt=(t,e)=>({orderCode:t,orderTotal:e}),ei=t=>({label:t}),ti=()=>({cxRoute:"orderApprovals"});function ii(t,e){t&1&&(c(0,"div")(1,"div",3),V(2,"cx-spinner"),l()())}function ri(t,e){if(t&1&&(c(0,"div",7)(1,"div",8),d(2),p(3,"cxTranslate"),l()()),t&2){let n=u(3).ngIf,r=u();o(2),v(" ",Le(3,1,"orderApprovalDetails.form.title_"+r.approvalDecision,Qe(4,Xt,n==null||n.order==null?null:n.order.code,n==null||n.order==null||n.order.totalPriceWithTax==null?null:n.order.totalPriceWithTax.formattedValue))," ")}}function ni(t,e){if(t&1&&(V(0,"cx-form-errors",17),p(1,"cxTranslate")),t&2){let n=u(5);m("translationParams",h(4,ei,s(1,2,"orderApprovalDetails.form.comment_"+n.approvalDecision+".label")))("control",n.approvalForm.get("comment"))}}function oi(t,e){if(t&1&&V(0,"cx-form-errors",18),t&2){let n=u(5);m("control",n.approvalForm.get("comment"))}}function ai(t,e){if(t&1){let n=$();c(0,"form",9),I("ngSubmit",function(){O(n);let i=u(3).ngIf,a=u();return y(a.submitDecision(i))}),c(1,"label"),d(2),p(3,"cxTranslate"),V(4,"textarea",10),A(5,ni,2,6,"cx-form-errors",11)(6,oi,1,1,"cx-form-errors",12),l(),c(7,"div",13)(8,"div",14)(9,"button",15),I("click",function(){O(n);let i=u(4);return y(i.cancelDecisionForm())}),d(10),p(11,"cxTranslate"),l()(),c(12,"div",14)(13,"button",16),d(14),p(15,"cxTranslate"),l()()()()}if(t&2){let n=u(4);m("formGroup",n.approvalForm),o(2),v("",s(3,6,"orderApprovalDetails.form.comment_"+n.approvalDecision+".label")," "),o(3),m("cxFeature","formErrorsDescriptiveMessages"),o(),m("cxFeature","!formErrorsDescriptiveMessages"),o(4),v(" ",s(11,8,"orderApprovalDetails.form.cancel")," "),o(4),v(" ",s(15,10,"orderApprovalDetails.form.submit_"+n.approvalDecision)," ")}}function pi(t,e){if(t&1&&(T(0),A(1,ri,4,7,"div",5)(2,ai,16,12,"form",6),P()),t&2){let n=u(3);o(),m("ngIf",n.approvalFormVisible),o(),m("ngIf",n.approvalFormVisible)}}function si(t,e){if(t&1){let n=$();c(0,"div",19)(1,"button",22),I("click",function(){O(n);let i=u(4);return y(i.displayDecisionForm(i.approvalDecisionValue.REJECT))}),d(2),p(3,"cxTranslate"),l()()}t&2&&(o(2),v(" ",s(3,1,"orderApprovalDetails.showForm_REJECT")," "))}function li(t,e){if(t&1){let n=$();c(0,"div",19)(1,"button",22),I("click",function(){O(n);let i=u(4);return y(i.displayDecisionForm(i.approvalDecisionValue.APPROVE))}),d(2),p(3,"cxTranslate"),l()()}t&2&&(o(2),v(" ",s(3,1,"orderApprovalDetails.showForm_APPROVE")," "))}function ci(t,e){if(t&1&&(T(0),c(1,"div",13)(2,"div",19)(3,"a",20),p(4,"cxUrl"),d(5),p(6,"cxTranslate"),l()(),A(7,si,4,3,"div",21)(8,li,4,3,"div",21),l(),P()),t&2){let n=u(2).ngIf;o(3),m("routerLink",s(4,4,Ye(8,ti))),o(2),D(s(6,6,"orderApprovalDetails.back")),o(2),m("ngIf",n==null?null:n.approvalDecisionRequired),o(),m("ngIf",n==null?null:n.approvalDecisionRequired)}}function di(t,e){if(t&1&&(V(0,"div",4),p(1,"cxTranslate"),A(2,pi,3,2,"ng-container",1)(3,ci,9,9,"ng-container",1)),t&2){let n=u().ngIf,r=u();We("aria-label",s(1,3,"common.loaded")),o(2),m("ngIf",n==null?null:n.approvalDecisionRequired),o(),m("ngIf",!r.approvalFormVisible)}}function vi(t,e){if(t&1&&(T(0),A(1,ii,3,0,"div",2),p(2,"async"),A(3,di,4,5,"ng-template",null,0,Fe),P()),t&2){let n=Re(4),r=u();o(),m("ngIf",s(2,2,r.loading$))("ngIfElse",n)}}function mi(t,e){if(t&1&&(c(0,"tr")(1,"td",7)(2,"div",8),d(3),p(4,"cxTranslate"),l(),d(5),p(6,"cxTranslate"),l(),c(7,"td",9)(8,"div",8),d(9),p(10,"cxTranslate"),l(),d(11),l(),c(12,"td",10)(13,"div",8),d(14),p(15,"cxTranslate"),l(),d(16),l(),c(17,"td",11)(18,"div",8),d(19),p(20,"cxTranslate"),l(),d(21),p(22,"cxTranslate"),l()()),t&2){let n=e.$implicit;o(3),v(" ",s(4,8,"orderApprovalDetails.permissionResults.permission")," "),o(2),v(" ",s(6,10,"orderApprovalDetails.permissionResults.permissionType_"+(n==null||n.permissionType==null?null:n.permissionType.code))," "),o(4),v(" ",s(10,12,"orderApprovalDetails.permissionResults.approver")," "),o(2),v(" ",n.approverName," "),o(3),v(" ",s(15,14,"orderApprovalDetails.permissionResults.status")," "),o(2),v(" ",n.statusDisplay," "),o(3),v(" ",s(20,16,"orderApprovalDetails.permissionResults.approverComments")," "),o(2),v(" ",n.approverNotes?n.approverNotes:s(22,18,"orderApprovalDetails.permissionResults.noApprovalComments")," ")}}function ui(t,e){if(t&1&&(T(0),c(1,"div",1)(2,"div",2),d(3),p(4,"cxTranslate"),l()(),c(5,"table",3)(6,"thead",4)(7,"th",5),d(8),p(9,"cxTranslate"),l(),c(10,"th",5),d(11),p(12,"cxTranslate"),l(),c(13,"th",5),d(14),p(15,"cxTranslate"),l(),c(16,"th",5),d(17),p(18,"cxTranslate"),l()(),c(19,"tbody"),A(20,mi,23,20,"tr",6),l()(),P()),t&2){let n=u().ngIf;o(3),v(" ",s(4,6,"orderApprovalDetails.permissionResults.header")," "),o(5),v(" ",s(9,8,"orderApprovalDetails.permissionResults.permission")," "),o(3),v(" ",s(12,10,"orderApprovalDetails.permissionResults.approver")," "),o(3),v(" ",s(15,12,"orderApprovalDetails.permissionResults.status")," "),o(3),v(" ",s(18,14,"orderApprovalDetails.permissionResults.approverComments")," "),o(3),m("ngForOf",n.permissionResults)}}function gi(t,e){if(t&1&&(T(0),A(1,ui,21,16,"ng-container",0),P()),t&2){let n=e.ngIf;o(),m("ngIf",n.permissionResults==null?null:n.permissionResults.length)}}var B=t=>({approvalCode:t}),j=t=>({cxRoute:"orderApprovalDetails",params:t});function _i(t,e){if(t&1){let n=$();c(0,"tr",14),I("click",function(i){let a=O(n).$implicit,_=u(3);return y(_.goToApprovalDetails(i,a))}),c(1,"td",15)(2,"div",16),d(3),p(4,"cxTranslate"),l(),c(5,"a",17),p(6,"cxUrl"),d(7),l()(),c(8,"td",18)(9,"div",16),d(10),p(11,"cxTranslate"),l(),c(12,"a",17),p(13,"cxUrl"),d(14),p(15,"cxTranslate"),l()(),c(16,"td",19)(17,"div",16),d(18),p(19,"cxTranslate"),l(),c(20,"a",17),p(21,"cxUrl"),d(22),l()(),c(23,"td",20)(24,"div",16),d(25),p(26,"cxTranslate"),l(),c(27,"a",17),p(28,"cxUrl"),d(29),p(30,"cxDate"),l()(),c(31,"td",21)(32,"div",16),d(33),p(34,"cxTranslate"),l(),c(35,"a",17),p(36,"cxUrl"),d(37),p(38,"cxTranslate"),l()(),c(39,"td",22)(40,"div",16),d(41),p(42,"cxTranslate"),l(),c(43,"a",17),p(44,"cxUrl"),d(45),l()()()}if(t&2){let n=e.$implicit;o(3),v(" ",s(4,18,"orderApprovalList.orderCode")," "),o(2),m("routerLink",s(6,20,h(51,j,h(49,B,n==null?null:n.code)))),o(2),v(" ",n.order==null?null:n.order.code,""),o(3),v(" ",s(11,22,"orderApprovalList.POCode")," "),o(2),m("routerLink",s(13,24,h(55,j,h(53,B,n==null?null:n.code)))),o(2),D((n.order==null?null:n.order.purchaseOrderNumber)||s(15,26,"orderApprovalList.none")),o(4),v(" ",s(19,28,"orderApprovalList.placedBy")," "),o(2),m("routerLink",s(21,30,h(59,j,h(57,B,n==null?null:n.code)))),o(2),D(n.order==null||n.order.orgCustomer==null?null:n.order.orgCustomer.name),o(3),v(" ",s(26,32,"orderApprovalList.date")," "),o(2),m("routerLink",s(28,34,h(63,j,h(61,B,n==null?null:n.code)))),o(2),D(Le(30,36,n.order==null?null:n.order.created,"longDate")),o(4),v(" ",s(34,39,"orderApprovalList.status")," "),o(2),m("routerLink",s(36,41,h(67,j,h(65,B,n==null?null:n.code)))),o(2),v(" ",s(38,43,"orderDetails.statusDisplay_"+(n.order==null?null:n.order.statusDisplay)),""),o(4),v(" ",s(42,45,"orderApprovalList.total")," "),o(2),m("routerLink",s(44,47,h(71,j,h(69,B,n==null?null:n.code)))),o(2),v(" ",n.order==null||n.order.totalPrice==null?null:n.order.totalPrice.formattedValue,"")}}function fi(t,e){if(t&1){let n=$();T(0),c(1,"div",3)(2,"div",4)(3,"label")(4,"span",5),d(5),p(6,"cxTranslate"),l(),c(7,"cx-sorting",6),p(8,"async"),p(9,"cxTranslate"),I("sortListEvent",function(i){O(n);let a=u(2);return y(a.changeSortCode(i))}),l()()(),c(10,"div",7)(11,"cx-pagination",8),I("viewPageEvent",function(i){O(n);let a=u(2);return y(a.pageChange(i))}),l()()(),c(12,"table",9)(13,"caption",5),d(14),p(15,"cxTranslate"),l(),c(16,"thead",10)(17,"th",11),d(18),p(19,"cxTranslate"),l(),c(20,"th",11),d(21),p(22,"cxTranslate"),l(),c(23,"th",11),d(24),p(25,"cxTranslate"),l(),c(26,"th",11),d(27),p(28,"cxTranslate"),l(),c(29,"th",11),d(30),p(31,"cxTranslate"),l(),c(32,"th",11),d(33),p(34,"cxTranslate"),l()(),c(35,"tbody"),A(36,_i,46,73,"tr",12),l()(),c(37,"div",13)(38,"div",4)(39,"label")(40,"span",5),d(41),p(42,"cxTranslate"),l(),c(43,"cx-sorting",6),p(44,"async"),p(45,"cxTranslate"),I("sortListEvent",function(i){O(n);let a=u(2);return y(a.changeSortCode(i))}),l()()(),c(46,"div",7)(47,"cx-pagination",8),I("viewPageEvent",function(i){O(n);let a=u(2);return y(a.pageChange(i))}),l()()(),P()}if(t&2){let n=u().ngIf,r=u();o(5),D(s(6,20,"orderHistory.sortOrders")),o(2),m("sortOptions",n.sorts)("sortLabels",s(8,22,r.sortLabels$))("selectedOption",n.pagination.sort)("ariaLabel",s(9,24,"orderHistory.sortOrders")),o(4),m("pagination",n.pagination),o(3),v(" ",s(15,26,"orderApprovalList.orderApprovalList")," "),o(4),v(" ",s(19,28,"orderApprovalList.orderCode")," "),o(3),D(s(22,30,"orderApprovalList.POCode")),o(3),D(s(25,32,"orderApprovalList.placedBy")),o(3),D(s(28,34,"orderApprovalList.date")),o(3),v(" ",s(31,36,"orderApprovalList.status")," "),o(3),D(s(34,38,"orderApprovalList.total")),o(3),m("ngForOf",n.values),o(5),D(s(42,40,"orderHistory.sortOrders")),o(2),m("sortOptions",n.sorts)("sortLabels",s(44,42,r.sortLabels$))("selectedOption",n.pagination.sort)("ariaLabel",s(45,44,"orderHistory.sortOrders")),o(4),m("pagination",n.pagination)}}function xi(t,e){t&1&&(c(0,"div",23)(1,"div",24)(2,"div"),d(3),p(4,"cxTranslate"),l()()()),t&2&&(o(3),D(s(4,1,"orderApprovalList.emptyList")))}function Ai(t,e){if(t&1&&(T(0),A(1,fi,48,46,"ng-container",2)(2,xi,5,3,"ng-template",null,0,Fe),P()),t&2){let n=e.ngIf,r=Re(3);o(),m("ngIf",n.pagination&&n.pagination.totalResults&&n.pagination.totalResults>0)("ngIfElse",r)}}var $e=function(t){return t.APPROVE="APPROVE",t.REJECT="REJECT",t}($e||{}),Ee="order-approval",Se="order-approval-entities",Oe="order-approval-list",k="orderApproval.makeDecision",Be="[OrderApproval] Load OrderApproval Data",jt="[OrderApproval] Load OrderApproval Data Fail",je="[OrderApproval] Load OrderApproval Data Success",Ne="[OrderApproval] Load OrderApprovals",Nt="[OrderApproval] Load OrderApprovals Fail",Ue="[OrderApproval] Load OrderApprovals Success",Ge="[OrderApproval] Make OrderApproval Decision",Ut="[OrderApproval] Make OrderApproval Decision Fail",ze="[OrderApproval] Make OrderApproval Decision Success",Gt="[OrderApproval] Make OrderApproval Decision Reset",Z=class extends g.EntityLoadAction{constructor(e){super(Se,e.orderApprovalCode),this.payload=e,this.type=Be}},me=class extends g.EntityFailAction{constructor(e){super(Se,e.orderApprovalCode,e.error),this.payload=e,this.type=jt}},J=class extends g.EntitySuccessAction{constructor(e){super(Se,Array.isArray(e)?e.map(n=>n.code??""):e.code??""),this.payload=e,this.type=je}},ue=class extends g.EntityLoadAction{constructor(e){super(Oe,g.serializeSearchConfig(e.params)),this.payload=e,this.type=Ne}},ge=class extends g.EntityFailAction{constructor(e){super(Oe,g.serializeSearchConfig(e.params),e.error),this.payload=e,this.type=Nt}},_e=class extends g.EntitySuccessAction{constructor(e){super(Oe,g.serializeSearchConfig(e.params)),this.payload=e,this.type=Ue}},fe=class extends g.EntityLoadAction{constructor(e){super(q,k),this.payload=e,this.type=Ge}},xe=class extends g.EntityFailAction{constructor(e){super(q,k,e),this.payload=e,this.type=Ut}},Ae=class extends g.EntitySuccessAction{constructor(e){super(q,k),this.payload=e,this.type=ze}},he=class extends g.EntityLoaderResetAction{constructor(){super(q,k),this.type=Gt}},_r=Object.freeze({__proto__:null,LOAD_ORDER_APPROVAL:Be,LOAD_ORDER_APPROVALS:Ne,LOAD_ORDER_APPROVALS_FAIL:Nt,LOAD_ORDER_APPROVALS_SUCCESS:Ue,LOAD_ORDER_APPROVAL_FAIL:jt,LOAD_ORDER_APPROVAL_SUCCESS:je,LoadOrderApproval:Z,LoadOrderApprovalFail:me,LoadOrderApprovalSuccess:J,LoadOrderApprovals:ue,LoadOrderApprovalsFail:ge,LoadOrderApprovalsSuccess:_e,MAKE_DECISION:Ge,MAKE_DECISION_FAIL:Ut,MAKE_DECISION_RESET:Gt,MAKE_DECISION_SUCCESS:ze,MakeDecision:fe,MakeDecisionFail:xe,MakeDecisionReset:he,MakeDecisionSuccess:Ae}),zt=it(Ee),Ke=K(zt,t=>t[Ee]),Kt=K(Ke,t=>t&&t.entities),qt=t=>K(Kt,e=>g.entityLoaderStateSelector(e,t)),Ht=t=>K(Ke,e=>g.denormalizeSearch(e,t)),fr=Object.freeze({__proto__:null,getOrderApproval:qt,getOrderApprovalList:Ht,getOrderApprovalManagementState:Ke,getOrderApprovalState:zt,getOrderApprovalsState:Kt}),qe=(()=>{let e=class e{constructor(r,i){this.store=r,this.userIdService=i}loadOrderApproval(r){this.userIdService.takeUserId().subscribe(i=>this.store.dispatch(new Z({userId:i,orderApprovalCode:r})))}loadOrderApprovals(r){this.userIdService.takeUserId().subscribe(i=>this.store.dispatch(new ue({userId:i,params:r})))}getOrderApproval(r){return this.store.select(qt(r))}getOrderApprovalList(r){return this.store.select(Ht(r))}get(r){return this.getOrderApproval(r).pipe(Ie(ye),Q(i=>{i.loading||i.success||i.error||this.loadOrderApproval(r)}),C(i=>!!(i.success||i.error)),x(i=>i.value))}getOrderApprovalLoading(r){return this.getOrderApproval(r).pipe(x(i=>i.loading??!1))}getList(r){return this.getOrderApprovalList(r).pipe(Ie(ye),Q(i=>{i.loading||i.success||i.error||this.loadOrderApprovals(r)}),C(i=>!!(i.success||i.error)),x(i=>i.value))}makeDecision(r,i){this.userIdService.takeUserId().subscribe(a=>this.store.dispatch(new fe({userId:a,orderApprovalCode:r,orderApprovalDecision:i})))}getMakeDecisionResultLoading(){return this.store.pipe(re(ce.getProcessLoadingFactory(k)))}getMakeDecisionResultError(){return this.store.pipe(re(ce.getProcessErrorFactory(k)))}getMakeDecisionResultSuccess(){return this.store.pipe(re(ce.getProcessSuccessFactory(k)))}resetMakeDecisionProcessState(){this.store.dispatch(new he)}};e.\u0275fac=function(i){return new(i||e)(f(tt),f(st))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),H=(()=>{let e=class e{constructor(r,i){this.routingService=r,this.orderApprovalService=i,this.approvalCode$=this.routingService.getRouterState().pipe(x(a=>a.state.params.approvalCode)),this.orderApproval$=this.approvalCode$.pipe(C(a=>!!a),Q(a=>this.orderApprovalService.loadOrderApproval(a)),R(a=>this.orderApprovalService.get(a)),Ze({bufferSize:1,refCount:!0})),this.order$=this.orderApproval$.pipe(x(a=>a?.order))}getOrderApprovalCodeFromRoute(){return this.approvalCode$}getOrderDetails(){return this.order$}getOrderApproval(){return this.orderApproval$}};e.\u0275fac=function(i){return new(i||e)(f(se),f(qe))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),hi=(()=>{let e=class e{constructor(r,i,a){this.orderApprovalDetailService=r,this.orderApprovalService=i,this.fb=a,this.approvalDecisionValue=$e,this.approvalFormVisible=!1,this.approvalForm=this.fb.group({comment:[""]}),this.orderApprovalLoading$=this.orderApprovalDetailService.getOrderApprovalCodeFromRoute().pipe(R(_=>this.orderApprovalService.getOrderApprovalLoading(_))),this.decisionResultLoading$=this.orderApprovalService.getMakeDecisionResultLoading(),this.loading$=Ce([this.orderApprovalLoading$,this.decisionResultLoading$]).pipe(x(([_,E])=>_||E)),this.orderApproval$=this.orderApprovalDetailService.getOrderApproval(),this.orderApprovalService.resetMakeDecisionProcessState()}displayDecisionForm(r){this.approvalDecision=r,r===$e.APPROVE?this.approvalForm.controls.comment.clearValidators():this.approvalForm.controls.comment.setValidators([xt.required]),this.approvalFormVisible=!0}cancelDecisionForm(){this.approvalFormVisible=!1,this.approvalForm.reset()}submitDecision(r){this.approvalForm.valid?(this.orderApprovalService.makeDecision(r.code??"",{decision:this.approvalDecision,comment:this.approvalForm.controls.comment.value}),this.approvalFormVisible=!1):this.approvalForm.markAllAsTouched()}ngOnDestroy(){this.orderApprovalService.resetMakeDecisionProcessState()}};e.\u0275fac=function(i){return new(i||e)(b(H),b(qe),b(yt))},e.\u0275cmp=X({type:e,selectors:[["cx-order-approval-detail-form"]],decls:2,vars:3,consts:[["approvalFormTemplate",""],[4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"cx-spinner"],["role","status"],["class","cx-approval-form-header row",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"cx-approval-form-header","row"],[1,"cx-approval-form-label","col-sm-12"],[3,"ngSubmit","formGroup"],["rows","3","formControlName","comment","maxlength","255",1,"form-control"],[3,"translationParams","control",4,"cxFeature"],[3,"control",4,"cxFeature"],[1,"form-group","row"],[1,"col-lg-6","col-md-12"],["type","button",1,"btn","btn-block","btn-secondary",3,"click"],["type","submit",1,"btn","btn-block","btn-primary"],[3,"translationParams","control"],[3,"control"],[1,"col-lg-4","col-md-12"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],["class","col-lg-4 col-md-12",4,"ngIf"],[1,"btn","btn-block","btn-primary",3,"click"]],template:function(i,a){i&1&&(A(0,vi,5,4,"ng-container",1),p(1,"async")),i&2&&m("ngIf",s(1,1,a.orderApproval$))},dependencies:[Dt,ft,At,ht,Ot,Et,St,ee,Lt,Ct,Te,mt,te,ve,we],encapsulation:2,changeDetection:0});let t=e;return t})(),N=(()=>{let e=class e{constructor(r,i,a){this.userAccountFacade=r,this.routingService=i,this.globalMessageService=a}canActivate(){return this.userAccountFacade.get().pipe(C(r=>!!r&&Object.keys(r).length>0),x(r=>r?.roles),x(r=>{let i=Array.isArray(r)&&(r.includes(Pe.APPROVER)||r.includes(Pe.ADMIN));return i||(this.routingService.go({cxRoute:"home"}),this.globalMessageService.add({key:"orderApprovalGlobal.notification.noSufficientPermissions"},dt.MSG_TYPE_WARNING)),i}))}};e.\u0275fac=function(i){return new(i||e)(f(Mt),f(se),f(vt))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Bt=(()=>{let e=class e{constructor(r){this.orderDetailsService=r,this.order$=this.orderDetailsService.getOrderDetails()}};e.\u0275fac=function(i){return new(i||e)(b(w))},e.\u0275cmp=X({type:e,selectors:[["cx-order-detail-permission-results"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"cx-approval-header"],[1,"cx-approval-label"],[1,"table","table-striped","cx-approval-table"],[1,"cx-approval-thead-mobile"],["scope","col"],[4,"ngFor","ngForOf"],[1,"cx-approval-permissionCode"],[1,"cx-approval-table-label"],[1,"cx-approval-approverName"],[1,"cx-approval-statusDisplay"],[1,"cx-approval-approvalNotes"]],template:function(i,a){i&1&&(A(0,gi,2,1,"ng-container",0),p(1,"async")),i&2&&m("ngIf",s(1,1,a.order$))},dependencies:[be,ee,te,ve],encapsulation:2,changeDetection:0});let t=e;return t})(),Di=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=F({type:e}),e.\u0275inj=L({imports:[It,ie,Ve,ke,Ft,Rt,ae,Me.withConfig({cmsComponents:{OrderApprovalDetailTotalsComponent:{component:$t,providers:[{provide:w,useExisting:H}],guards:[M,N]},OrderApprovalDetailApprovalDetailsComponent:{component:Bt,providers:[{provide:w,useExisting:H}],guards:[M,N]},AccountOrderDetailsApprovalDetailsComponent:{component:Bt},OrderApprovalDetailShippingComponent:{component:kt,providers:[{provide:w,useExisting:H}],guards:[M,N]},OrderApprovalDetailItemsComponent:{component:Vt,providers:[{provide:w,useExisting:H}],guards:[M,N]},OrderApprovalDetailFormComponent:{component:hi,guards:[M,N]}}}),ut]});let t=e;return t})(),Ei=(()=>{let e=class e{constructor(r,i,a){this.routing=r,this.orderApprovalService=i,this.translation=a,this.PAGE_SIZE=5}ngOnInit(){this.fetchApprovalListPage({}),this.sortLabels$=Ce([this.translation.translate("sorting.date"),this.translation.translate("sorting.orderNumber")]).pipe(x(([r,i])=>({byDate:r,byOrderNumber:i})))}changeSortCode(r){let i={sort:r,currentPage:0};this.sortType=r,this.fetchApprovalListPage(i)}pageChange(r){let i={sort:this.sortType,currentPage:r};this.fetchApprovalListPage(i)}fetchApprovalListPage(r){r.pageSize=this.PAGE_SIZE,this.orderApprovalService.loadOrderApprovals(r),this.orderApprovals$=this.orderApprovalService.getList(r)}goToApprovalDetails(r,i){r?.target?.nodeName.toLowerCase()!=="a"&&this.routing.go({cxRoute:"orderApprovalDetails",params:{approvalCode:i.code}})}};e.\u0275fac=function(i){return new(i||e)(b(se),b(qe),b(gt))},e.\u0275cmp=X({type:e,selectors:[["cx-order-approval-list"]],decls:2,vars:3,consts:[["noOrder",""],[4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"cx-order-approval-sort","top","row"],[1,"cx-order-approval-form-group","form-group","col-sm-12","col-md-4","col-lg-4"],[1,"cx-visually-hidden"],["ariaControls","order-approval-table",3,"sortListEvent","sortOptions","sortLabels","selectedOption","ariaLabel"],[1,"cx-order-approval-pagination"],[3,"viewPageEvent","pagination"],["role","table","id","order-approval-table",1,"table","cx-order-approval-table"],[1,"cx-order-approval-thead-mobile"],["scope","col"],["role","row",3,"click",4,"ngFor","ngForOf"],[1,"cx-order-approval-sort","bottom","row"],["role","row",3,"click"],["role","cell",1,"cx-order-approval-code"],[1,"d-md-none","cx-order-approval-label"],[1,"cx-order-approval-value",3,"routerLink"],["role","cell",1,"cx-order-approval-po-code"],["role","cell",1,"cx-order-approval-placed"],["role","cell",1,"cx-order-approval-date"],["role","cell",1,"cx-order-approval-status"],["role","cell",1,"cx-order-approval-total"],[1,"cx-order-approval-no-order","row"],[1,"col-sm-12","col-md-6","col-lg-4"]],template:function(i,a){i&1&&(A(0,Ai,4,2,"ng-container",1),p(1,"async")),i&2&&m("ngIf",s(1,1,a.orderApprovals$))},dependencies:[be,ee,Te,bt,Tt,te,we,ve,_t],encapsulation:2,changeDetection:0});let t=e;return t})(),Si=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=F({type:e}),e.\u0275inj=L({imports:[ie,Me.withConfig({cmsComponents:{OrderApprovalListComponent:{component:Ei,guards:[M,N]}}}),ke,ae,Pt,Ve]});let t=e;return t})(),Oi=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=F({type:e}),e.\u0275inj=L({imports:[ae,Si,Di]});let t=e;return t})(),De=class{},Zt=(()=>{let e=class e{constructor(r){this.adapter=r}get(r,i){return this.adapter.load(r,i)}getList(r,i){return this.adapter.loadList(r,i)}makeDecision(r,i,a){return this.adapter.makeDecision(r,i,a)}};e.\u0275fac=function(i){return new(i||e)(f(De))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),He=new z("OrderApprovalNormalizer"),Jt=new z("OrderApprovalsListNormalizer"),Wt=new z("OrderApprovalDecisionNormalizer"),yi=(()=>{let e=class e{constructor(r,i,a){this.http=r,this.occEndpoints=i,this.converter=a}load(r,i){return this.http.get(this.getOrderApprovalEndpoint(r,i)).pipe(this.converter.pipeable(He))}loadList(r,i){return this.http.get(this.getOrderApprovalsEndpoint(r,i)).pipe(this.converter.pipeable(Jt))}makeDecision(r,i,a){return this.http.post(this.getOrderApprovalDecisionEndpoint(r,i),a).pipe(this.converter.pipeable(Wt))}getOrderApprovalEndpoint(r,i){return this.occEndpoints.buildUrl("orderApproval",{urlParams:{userId:r,orderApprovalCode:i}})}getOrderApprovalsEndpoint(r,i){return this.occEndpoints.buildUrl("orderApprovals",{urlParams:{userId:r},queryParams:i})}getOrderApprovalDecisionEndpoint(r,i){return this.occEndpoints.buildUrl("orderApprovalDecision",{urlParams:{userId:r,orderApprovalCode:i}})}};e.\u0275fac=function(i){return new(i||e)(f(Xe),f(ct),f(de))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),Ii=(()=>{let e=class e{constructor(){}convert(r,i){return i===void 0&&(i=G({},r)),i}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Ci=(()=>{let e=class e{constructor(r){this.converter=r}convert(r,i){return i===void 0&&(i=G({},r)),i.values=r.orderApprovals?.map(a=>G({},this.converter.convert(a,He)))??[],i}};e.\u0275fac=function(i){return new(i||e)(f(de))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Ri=(()=>{let e=class e{constructor(r){this.converter=r}convert(r,i){return i===void 0&&(i=G({},r)),r.order&&(i.order=this.converter.convert(r.order,wt)),i}};e.\u0275fac=function(i){return new(i||e)(f(de))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Li={backend:{occ:{endpoints:{orderApprovals:"/users/${userId}/orderapprovals",orderApproval:"/users/${userId}/orderapprovals/${orderApprovalCode}?fields=FULL",orderApprovalDecision:"/users/${userId}/orderapprovals/${orderApprovalCode}/decision"}}}},Fi=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=F({type:e}),e.\u0275inj=L({providers:[at(Li),{provide:De,useClass:yi},{provide:He,useExisting:Ri,multi:!0},{provide:Jt,useExisting:Ci,multi:!0},{provide:Wt,useExisting:Ii,multi:!0}],imports:[ie]});let t=e;return t})(),bi=(()=>{let e=class e{constructor(r,i){this.actions$=r,this.orderApprovalConnector=i,this.logger=Je(lt),this.loadOrderApproval$=ne(()=>this.actions$.pipe(oe(Be),x(a=>a.payload),C(a=>a.userId!==pe),R(({userId:a,orderApprovalCode:_})=>this.orderApprovalConnector.get(a,_).pipe(x(E=>new J([E])),Y(E=>W(new me({orderApprovalCode:_,error:le(E,this.logger)}))))))),this.loadOrderApprovals$=ne(()=>this.actions$.pipe(oe(Ne),x(a=>a.payload),C(a=>a.userId!==pe),R(({userId:a,params:_})=>this.orderApprovalConnector.getList(a,_).pipe(R(E=>{let{values:U,page:Qt}=g.normalizeListPage(E,"code");return[new J(U),new _e({page:Qt,params:_})]}),Y(E=>W(new ge({params:_,error:le(E,this.logger)}))))))),this.makeDecision$=ne(()=>this.actions$.pipe(oe(Ge),x(a=>a.payload),C(a=>a.userId!==pe),R(({userId:a,orderApprovalCode:_,orderApprovalDecision:E})=>this.orderApprovalConnector.makeDecision(a,_,E).pipe(R(U=>[new Ae({orderApprovalCode:_,orderApprovalDecision:U}),new Z({userId:a,orderApprovalCode:_})]),Y(U=>W(new xe({orderApprovalCode:_,error:le(U,this.logger)})))))))}};e.\u0275fac=function(i){return new(i||e)(f(nt),f(Zt))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),Ti=[bi],Pi=void 0,Mi=void 0;function wi(t=Pi,e){switch(e.type){case je:return e.payload;case ze:return t}return t}function ki(t=Mi,e){switch(e.type){case Ue:return e.payload.page}return t}function Vi(){return{[Ee]:et({entities:g.entityLoaderReducer(Se,wi),list:g.entityLoaderReducer(Oe,ki)})}}var Yt=new z("OrganizationReducers"),$i={provide:Yt,useFactory:Vi};function Bi(t){return function(e,n){return n.type===pt.LOGOUT&&(e=void 0),t(e,n)}}var ji=[Bi],Ni=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=F({type:e}),e.\u0275inj=L({providers:[$i],imports:[rt.forFeature(Ee,Yt,{metaReducers:ji}),ot.forFeature(Ti)]});let t=e;return t})(),Ui=(()=>{let e=class e{static forRoot(){return{ngModule:e,providers:[Zt]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=F({type:e}),e.\u0275inj=L({imports:[Ni]});let t=e;return t})(),xr=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=F({type:e}),e.\u0275inj=L({imports:[Ui.forRoot(),Fi,Oi]});let t=e;return t})();export{N as ApproverGuard,Jt as ORDER_APPROVALS_NORMALIZER,Wt as ORDER_APPROVAL_DECISION_NORMALIZER,Se as ORDER_APPROVAL_ENTITIES,Ee as ORDER_APPROVAL_FEATURE,Oe as ORDER_APPROVAL_LIST,k as ORDER_APPROVAL_MAKE_DECISION_PROCESS_ID,He as ORDER_APPROVAL_NORMALIZER,yi as OccOrderApprovalAdapter,Ii as OccOrderApprovalDecisionNormalizer,Ci as OccOrderApprovalListNormalizer,Ri as OccOrderApprovalNormalizer,_r as OrderApprovalActions,De as OrderApprovalAdapter,Oi as OrderApprovalComponentsModule,Zt as OrderApprovalConnector,$e as OrderApprovalDecisionValue,hi as OrderApprovalDetailFormComponent,H as OrderApprovalDetailService,Di as OrderApprovalDetailsModule,Ei as OrderApprovalListComponent,Si as OrderApprovalListModule,xr as OrderApprovalModule,Fi as OrderApprovalOccModule,fr as OrderApprovalSelectors,qe as OrderApprovalService,Bt as OrderDetailPermissionResultsComponent};
