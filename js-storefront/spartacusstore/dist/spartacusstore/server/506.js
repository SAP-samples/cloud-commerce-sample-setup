"use strict";var __defProp=Object.defineProperty,__name=(target,value)=>__defProp(target,"name",{value,configurable:!0});exports.id=506,exports.ids=[506],exports.modules={3506:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{UserProfileWrapperModule:()=>UserProfileWrapperModule});var core=__webpack_require__(4650),spartacus_cdc_root=__webpack_require__(2700),spartacus_core=__webpack_require__(1742),common=__webpack_require__(6895),router=__webpack_require__(610),spartacus_storefront=__webpack_require__(9764),BehaviorSubject=__webpack_require__(591),Subscription=__webpack_require__(2654),combineLatest=__webpack_require__(6053),first=__webpack_require__(7224),take=__webpack_require__(2986),tap=__webpack_require__(2994),map=__webpack_require__(4850),filter=__webpack_require__(2198),switchMap=__webpack_require__(7545),spartacus_user_profile_root=__webpack_require__(2274),fesm2020_forms=__webpack_require__(4006),ng_select_ng_select=__webpack_require__(7039);function CloseAccountModalComponent_ng_container_0_div_11_Template(rf,ctx){1&rf&&(core.TgZ(0,"div")(1,"div",10),core._UZ(2,"cx-spinner"),core.qZA()())}function CloseAccountModalComponent_ng_container_0_ng_template_13_Template(rf,ctx){if(1&rf){const _r5=core.EpF();core.TgZ(0,"div",11)(1,"p",12),core._uU(2),core.ALo(3,"cxTranslate"),core.qZA()(),core.TgZ(4,"div",13)(5,"button",14),core.NdJ("click",__name(function(){core.CHM(_r5);const ctx_r4=core.oxw(2);return core.KtG(ctx_r4.closeAccount())},"CloseAccountModalComponent_ng_container_0_ng_template_13_Template_button_click_5_listener")),core._uU(6),core.ALo(7,"cxTranslate"),core.qZA(),core.TgZ(8,"button",15),core.NdJ("click",__name(function(){core.CHM(_r5);const ctx_r6=core.oxw(2);return core.KtG(ctx_r6.dismissModal("Cancel"))},"CloseAccountModalComponent_ng_container_0_ng_template_13_Template_button_click_8_listener")),core._uU(9),core.ALo(10,"cxTranslate"),core.qZA()()}2&rf&&(core.xp6(2),core.hij(" ",core.lcZ(3,3,"closeAccount.confirmAccountClosureMessage")," "),core.xp6(4),core.hij(" ",core.lcZ(7,5,"closeAccount.closeMyAccount")," "),core.xp6(3),core.hij(" ",core.lcZ(10,7,"common.cancel")," "))}function CloseAccountModalComponent_ng_container_0_Template(rf,ctx){if(1&rf){const _r8=core.EpF();core.ynx(0),core.TgZ(1,"div",1),core.NdJ("esc",__name(function(){core.CHM(_r8);const ctx_r7=core.oxw();return core.KtG(ctx_r7.dismissModal("Escape click"))},"CloseAccountModalComponent_ng_container_0_Template_div_esc_1_listener")),core.TgZ(2,"div",2)(3,"div",3)(4,"h3",4),core._uU(5),core.ALo(6,"cxTranslate"),core.qZA(),core.TgZ(7,"button",5),core.NdJ("click",__name(function(){core.CHM(_r8);const ctx_r9=core.oxw();return core.KtG(ctx_r9.dismissModal("Cross click"))},"CloseAccountModalComponent_ng_container_0_Template_button_click_7_listener")),core.ALo(8,"cxTranslate"),core.TgZ(9,"span",6),core._UZ(10,"cx-icon",7),core.qZA()()(),core.YNc(11,CloseAccountModalComponent_ng_container_0_div_11_Template,3,0,"div",8),core.ALo(12,"async"),core.YNc(13,CloseAccountModalComponent_ng_container_0_ng_template_13_Template,11,9,"ng-template",null,9,core.W1O),core.qZA()(),core.BQk()}if(2&rf){const _r2=core.MAs(14),ctx_r0=core.oxw();core.xp6(1),core.Q6J("cxFocus",ctx_r0.focusConfig),core.xp6(4),core.hij(" ",core.lcZ(6,6,"closeAccount.confirmAccountClosure")," "),core.xp6(2),core.uIk("aria-label",core.lcZ(8,8,"common.close")),core.xp6(3),core.Q6J("type",ctx_r0.iconTypes.CLOSE),core.xp6(1),core.Q6J("ngIf",core.lcZ(12,10,ctx_r0.isLoading$))("ngIfElse",_r2)}}__name(CloseAccountModalComponent_ng_container_0_div_11_Template,"CloseAccountModalComponent_ng_container_0_div_11_Template"),__name(CloseAccountModalComponent_ng_container_0_ng_template_13_Template,"CloseAccountModalComponent_ng_container_0_ng_template_13_Template"),__name(CloseAccountModalComponent_ng_container_0_Template,"CloseAccountModalComponent_ng_container_0_Template");const _c0=["element"],_c1=__name(function(){return{cxRoute:"home"}},"_c1");function ForgotPasswordComponent_cx_spinner_0_Template(rf,ctx){1&rf&&core._UZ(0,"cx-spinner",7)}__name(ForgotPasswordComponent_cx_spinner_0_Template,"ForgotPasswordComponent_cx_spinner_0_Template");const _c2=__name(function(){return{cxRoute:"login"}},"_c2");function RegisterComponent_section_0_label_60_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"label"),core._UZ(1,"input",24),core.TgZ(2,"span",20),core._uU(3),core.qZA()()),2&rf){const anonymousConsent_r4=ctx.ngIf,ctx_r3=core.oxw(2);core.xp6(1),core.Q6J("checked",ctx_r3.isConsentGiven(anonymousConsent_r4.consent)),core.xp6(2),core.hij(" ",anonymousConsent_r4.template," ")}}__name(RegisterComponent_section_0_label_60_Template,"RegisterComponent_section_0_label_60_Template");const _c3=__name(function(a0){return{ariaLabel:a0}},"_c3"),_c4=__name(function(){return{cxRoute:"termsAndConditions"}},"_c4");function RegisterComponent_section_0_Template(rf,ctx){if(1&rf){const _r6=core.EpF();core.TgZ(0,"section",2),core._UZ(1,"div",3),core.ALo(2,"cxTranslate"),core.TgZ(3,"div",4)(4,"div",5)(5,"div",6)(6,"form",7),core.NdJ("ngSubmit",__name(function(){core.CHM(_r6);const ctx_r5=core.oxw();return core.KtG(ctx_r5.submitForm())},"RegisterComponent_section_0_Template_form_ngSubmit_6_listener")),core.TgZ(7,"div",8)(8,"label")(9,"span",9),core._uU(10),core.ALo(11,"cxTranslate"),core.qZA(),core._UZ(12,"ng-select",10),core.ALo(13,"async"),core.ALo(14,"cxTranslate"),core.ALo(15,"cxTranslate"),core.qZA()(),core.TgZ(16,"div",8)(17,"label")(18,"span",9),core._uU(19),core.ALo(20,"cxTranslate"),core.qZA(),core._UZ(21,"input",11),core.ALo(22,"cxTranslate"),core._UZ(23,"cx-form-errors",12),core.qZA()(),core.TgZ(24,"div",8)(25,"label")(26,"span",9),core._uU(27),core.ALo(28,"cxTranslate"),core.qZA(),core._UZ(29,"input",13),core.ALo(30,"cxTranslate"),core._UZ(31,"cx-form-errors",12),core.qZA()(),core.TgZ(32,"div",8)(33,"label")(34,"span",9),core._uU(35),core.ALo(36,"cxTranslate"),core.qZA(),core._UZ(37,"input",14),core.ALo(38,"cxTranslate"),core._UZ(39,"cx-form-errors",12),core.qZA()(),core.TgZ(40,"div",8)(41,"label")(42,"span",9),core._uU(43),core.ALo(44,"cxTranslate"),core.qZA(),core._UZ(45,"input",15),core.ALo(46,"cxTranslate"),core.ALo(47,"cxTranslate"),core._UZ(48,"cx-form-errors",12),core.qZA()(),core.TgZ(49,"div",8)(50,"label")(51,"span",9),core._uU(52),core.ALo(53,"cxTranslate"),core.qZA(),core._UZ(54,"input",16),core.ALo(55,"cxTranslate"),core.ALo(56,"cxTranslate"),core._UZ(57,"cx-form-errors",12),core.qZA()(),core.TgZ(58,"div",8)(59,"div",17),core.YNc(60,RegisterComponent_section_0_label_60_Template,4,2,"label",18),core.ALo(61,"async"),core.qZA()(),core.TgZ(62,"div",8)(63,"div",17)(64,"label"),core._UZ(65,"input",19),core.TgZ(66,"span",20),core._uU(67),core.ALo(68,"cxTranslate"),core.TgZ(69,"a",21),core.ALo(70,"cxUrl"),core._uU(71),core.ALo(72,"cxTranslate"),core.qZA()(),core._UZ(73,"cx-form-errors",12),core.qZA()()(),core.TgZ(74,"button",22),core._uU(75),core.ALo(76,"cxTranslate"),core.qZA(),core.TgZ(77,"a",23),core.ALo(78,"cxUrl"),core._uU(79),core.ALo(80,"cxTranslate"),core.qZA()()()()()()}if(2&rf){const ctx_r0=core.oxw();core.xp6(1),core.uIk("aria-label",core.lcZ(2,33,"common.loaded")),core.xp6(5),core.Q6J("formGroup",ctx_r0.registerForm),core.xp6(4),core.Oqu(core.lcZ(11,35,"register.title")),core.xp6(2),core.Q6J("clearable",!1)("items",core.lcZ(13,37,ctx_r0.titles$))("placeholder",core.lcZ(14,39,"register.selectTitle"))("searchable",!1)("cxNgSelectA11y",core.VKq(81,_c3,core.lcZ(15,41,"register.title"))),core.xp6(7),core.Oqu(core.lcZ(20,43,"register.firstName.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(22,45,"register.firstName.placeholder")),core.xp6(2),core.Q6J("control",ctx_r0.registerForm.get("firstName")),core.xp6(4),core.Oqu(core.lcZ(28,47,"register.lastName.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(30,49,"register.lastName.placeholder")),core.xp6(2),core.Q6J("control",ctx_r0.registerForm.get("lastName")),core.xp6(4),core.Oqu(core.lcZ(36,51,"register.emailAddress.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(38,53,"register.emailAddress.placeholder")),core.xp6(2),core.Q6J("control",ctx_r0.registerForm.get("email")),core.xp6(4),core.Oqu(core.lcZ(44,55,"register.password.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(46,57,"register.password.placeholder")),core.uIk("aria-label",core.lcZ(47,59,"register.password.placeholder")),core.xp6(3),core.Q6J("control",ctx_r0.registerForm.get("password")),core.xp6(4),core.Oqu(core.lcZ(53,61,"register.confirmPassword.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(55,63,"register.confirmPassword.placeholder")),core.uIk("aria-label",core.lcZ(56,65,"register.confirmPassword.placeholder")),core.xp6(3),core.Q6J("control",ctx_r0.registerForm.get("passwordconf")),core.xp6(3),core.Q6J("ngIf",core.lcZ(61,67,ctx_r0.anonymousConsent$)),core.xp6(7),core.hij(" ",core.lcZ(68,69,"register.confirmThatRead")," "),core.xp6(2),core.Q6J("routerLink",core.lcZ(70,71,core.DdM(83,_c4))),core.xp6(2),core.hij(" ",core.lcZ(72,73,"register.termsAndConditions")," "),core.xp6(2),core.Q6J("control",ctx_r0.registerForm.get("termsandconditions")),core.xp6(2),core.hij(" ",core.lcZ(76,75,"register.register")," "),core.xp6(2),core.Q6J("routerLink",core.lcZ(78,77,core.DdM(84,_c2))),core.xp6(2),core.Oqu(core.lcZ(80,79,"register.signIn"))}}function RegisterComponent_ng_template_2_Template(rf,ctx){1&rf&&(core.TgZ(0,"div",25),core._UZ(1,"cx-spinner"),core.qZA())}function ResetPasswordComponent_cx_spinner_0_Template(rf,ctx){1&rf&&core._UZ(0,"cx-spinner",2)}function ResetPasswordComponent_form_2_Template(rf,ctx){if(1&rf){const _r4=core.EpF();core.TgZ(0,"form",3),core.NdJ("ngSubmit",__name(function(){const token_r2=core.CHM(_r4).ngIf,ctx_r3=core.oxw();return core.KtG(ctx_r3.onSubmit(token_r2))},"ResetPasswordComponent_form_2_Template_form_ngSubmit_0_listener")),core.TgZ(1,"label")(2,"span",4),core._uU(3),core.ALo(4,"cxTranslate"),core.qZA(),core._UZ(5,"input",5),core.ALo(6,"cxTranslate"),core.ALo(7,"cxTranslate"),core._UZ(8,"cx-form-errors",6),core.qZA(),core.TgZ(9,"label")(10,"span",4),core._uU(11),core.ALo(12,"cxTranslate"),core.qZA(),core._UZ(13,"input",7),core.ALo(14,"cxTranslate"),core.ALo(15,"cxTranslate"),core._UZ(16,"cx-form-errors",6),core.qZA(),core.TgZ(17,"button",8),core._uU(18),core.ALo(19,"cxTranslate"),core.qZA()()}if(2&rf){const ctx_r1=core.oxw();core.Q6J("formGroup",ctx_r1.form),core.xp6(3),core.Oqu(core.lcZ(4,11,"register.newPassword")),core.xp6(2),core.s9C("placeholder",core.lcZ(6,13,"register.password.placeholder")),core.uIk("aria-label",core.lcZ(7,15,"register.password.placeholder")),core.xp6(3),core.Q6J("control",ctx_r1.form.get("password")),core.xp6(3),core.Oqu(core.lcZ(12,17,"register.passwordMinRequirements")),core.xp6(2),core.s9C("placeholder",core.lcZ(14,19,"register.confirmPassword.placeholder")),core.uIk("aria-label",core.lcZ(15,21,"register.confirmPassword.placeholder")),core.xp6(3),core.Q6J("control",ctx_r1.form.get("passwordConfirm")),core.xp6(1),core.Q6J("disabled",ctx_r1.form.disabled),core.xp6(1),core.hij(" ",core.lcZ(19,23,"register.resetPassword")," ")}}function UpdateEmailComponent_cx_spinner_0_Template(rf,ctx){1&rf&&core._UZ(0,"cx-spinner",9)}function UpdatePasswordComponent_cx_spinner_0_Template(rf,ctx){1&rf&&core._UZ(0,"cx-spinner",9)}function UpdateProfileComponent_cx_spinner_0_Template(rf,ctx){1&rf&&core._UZ(0,"cx-spinner",12)}function UpdateProfileComponent_ng_option_12_Template(rf,ctx){if(1&rf&&(core.TgZ(0,"ng-option",4),core._uU(1),core.qZA()),2&rf){const title_r2=ctx.$implicit;core.Q6J("value",title_r2.code),core.xp6(1),core.Oqu(title_r2.name)}}__name(RegisterComponent_section_0_Template,"RegisterComponent_section_0_Template"),__name(RegisterComponent_ng_template_2_Template,"RegisterComponent_ng_template_2_Template"),__name(ResetPasswordComponent_cx_spinner_0_Template,"ResetPasswordComponent_cx_spinner_0_Template"),__name(ResetPasswordComponent_form_2_Template,"ResetPasswordComponent_form_2_Template"),__name(UpdateEmailComponent_cx_spinner_0_Template,"UpdateEmailComponent_cx_spinner_0_Template"),__name(UpdatePasswordComponent_cx_spinner_0_Template,"UpdatePasswordComponent_cx_spinner_0_Template"),__name(UpdateProfileComponent_cx_spinner_0_Template,"UpdateProfileComponent_cx_spinner_0_Template"),__name(UpdateProfileComponent_ng_option_12_Template,"UpdateProfileComponent_ng_option_12_Template");class CloseAccountModalComponent{constructor(authService,globalMessageService,routingService,translationService,userProfile,launchDialogService,el){this.authService=authService,this.globalMessageService=globalMessageService,this.routingService=routingService,this.translationService=translationService,this.userProfile=userProfile,this.launchDialogService=launchDialogService,this.el=el,this.iconTypes=spartacus_storefront.e1G,this.focusConfig={trap:!0,block:!0,autofocus:"button",focusOnEscape:!0},this.loading$=new BehaviorSubject.X(!1)}handleClick(event){event.target.tagName===this.el.nativeElement.tagName&&this.dismissModal("Cross click")}get isLoading$(){return this.loading$.asObservable()}ngOnInit(){this.isLoggedIn$=this.authService.isUserLoggedIn()}onSuccess(){this.dismissModal("Success"),this.translationService.translate("closeAccount.accountClosedSuccessfully").pipe((0,first.P)()).subscribe(text=>{this.globalMessageService.add(text,spartacus_core.xUg.MSG_TYPE_CONFIRMATION)}),this.routingService.go({cxRoute:"home"})}onError(){this.dismissModal("Error"),this.translationService.translate("closeAccount.accountClosedFailure").pipe((0,first.P)()).subscribe(text=>{this.globalMessageService.add(text,spartacus_core.xUg.MSG_TYPE_ERROR)})}dismissModal(reason){this.launchDialogService.closeDialog(reason)}closeAccount(){this.loading$.next(!0),this.userProfile.close().subscribe({next:()=>{this.onSuccess(),this.loading$.next(!1)},error:()=>{this.onError(),this.loading$.next(!1)}})}}__name(CloseAccountModalComponent,"CloseAccountModalComponent"),CloseAccountModalComponent.\u0275fac=__name(function(t){return new(t||CloseAccountModalComponent)(core.Y36(spartacus_core.e80),core.Y36(spartacus_core.IWp),core.Y36(spartacus_core.Znh),core.Y36(spartacus_core.D7D),core.Y36(spartacus_user_profile_root.aT),core.Y36(spartacus_storefront.Q3W),core.Y36(core.SBq))},"CloseAccountModalComponent_Factory"),CloseAccountModalComponent.\u0275cmp=core.Xpm({type:CloseAccountModalComponent,selectors:[["cx-close-account-modal"]],hostBindings:__name(function(rf,ctx){1&rf&&core.NdJ("click",__name(function($event){return ctx.handleClick($event)},"CloseAccountModalComponent_click_HostBindingHandler"))},"CloseAccountModalComponent_HostBindings"),decls:2,vars:3,consts:[[4,"ngIf"],[1,"cx-close-account-modal",3,"cxFocus","esc"],[1,"cx-close-account-modal-container"],[1,"cx-close-account-modal-header","cx-modal-header"],[1,"cx-close-account-modal-title"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[3,"type"],[4,"ngIf","ngIfElse"],["loaded",""],[1,"cx-spinner"],[1,"cx-close-account-modal-body","modal-body"],[1,"cx-confirmation"],[1,"cx-close-account-modal-footer","cx-modal-footer"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-block","btn-secondary",3,"click"]],template:__name(function(rf,ctx){1&rf&&(core.YNc(0,CloseAccountModalComponent_ng_container_0_Template,15,12,"ng-container",0),core.ALo(1,"async")),2&rf&&core.Q6J("ngIf",core.lcZ(1,1,ctx.isLoggedIn$))},"CloseAccountModalComponent_Template"),dependencies:[common.O5,spartacus_storefront.oJW,spartacus_storefront.ORR,spartacus_storefront.RRe,common.Ov,spartacus_core.X$D],encapsulation:2,changeDetection:0});const defaultCloseDialogModalLayoutConfig={launch:{CLOSE_ACCOUNT:{inline:!0,component:CloseAccountModalComponent,dialogType:spartacus_storefront.Myk.DIALOG}}};class CloseAccountComponent{constructor(launchDialogService,vcr){this.launchDialogService=launchDialogService,this.vcr=vcr}openModal(){this.launchDialogService.openDialog("CLOSE_ACCOUNT",this.element,this.vcr)?.pipe((0,take.q)(1)).subscribe()}}__name(CloseAccountComponent,"CloseAccountComponent"),CloseAccountComponent.\u0275fac=__name(function(t){return new(t||CloseAccountComponent)(core.Y36(spartacus_storefront.Q3W),core.Y36(core.s_b))},"CloseAccountComponent_Factory"),CloseAccountComponent.\u0275cmp=core.Xpm({type:CloseAccountComponent,selectors:[["cx-close-account"]],viewQuery:__name(function(rf,ctx){if(1&rf&&core.Gf(_c0,5),2&rf){let _t;core.iGM(_t=core.CRH())&&(ctx.element=_t.first)}},"CloseAccountComponent_Query"),decls:12,vars:10,consts:[[1,"col-lg-8","col-md-9"],[1,"row","cx-btn-group"],[1,"col-sm-6"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"click"],["element",""]],template:__name(function(rf,ctx){1&rf&&(core.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),core.ALo(4,"cxUrl"),core._uU(5),core.ALo(6,"cxTranslate"),core.qZA()(),core.TgZ(7,"div",2)(8,"button",4,5),core.NdJ("click",__name(function(){return ctx.openModal()},"CloseAccountComponent_Template_button_click_8_listener")),core._uU(10),core.ALo(11,"cxTranslate"),core.qZA()()()()),2&rf&&(core.xp6(3),core.Q6J("routerLink",core.lcZ(4,3,core.DdM(9,_c1))),core.xp6(2),core.Oqu(core.lcZ(6,5,"common.cancel")),core.xp6(5),core.hij(" ",core.lcZ(11,7,"closeAccount.closeMyAccount")," "))},"CloseAccountComponent_Template"),dependencies:[router.yS,spartacus_core.l2T,spartacus_core.X$D],encapsulation:2,changeDetection:0});class CloseAccountModule{}__name(CloseAccountModule,"CloseAccountModule"),CloseAccountModule.\u0275fac=__name(function(t){return new(t||CloseAccountModule)},"CloseAccountModule_Factory"),CloseAccountModule.\u0275mod=core.oAB({type:CloseAccountModule}),CloseAccountModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{CloseAccountComponent:{component:CloseAccountComponent,guards:[spartacus_core.a1M]}}}),(0,spartacus_core.i51)(defaultCloseDialogModalLayoutConfig)],imports:[common.ez,router.Bz,spartacus_core.bhT,spartacus_core.LUR,spartacus_storefront.QX1,spartacus_storefront.Fme,spartacus_storefront.oPH]});class ForgotPasswordComponentService{constructor(userPasswordService,routingService,authConfigService,globalMessage){this.userPasswordService=userPasswordService,this.routingService=routingService,this.authConfigService=authConfigService,this.globalMessage=globalMessage,this.busy$=new BehaviorSubject.X(!1),this.isUpdating$=this.busy$.pipe((0,tap.b)(state=>!0===state?this.form.disable():this.form.enable())),this.form=new fesm2020_forms.nJ({userEmail:new fesm2020_forms.p4("",[fesm2020_forms.kI.required,spartacus_storefront.kal.emailValidator])})}requestEmail(){this.form.valid?(this.busy$.next(!0),this.userPasswordService.requestForgotPasswordEmail(this.form.value.userEmail).subscribe({next:()=>this.onSuccess(),error:error=>this.onError(error)})):this.form.markAllAsTouched()}onSuccess(){this.globalMessage.add({key:"forgottenPassword.passwordResetEmailSent"},spartacus_core.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset(),this.redirect()}onError(_error){this.busy$.next(!1)}redirect(){this.authConfigService.getOAuthFlow()===spartacus_core.C8C.ResourceOwnerPasswordFlow&&this.routingService.go({cxRoute:"login"})}}__name(ForgotPasswordComponentService,"ForgotPasswordComponentService"),ForgotPasswordComponentService.\u0275fac=__name(function(t){return new(t||ForgotPasswordComponentService)(core.LFG(spartacus_user_profile_root.LL),core.LFG(spartacus_core.Znh),core.LFG(spartacus_core.dSP),core.LFG(spartacus_core.IWp))},"ForgotPasswordComponentService_Factory"),ForgotPasswordComponentService.\u0275prov=core.Yz7({token:ForgotPasswordComponentService,factory:ForgotPasswordComponentService.\u0275fac});class ForgotPasswordComponent{constructor(service){this.service=service,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$}onSubmit(){this.service.requestEmail()}}__name(ForgotPasswordComponent,"ForgotPasswordComponent"),ForgotPasswordComponent.\u0275fac=__name(function(t){return new(t||ForgotPasswordComponent)(core.Y36(ForgotPasswordComponentService))},"ForgotPasswordComponent_Factory"),ForgotPasswordComponent.\u0275cmp=core.Xpm({type:ForgotPasswordComponent,selectors:[["cx-forgot-password"]],decls:17,vars:22,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["required","true","type","email","formControlName","userEmail",1,"form-control",3,"placeholder"],[3,"control"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"]],template:__name(function(rf,ctx){1&rf&&(core.YNc(0,ForgotPasswordComponent_cx_spinner_0_Template,1,0,"cx-spinner",0),core.ALo(1,"async"),core.TgZ(2,"form",1),core.NdJ("ngSubmit",__name(function(){return ctx.onSubmit()},"ForgotPasswordComponent_Template_form_ngSubmit_2_listener")),core.TgZ(3,"label")(4,"span",2),core._uU(5),core.ALo(6,"cxTranslate"),core.qZA(),core._UZ(7,"input",3),core.ALo(8,"cxTranslate"),core._UZ(9,"cx-form-errors",4),core.qZA(),core.TgZ(10,"a",5),core.ALo(11,"cxUrl"),core._uU(12),core.ALo(13,"cxTranslate"),core.qZA(),core.TgZ(14,"button",6),core._uU(15),core.ALo(16,"cxTranslate"),core.qZA()()),2&rf&&(core.Q6J("ngIf",core.lcZ(1,9,ctx.isUpdating$)),core.xp6(2),core.Q6J("formGroup",ctx.form),core.xp6(3),core.Oqu(core.lcZ(6,11,"forgottenPassword.emailAddress.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(8,13,"forgottenPassword.emailAddress.placeholder")),core.xp6(2),core.Q6J("control",ctx.form.get("userEmail")),core.xp6(1),core.Q6J("routerLink",core.lcZ(11,15,core.DdM(21,_c2))),core.xp6(2),core.Oqu(core.lcZ(13,17,"common.cancel")),core.xp6(2),core.Q6J("disabled",ctx.form.disabled),core.xp6(1),core.hij(" ",core.lcZ(16,19,"common.submit")," "))},"ForgotPasswordComponent_Template"),dependencies:[common.O5,fesm2020_forms._Y,fesm2020_forms.Fj,fesm2020_forms.JJ,fesm2020_forms.JL,fesm2020_forms.Q7,fesm2020_forms.sg,fesm2020_forms.u,router.yS,spartacus_storefront.Ahv,spartacus_storefront.ORR,common.Ov,spartacus_core.l2T,spartacus_core.X$D],encapsulation:2,changeDetection:0});class ForgotPasswordModule{}__name(ForgotPasswordModule,"ForgotPasswordModule"),ForgotPasswordModule.\u0275fac=__name(function(t){return new(t||ForgotPasswordModule)},"ForgotPasswordModule_Factory"),ForgotPasswordModule.\u0275mod=core.oAB({type:ForgotPasswordModule}),ForgotPasswordModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{ForgotPasswordComponent:{component:ForgotPasswordComponent,guards:[spartacus_core.aOY],providers:[{provide:ForgotPasswordComponentService,useClass:ForgotPasswordComponentService,deps:[spartacus_user_profile_root.LL,spartacus_core.Znh,spartacus_core.dSP,spartacus_core.IWp]}]}}})],imports:[common.ez,fesm2020_forms.UX,router.Bz,spartacus_core.bhT,spartacus_core.LUR,spartacus_storefront.Fym,spartacus_storefront.Fme]});class RegisterComponentService{constructor(userRegisterFacade,globalMessageService){this.userRegisterFacade=userRegisterFacade,this.globalMessageService=globalMessageService}register(user){return this.userRegisterFacade.register(user)}getTitles(){return this.userRegisterFacade.getTitles()}postRegisterMessage(){this.globalMessageService.add({key:"register.postRegisterMessage"},spartacus_core.xUg.MSG_TYPE_CONFIRMATION)}}__name(RegisterComponentService,"RegisterComponentService"),RegisterComponentService.\u0275fac=__name(function(t){return new(t||RegisterComponentService)(core.LFG(spartacus_user_profile_root.zm),core.LFG(spartacus_core.IWp))},"RegisterComponentService_Factory"),RegisterComponentService.\u0275prov=core.Yz7({token:RegisterComponentService,factory:RegisterComponentService.\u0275fac});class RegisterComponent{constructor(globalMessageService,fb,router2,anonymousConsentsService,anonymousConsentsConfig,authConfigService,registerComponentService){this.globalMessageService=globalMessageService,this.fb=fb,this.router=router2,this.anonymousConsentsService=anonymousConsentsService,this.anonymousConsentsConfig=anonymousConsentsConfig,this.authConfigService=authConfigService,this.registerComponentService=registerComponentService,this.isLoading$=new BehaviorSubject.X(!1),this.subscription=new Subscription.w,this.registerForm=this.fb.group({titleCode:[null],firstName:["",fesm2020_forms.kI.required],lastName:["",fesm2020_forms.kI.required],email:["",[fesm2020_forms.kI.required,spartacus_storefront.kal.emailValidator]],password:["",[fesm2020_forms.kI.required,spartacus_storefront.kal.passwordValidator]],passwordconf:["",fesm2020_forms.kI.required],newsletter:new fesm2020_forms.p4({value:!1,disabled:this.isConsentRequired()}),termsandconditions:[!1,fesm2020_forms.kI.requiredTrue]},{validators:spartacus_storefront.kal.passwordsMustMatch("password","passwordconf")})}ngOnInit(){this.titles$=this.registerComponentService.getTitles().pipe((0,map.U)(titles=>titles.sort(spartacus_storefront.ke7))),this.subscription.add(this.globalMessageService.get().pipe((0,filter.h)(messages=>!!Object.keys(messages).length)).subscribe(globalMessageEntities=>{const messages=globalMessageEntities&&globalMessageEntities[spartacus_core.xUg.MSG_TYPE_ERROR];messages&&messages.some(message=>"This field is required."===message)&&(this.globalMessageService.remove(spartacus_core.xUg.MSG_TYPE_ERROR),this.globalMessageService.add({key:"register.titleRequired"},spartacus_core.xUg.MSG_TYPE_ERROR))}));const registerConsent=this.anonymousConsentsConfig?.anonymousConsents?.registerConsent??"";this.anonymousConsent$=(0,combineLatest.aj)([this.anonymousConsentsService.getConsent(registerConsent),this.anonymousConsentsService.getTemplate(registerConsent)]).pipe((0,map.U)(([consent,template])=>({consent,template:template?.description?template.description:""}))),this.subscription.add(this.registerForm.get("newsletter").valueChanges.subscribe(()=>{this.toggleAnonymousConsent()}))}submitForm(){this.registerForm.valid?this.registerUser():this.registerForm.markAllAsTouched()}registerUser(){this.isLoading$.next(!0),this.registerComponentService.register(this.collectDataFromRegisterForm(this.registerForm.value)).subscribe({next:()=>this.onRegisterUserSuccess(),complete:()=>this.isLoading$.next(!1),error:()=>this.isLoading$.next(!1)})}titleSelected(title){this.registerForm.controls.titleCode.setValue(title.code)}collectDataFromRegisterForm(formData){const{firstName,lastName,email,password,titleCode}=formData;return{firstName,lastName,uid:email.toLowerCase(),password,titleCode}}isConsentGiven(consent){return this.anonymousConsentsService.isConsentGiven(consent)}isConsentRequired(){const requiredConsents=this.anonymousConsentsConfig?.anonymousConsents?.requiredConsents,registerConsent=this.anonymousConsentsConfig?.anonymousConsents?.registerConsent;return!(!requiredConsents||!registerConsent)&&requiredConsents.includes(registerConsent)}onRegisterUserSuccess(){this.authConfigService.getOAuthFlow()===spartacus_core.C8C.ResourceOwnerPasswordFlow&&this.router.go("login"),this.registerComponentService.postRegisterMessage()}toggleAnonymousConsent(){const registerConsent=this.anonymousConsentsConfig?.anonymousConsents?.registerConsent;registerConsent&&(Boolean(this.registerForm.get("newsletter").value)?this.anonymousConsentsService.giveConsent(registerConsent):this.anonymousConsentsService.withdrawConsent(registerConsent))}ngOnDestroy(){this.subscription.unsubscribe()}}__name(RegisterComponent,"RegisterComponent"),RegisterComponent.\u0275fac=__name(function(t){return new(t||RegisterComponent)(core.Y36(spartacus_core.IWp),core.Y36(fesm2020_forms.QS),core.Y36(spartacus_core.Znh),core.Y36(spartacus_core.NpW),core.Y36(spartacus_core.k0m),core.Y36(spartacus_core.dSP),core.Y36(RegisterComponentService))},"RegisterComponent_Factory"),RegisterComponent.\u0275cmp=core.Xpm({type:RegisterComponent,selectors:[["cx-register"]],decls:4,vars:4,consts:[["class","cx-page-section container",4,"ngIf","ngIfElse"],["loading",""],[1,"cx-page-section","container"],["role","status"],[1,"row","justify-content-center"],[1,"col-md-6"],[1,"cx-section"],[3,"formGroup","ngSubmit"],[1,"form-group"],[1,"label-content"],["bindLabel","name","bindValue","code","formControlName","titleCode","id","title-select",3,"clearable","items","placeholder","searchable","cxNgSelectA11y"],["required","true","type","text","name","firstname","formControlName","firstName",1,"form-control",3,"placeholder"],[3,"control"],["required","true","type","text","name","lastname","formControlName","lastName",1,"form-control",3,"placeholder"],["required","true","type","email","name","email","formControlName","email",1,"form-control",3,"placeholder"],["required","true","type","password","name","password","formControlName","password","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],["required","true","type","password","name","confirmpassword","formControlName","passwordconf","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[1,"form-check"],[4,"ngIf"],["required","true","type","checkbox","name","termsandconditions","formControlName","termsandconditions"],[1,"form-check-label"],["target","_blank","rel","noopener noreferrer",3,"routerLink"],["type","submit",1,"btn","btn-block","btn-primary"],[1,"cx-login-link","btn-link",3,"routerLink"],["type","checkbox","name","newsletter","formControlName","newsletter",1,"form-check-input",3,"checked"],[1,"cx-spinner"]],template:__name(function(rf,ctx){if(1&rf&&(core.YNc(0,RegisterComponent_section_0_Template,81,85,"section",0),core.ALo(1,"async"),core.YNc(2,RegisterComponent_ng_template_2_Template,2,0,"ng-template",null,1,core.W1O)),2&rf){const _r1=core.MAs(3);core.Q6J("ngIf",!core.lcZ(1,2,ctx.isLoading$))("ngIfElse",_r1)}},"RegisterComponent_Template"),dependencies:[common.O5,fesm2020_forms._Y,fesm2020_forms.Fj,fesm2020_forms.Wl,fesm2020_forms.JJ,fesm2020_forms.JL,fesm2020_forms.Q7,fesm2020_forms.Zs,fesm2020_forms.sg,fesm2020_forms.u,router.yS,spartacus_storefront.ORR,spartacus_storefront.Ahv,ng_select_ng_select.w9,spartacus_storefront.VnX,spartacus_storefront.X84,common.Ov,spartacus_core.l2T,spartacus_core.X$D],encapsulation:2});class RegisterComponentModule{}__name(RegisterComponentModule,"RegisterComponentModule"),RegisterComponentModule.\u0275fac=__name(function(t){return new(t||RegisterComponentModule)},"RegisterComponentModule_Factory"),RegisterComponentModule.\u0275mod=core.oAB({type:RegisterComponentModule}),RegisterComponentModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{RegisterCustomerComponent:{component:RegisterComponent,guards:[spartacus_core.aOY],providers:[{provide:RegisterComponentService,useClass:RegisterComponentService,deps:[spartacus_user_profile_root.zm,spartacus_core.IWp]}]}}})],imports:[common.ez,fesm2020_forms.UX,router.Bz,spartacus_core.bhT,spartacus_core.LUR,spartacus_storefront.Fme,spartacus_storefront.Fym,ng_select_ng_select.A0,spartacus_storefront.LcC,spartacus_storefront.Ird]});class ResetPasswordComponentService{constructor(userPasswordService,routingService,globalMessage){this.userPasswordService=userPasswordService,this.routingService=routingService,this.globalMessage=globalMessage,this.busy$=new BehaviorSubject.X(!1),this.isUpdating$=this.busy$.pipe((0,tap.b)(state=>!0===state?this.form.disable():this.form.enable())),this.resetToken$=this.routingService.getRouterState().pipe((0,map.U)(routerState=>routerState.state.queryParams.token)),this.form=new fesm2020_forms.nJ({password:new fesm2020_forms.p4("",[fesm2020_forms.kI.required,spartacus_storefront.kal.passwordValidator]),passwordConfirm:new fesm2020_forms.p4("",fesm2020_forms.kI.required)},{validators:spartacus_storefront.kal.passwordsMustMatch("password","passwordConfirm")})}resetPassword(token){if(!this.form.valid)return void this.form.markAllAsTouched();this.busy$.next(!0);const password=this.form.get("password").value;this.userPasswordService.reset(token,password).subscribe({next:()=>this.onSuccess(),error:error=>this.onError(error)})}onSuccess(){this.globalMessage.add({key:"forgottenPassword.passwordResetSuccess"},spartacus_core.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset(),this.redirect()}onError(error){this.busy$.next(!1),error instanceof spartacus_core.YPQ&&(error.details??[]).forEach(err=>{err.message&&this.globalMessage.add({raw:err.message},spartacus_core.xUg.MSG_TYPE_ERROR)})}redirect(){this.routingService.go({cxRoute:"login"})}}__name(ResetPasswordComponentService,"ResetPasswordComponentService"),ResetPasswordComponentService.\u0275fac=__name(function(t){return new(t||ResetPasswordComponentService)(core.LFG(spartacus_user_profile_root.LL),core.LFG(spartacus_core.Znh),core.LFG(spartacus_core.IWp))},"ResetPasswordComponentService_Factory"),ResetPasswordComponentService.\u0275prov=core.Yz7({token:ResetPasswordComponentService,factory:ResetPasswordComponentService.\u0275fac});class ResetPasswordComponent{constructor(service){this.service=service,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$,this.token$=this.service.resetToken$}onSubmit(token){this.service.resetPassword(token)}}__name(ResetPasswordComponent,"ResetPasswordComponent"),ResetPasswordComponent.\u0275fac=__name(function(t){return new(t||ResetPasswordComponent)(core.Y36(ResetPasswordComponentService))},"ResetPasswordComponent_Factory"),ResetPasswordComponent.\u0275cmp=core.Xpm({type:ResetPasswordComponent,selectors:[["cx-reset-password"]],hostAttrs:[1,"user-form"],decls:4,vars:6,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"overlay"],[3,"formGroup","ngSubmit"],[1,"label-content"],["required","true","type","password","formControlName","password","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[3,"control"],["required","true","type","password","formControlName","passwordConfirm","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[1,"btn","btn-block","btn-primary",3,"disabled"]],template:__name(function(rf,ctx){1&rf&&(core.YNc(0,ResetPasswordComponent_cx_spinner_0_Template,1,0,"cx-spinner",0),core.ALo(1,"async"),core.YNc(2,ResetPasswordComponent_form_2_Template,20,25,"form",1),core.ALo(3,"async")),2&rf&&(core.Q6J("ngIf",core.lcZ(1,2,ctx.isUpdating$)),core.xp6(2),core.Q6J("ngIf",core.lcZ(3,4,ctx.token$)))},"ResetPasswordComponent_Template"),dependencies:[common.O5,fesm2020_forms._Y,fesm2020_forms.Fj,fesm2020_forms.JJ,fesm2020_forms.JL,fesm2020_forms.Q7,fesm2020_forms.sg,fesm2020_forms.u,spartacus_storefront.Ahv,spartacus_storefront.ORR,spartacus_storefront.X84,common.Ov,spartacus_core.X$D],encapsulation:2,changeDetection:0});class ResetPasswordModule{}__name(ResetPasswordModule,"ResetPasswordModule"),ResetPasswordModule.\u0275fac=__name(function(t){return new(t||ResetPasswordModule)},"ResetPasswordModule_Factory"),ResetPasswordModule.\u0275mod=core.oAB({type:ResetPasswordModule}),ResetPasswordModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{ResetPasswordComponent:{component:ResetPasswordComponent,guards:[spartacus_core.aOY],providers:[{provide:ResetPasswordComponentService,useClass:ResetPasswordComponentService,deps:[spartacus_user_profile_root.LL,spartacus_core.Znh,spartacus_core.IWp]}]}}})],imports:[common.ez,fesm2020_forms.u5,fesm2020_forms.UX,router.Bz,spartacus_core.LUR,spartacus_storefront.Fym,spartacus_storefront.Fme,spartacus_storefront.Ird]});class UpdateEmailComponentService{constructor(userEmail,routingService,globalMessageService,authService,authRedirectService){this.userEmail=userEmail,this.routingService=routingService,this.globalMessageService=globalMessageService,this.authService=authService,this.authRedirectService=authRedirectService,this.busy$=new BehaviorSubject.X(!1),this.isUpdating$=this.busy$.pipe((0,tap.b)(state=>!0===state?this.form.disable():this.form.enable())),this.form=new fesm2020_forms.nJ({email:new fesm2020_forms.p4("",[fesm2020_forms.kI.required,spartacus_storefront.kal.emailValidator]),confirmEmail:new fesm2020_forms.p4("",[fesm2020_forms.kI.required]),password:new fesm2020_forms.p4("",[fesm2020_forms.kI.required])},{validators:spartacus_storefront.kal.emailsMustMatch("email","confirmEmail")})}save(){if(!this.form.valid)return void this.form.markAllAsTouched();this.busy$.next(!0);const newEmail=this.form.get("confirmEmail")?.value,password=this.form.get("password")?.value;this.userEmail.update(password,newEmail).subscribe({next:()=>this.onSuccess(newEmail),error:error=>this.onError(error)})}onSuccess(newUid){this.globalMessageService.add({key:"updateEmailForm.emailUpdateSuccess",params:{newUid}},spartacus_core.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset(),this.authRedirectService.setRedirectUrl(this.routingService.getUrl({cxRoute:"home"})),this.authService.coreLogout().then(()=>{this.routingService.go({cxRoute:"login"},{state:{newUid}})})}onError(_error){this.busy$.next(!1)}}__name(UpdateEmailComponentService,"UpdateEmailComponentService"),UpdateEmailComponentService.\u0275fac=__name(function(t){return new(t||UpdateEmailComponentService)(core.LFG(spartacus_user_profile_root.PF),core.LFG(spartacus_core.Znh),core.LFG(spartacus_core.IWp),core.LFG(spartacus_core.e80),core.LFG(spartacus_core.FUY))},"UpdateEmailComponentService_Factory"),UpdateEmailComponentService.\u0275prov=core.Yz7({token:UpdateEmailComponentService,factory:UpdateEmailComponentService.\u0275fac});class UpdateEmailComponent{constructor(service){this.service=service,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$}onSubmit(){this.service.save()}}__name(UpdateEmailComponent,"UpdateEmailComponent"),UpdateEmailComponent.\u0275fac=__name(function(t){return new(t||UpdateEmailComponent)(core.Y36(UpdateEmailComponentService))},"UpdateEmailComponent_Factory"),UpdateEmailComponent.\u0275cmp=core.Xpm({type:UpdateEmailComponent,selectors:[["cx-update-email"]],hostAttrs:[1,"user-form"],decls:32,vars:39,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["required","true","type","email","name","email","formControlName","email",1,"form-control",3,"placeholder"],[3,"control"],["required","true","type","email","name","confirmEmail","formControlName","confirmEmail",1,"form-control",3,"placeholder"],["required","true","type","password","name","password","formControlName","password","autocomplete","new-password","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"]],template:__name(function(rf,ctx){1&rf&&(core.YNc(0,UpdateEmailComponent_cx_spinner_0_Template,1,0,"cx-spinner",0),core.ALo(1,"async"),core.TgZ(2,"form",1),core.NdJ("ngSubmit",__name(function(){return ctx.onSubmit()},"UpdateEmailComponent_Template_form_ngSubmit_2_listener")),core.TgZ(3,"label")(4,"span",2),core._uU(5),core.ALo(6,"cxTranslate"),core.qZA(),core._UZ(7,"input",3),core.ALo(8,"cxTranslate"),core._UZ(9,"cx-form-errors",4),core.qZA(),core.TgZ(10,"label")(11,"span",2),core._uU(12),core.ALo(13,"cxTranslate"),core.qZA(),core._UZ(14,"input",5),core.ALo(15,"cxTranslate"),core._UZ(16,"cx-form-errors",4),core.qZA(),core.TgZ(17,"label")(18,"span",2),core._uU(19),core.ALo(20,"cxTranslate"),core.qZA(),core._UZ(21,"input",6),core.ALo(22,"cxTranslate"),core.ALo(23,"cxTranslate"),core._UZ(24,"cx-form-errors",4),core.qZA(),core.TgZ(25,"a",7),core.ALo(26,"cxUrl"),core._uU(27),core.ALo(28,"cxTranslate"),core.qZA(),core.TgZ(29,"button",8),core._uU(30),core.ALo(31,"cxTranslate"),core.qZA()()),2&rf&&(core.Q6J("ngIf",core.lcZ(1,16,ctx.isUpdating$)),core.xp6(2),core.Q6J("formGroup",ctx.form),core.xp6(3),core.Oqu(core.lcZ(6,18,"updateEmailForm.newEmailAddress.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(8,20,"updateEmailForm.newEmailAddress.placeholder")),core.xp6(2),core.Q6J("control",ctx.form.get("email")),core.xp6(3),core.Oqu(core.lcZ(13,22,"updateEmailForm.confirmNewEmailAddress.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(15,24,"updateEmailForm.confirmNewEmailAddress.placeholder")),core.xp6(2),core.Q6J("control",ctx.form.get("confirmEmail")),core.xp6(3),core.Oqu(core.lcZ(20,26,"updateEmailForm.password.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(22,28,"updateEmailForm.password.placeholder")),core.uIk("aria-label",core.lcZ(23,30,"updateEmailForm.password.placeholder")),core.xp6(3),core.Q6J("control",ctx.form.get("password")),core.xp6(1),core.Q6J("routerLink",core.lcZ(26,32,core.DdM(38,_c1))),core.xp6(2),core.hij(" ",core.lcZ(28,34,"common.cancel")," "),core.xp6(2),core.Q6J("disabled",ctx.form.disabled),core.xp6(1),core.hij(" ",core.lcZ(31,36,"common.save")," "))},"UpdateEmailComponent_Template"),dependencies:[common.O5,fesm2020_forms._Y,fesm2020_forms.Fj,fesm2020_forms.JJ,fesm2020_forms.JL,fesm2020_forms.Q7,fesm2020_forms.sg,fesm2020_forms.u,spartacus_storefront.ORR,router.yS,spartacus_storefront.Ahv,spartacus_storefront.X84,common.Ov,spartacus_core.l2T,spartacus_core.X$D],encapsulation:2,changeDetection:0});class UpdateEmailModule{}__name(UpdateEmailModule,"UpdateEmailModule"),UpdateEmailModule.\u0275fac=__name(function(t){return new(t||UpdateEmailModule)},"UpdateEmailModule_Factory"),UpdateEmailModule.\u0275mod=core.oAB({type:UpdateEmailModule}),UpdateEmailModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{UpdateEmailComponent:{component:UpdateEmailComponent,guards:[spartacus_core.a1M],providers:[{provide:UpdateEmailComponentService,useClass:UpdateEmailComponentService,deps:[spartacus_user_profile_root.PF,spartacus_core.Znh,spartacus_core.IWp,spartacus_core.e80,spartacus_core.FUY]}]}}})],imports:[common.ez,fesm2020_forms.u5,fesm2020_forms.UX,spartacus_storefront.Fme,spartacus_core.bhT,router.Bz,spartacus_core.LUR,spartacus_storefront.Fym,spartacus_storefront.Ird]});class UpdatePasswordComponentService{constructor(userPasswordService,routingService,globalMessageService){this.userPasswordService=userPasswordService,this.routingService=routingService,this.globalMessageService=globalMessageService,this.busy$=new BehaviorSubject.X(!1),this.isUpdating$=this.busy$.pipe((0,tap.b)(state=>!0===state?this.form.disable():this.form.enable())),this.form=new fesm2020_forms.nJ({oldPassword:new fesm2020_forms.p4("",fesm2020_forms.kI.required),newPassword:new fesm2020_forms.p4("",[fesm2020_forms.kI.required,spartacus_storefront.kal.passwordValidator]),newPasswordConfirm:new fesm2020_forms.p4("",fesm2020_forms.kI.required)},{validators:spartacus_storefront.kal.passwordsMustMatch("newPassword","newPasswordConfirm")})}updatePassword(){if(!this.form.valid)return void this.form.markAllAsTouched();this.busy$.next(!0);const oldPassword=this.form.get("oldPassword")?.value,newPassword=this.form.get("newPassword")?.value;this.userPasswordService.update(oldPassword,newPassword).subscribe({next:()=>this.onSuccess(),error:error=>this.onError(error)})}onSuccess(){this.globalMessageService.add({key:"updatePasswordForm.passwordUpdateSuccess"},spartacus_core.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset(),this.routingService.go({cxRoute:"home"})}onError(_error){this.busy$.next(!1),this.form.reset()}}__name(UpdatePasswordComponentService,"UpdatePasswordComponentService"),UpdatePasswordComponentService.\u0275fac=__name(function(t){return new(t||UpdatePasswordComponentService)(core.LFG(spartacus_user_profile_root.LL),core.LFG(spartacus_core.Znh),core.LFG(spartacus_core.IWp))},"UpdatePasswordComponentService_Factory"),UpdatePasswordComponentService.\u0275prov=core.Yz7({token:UpdatePasswordComponentService,factory:UpdatePasswordComponentService.\u0275fac});class UpdatePasswordComponent{constructor(service){this.service=service,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$}onSubmit(){this.service.updatePassword()}}__name(UpdatePasswordComponent,"UpdatePasswordComponent"),UpdatePasswordComponent.\u0275fac=__name(function(t){return new(t||UpdatePasswordComponent)(core.Y36(UpdatePasswordComponentService))},"UpdatePasswordComponent_Factory"),UpdatePasswordComponent.\u0275cmp=core.Xpm({type:UpdatePasswordComponent,selectors:[["cx-update-password"]],hostAttrs:[1,"user-form"],decls:34,vars:45,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["required","true","type","password","name","oldPassword","formControlName","oldPassword","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[3,"control"],["required","true","type","password","name","newPassword","formControlName","newPassword","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],["required","true","type","password","name","newPasswordConfirm","formControlName","newPasswordConfirm","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"]],template:__name(function(rf,ctx){1&rf&&(core.YNc(0,UpdatePasswordComponent_cx_spinner_0_Template,1,0,"cx-spinner",0),core.ALo(1,"async"),core.TgZ(2,"form",1),core.NdJ("ngSubmit",__name(function(){return ctx.onSubmit()},"UpdatePasswordComponent_Template_form_ngSubmit_2_listener")),core.TgZ(3,"label")(4,"span",2),core._uU(5),core.ALo(6,"cxTranslate"),core.qZA(),core._UZ(7,"input",3),core.ALo(8,"cxTranslate"),core.ALo(9,"cxTranslate"),core._UZ(10,"cx-form-errors",4),core.qZA(),core.TgZ(11,"label")(12,"span",2),core._uU(13),core.ALo(14,"cxTranslate"),core.qZA(),core._UZ(15,"input",5),core.ALo(16,"cxTranslate"),core.ALo(17,"cxTranslate"),core._UZ(18,"cx-form-errors",4),core.qZA(),core.TgZ(19,"label")(20,"span",2),core._uU(21),core.ALo(22,"cxTranslate"),core.qZA(),core._UZ(23,"input",6),core.ALo(24,"cxTranslate"),core.ALo(25,"cxTranslate"),core._UZ(26,"cx-form-errors",4),core.qZA(),core.TgZ(27,"a",7),core.ALo(28,"cxUrl"),core._uU(29),core.ALo(30,"cxTranslate"),core.qZA(),core.TgZ(31,"button",8),core._uU(32),core.ALo(33,"cxTranslate"),core.qZA()()),2&rf&&(core.Q6J("ngIf",core.lcZ(1,18,ctx.isUpdating$)),core.xp6(2),core.Q6J("formGroup",ctx.form),core.xp6(3),core.Oqu(core.lcZ(6,20,"updatePasswordForm.oldPassword.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(8,22,"updatePasswordForm.oldPassword.placeholder")),core.uIk("aria-label",core.lcZ(9,24,"updatePasswordForm.oldPassword.placeholder")),core.xp6(3),core.Q6J("control",ctx.form.get("oldPassword")),core.xp6(3),core.Oqu(core.lcZ(14,26,"updatePasswordForm.newPassword.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(16,28,"updatePasswordForm.newPassword.placeholder")),core.uIk("aria-label",core.lcZ(17,30,"updatePasswordForm.newPassword.placeholder")),core.xp6(3),core.Q6J("control",ctx.form.get("newPassword")),core.xp6(3),core.Oqu(core.lcZ(22,32,"updatePasswordForm.confirmPassword.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(24,34,"updatePasswordForm.confirmPassword.placeholder")),core.uIk("aria-label",core.lcZ(25,36,"updatePasswordForm.confirmPassword.placeholder")),core.xp6(3),core.Q6J("control",ctx.form.get("newPasswordConfirm")),core.xp6(1),core.Q6J("routerLink",core.lcZ(28,38,core.DdM(44,_c1))),core.xp6(2),core.hij(" ",core.lcZ(30,40,"common.cancel")," "),core.xp6(2),core.Q6J("disabled",ctx.form.disabled),core.xp6(1),core.hij(" ",core.lcZ(33,42,"common.save")," "))},"UpdatePasswordComponent_Template"),dependencies:[common.O5,fesm2020_forms._Y,fesm2020_forms.Fj,fesm2020_forms.JJ,fesm2020_forms.JL,fesm2020_forms.Q7,fesm2020_forms.sg,fesm2020_forms.u,spartacus_storefront.ORR,spartacus_storefront.Ahv,router.yS,spartacus_storefront.X84,common.Ov,spartacus_core.X$D,spartacus_core.l2T],encapsulation:2,changeDetection:0});class UpdatePasswordModule{}__name(UpdatePasswordModule,"UpdatePasswordModule"),UpdatePasswordModule.\u0275fac=__name(function(t){return new(t||UpdatePasswordModule)},"UpdatePasswordModule_Factory"),UpdatePasswordModule.\u0275mod=core.oAB({type:UpdatePasswordModule}),UpdatePasswordModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{UpdatePasswordComponent:{component:UpdatePasswordComponent,guards:[spartacus_core.a1M],providers:[{provide:UpdatePasswordComponentService,useClass:UpdatePasswordComponentService,deps:[spartacus_user_profile_root.LL,spartacus_core.Znh,spartacus_core.IWp]}]}}})],imports:[common.ez,fesm2020_forms.u5,fesm2020_forms.UX,spartacus_storefront.Fme,spartacus_core.LUR,spartacus_storefront.Fym,spartacus_core.bhT,router.Bz,spartacus_storefront.Ird]});class UpdateProfileComponentService{constructor(userProfile,globalMessageService){this.userProfile=userProfile,this.globalMessageService=globalMessageService,this.user$=this.userProfile.get().pipe((0,filter.h)(user=>Boolean(user))),this.busy$=new BehaviorSubject.X(!1),this.isUpdating$=this.user$.pipe((0,tap.b)(user=>this.form.patchValue(user)),(0,switchMap.w)(_user=>this.busy$),(0,tap.b)(state=>!0===state?this.form.disable():this.form.enable())),this.titles$=this.userProfile.getTitles(),this.form=new fesm2020_forms.nJ({customerId:new fesm2020_forms.p4(""),titleCode:new fesm2020_forms.p4(""),firstName:new fesm2020_forms.p4("",fesm2020_forms.kI.required),lastName:new fesm2020_forms.p4("",fesm2020_forms.kI.required)})}updateProfile(){this.form.valid?(this.busy$.next(!0),this.userProfile.update(this.form.value).subscribe({next:()=>this.onSuccess(),error:error=>this.onError(error)})):this.form.markAllAsTouched()}onSuccess(){this.globalMessageService.add({key:"updateProfileForm.profileUpdateSuccess"},spartacus_core.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset()}onError(_error){this.busy$.next(!1)}}__name(UpdateProfileComponentService,"UpdateProfileComponentService"),UpdateProfileComponentService.\u0275fac=__name(function(t){return new(t||UpdateProfileComponentService)(core.LFG(spartacus_user_profile_root.aT),core.LFG(spartacus_core.IWp))},"UpdateProfileComponentService_Factory"),UpdateProfileComponentService.\u0275prov=core.Yz7({token:UpdateProfileComponentService,factory:UpdateProfileComponentService.\u0275fac});class UpdateProfileComponent{constructor(service){this.service=service,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$,this.titles$=this.service.titles$}onSubmit(){this.service.updateProfile()}}__name(UpdateProfileComponent,"UpdateProfileComponent"),UpdateProfileComponent.\u0275fac=__name(function(t){return new(t||UpdateProfileComponent)(core.Y36(UpdateProfileComponentService))},"UpdateProfileComponent_Factory"),UpdateProfileComponent.\u0275cmp=core.Xpm({type:UpdateProfileComponent,selectors:[["cx-update-profile"]],hostAttrs:[1,"user-form"],decls:41,vars:49,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["formControlName","titleCode","id","title-select",3,"clearable","searchable","cxNgSelectA11y"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["required","true","type","text","name","firstName","formControlName","firstName",1,"form-control",3,"placeholder"],[3,"control"],["required","true","type","text","name","lastName","formControlName","lastName",1,"form-control",3,"placeholder"],["required","true","type","text","name","customerId","formControlName","customerId","readonly","",1,"form-control"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"]],template:__name(function(rf,ctx){1&rf&&(core.YNc(0,UpdateProfileComponent_cx_spinner_0_Template,1,0,"cx-spinner",0),core.ALo(1,"async"),core.TgZ(2,"form",1),core.NdJ("ngSubmit",__name(function(){return ctx.onSubmit()},"UpdateProfileComponent_Template_form_ngSubmit_2_listener")),core.TgZ(3,"label")(4,"span",2),core._uU(5),core.ALo(6,"cxTranslate"),core.qZA(),core.TgZ(7,"ng-select",3),core.ALo(8,"cxTranslate"),core.TgZ(9,"ng-option",4),core._uU(10),core.ALo(11,"cxTranslate"),core.qZA(),core.YNc(12,UpdateProfileComponent_ng_option_12_Template,2,2,"ng-option",5),core.ALo(13,"async"),core.qZA()(),core.TgZ(14,"label")(15,"span",2),core._uU(16),core.ALo(17,"cxTranslate"),core.qZA(),core._UZ(18,"input",6),core.ALo(19,"cxTranslate"),core._UZ(20,"cx-form-errors",7),core.qZA(),core.TgZ(21,"label")(22,"span",2),core._uU(23),core.ALo(24,"cxTranslate"),core.qZA(),core._UZ(25,"input",8),core.ALo(26,"cxTranslate"),core._UZ(27,"cx-form-errors",7),core.qZA(),core.TgZ(28,"label")(29,"span",2),core._uU(30),core.ALo(31,"cxTranslate"),core.qZA(),core._UZ(32,"input",9)(33,"cx-form-errors",7),core.qZA(),core.TgZ(34,"a",10),core.ALo(35,"cxUrl"),core._uU(36),core.ALo(37,"cxTranslate"),core.qZA(),core.TgZ(38,"button",11),core._uU(39),core.ALo(40,"cxTranslate"),core.qZA()()),2&rf&&(core.Q6J("ngIf",core.lcZ(1,20,ctx.isUpdating$)),core.xp6(2),core.Q6J("formGroup",ctx.form),core.xp6(3),core.Oqu(core.lcZ(6,22,"updateProfileForm.title")),core.xp6(2),core.Q6J("clearable",!1)("searchable",!1)("cxNgSelectA11y",core.VKq(46,_c3,core.lcZ(8,24,"updateProfileForm.title"))),core.xp6(3),core.Oqu(core.lcZ(11,26,"updateProfileForm.none")),core.xp6(2),core.Q6J("ngForOf",core.lcZ(13,28,ctx.titles$)),core.xp6(4),core.Oqu(core.lcZ(17,30,"updateProfileForm.firstName.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(19,32,"updateProfileForm.firstName.placeholder")),core.xp6(2),core.Q6J("control",ctx.form.get("firstName")),core.xp6(3),core.Oqu(core.lcZ(24,34,"updateProfileForm.lastName.label")),core.xp6(2),core.s9C("placeholder",core.lcZ(26,36,"updateProfileForm.lastName.placeholder")),core.xp6(2),core.Q6J("control",ctx.form.get("lastName")),core.xp6(3),core.Oqu(core.lcZ(31,38,"updateProfileForm.customerId")),core.xp6(3),core.Q6J("control",ctx.form.get("lastName")),core.xp6(1),core.Q6J("routerLink",core.lcZ(35,40,core.DdM(48,_c1))),core.xp6(2),core.hij(" ",core.lcZ(37,42,"common.cancel")," "),core.xp6(2),core.Q6J("disabled",ctx.form.disabled),core.xp6(1),core.hij(" ",core.lcZ(40,44,"common.save")," "))},"UpdateProfileComponent_Template"),dependencies:[common.sg,common.O5,fesm2020_forms._Y,fesm2020_forms.Fj,fesm2020_forms.JJ,fesm2020_forms.JL,fesm2020_forms.Q7,fesm2020_forms.sg,fesm2020_forms.u,spartacus_storefront.ORR,spartacus_storefront.Ahv,router.yS,ng_select_ng_select.w9,ng_select_ng_select.jq,spartacus_storefront.VnX,common.Ov,spartacus_core.X$D,spartacus_core.l2T],encapsulation:2,changeDetection:0});class UpdateProfileModule{}__name(UpdateProfileModule,"UpdateProfileModule"),UpdateProfileModule.\u0275fac=__name(function(t){return new(t||UpdateProfileModule)},"UpdateProfileModule_Factory"),UpdateProfileModule.\u0275mod=core.oAB({type:UpdateProfileModule}),UpdateProfileModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{UpdateProfileComponent:{component:UpdateProfileComponent,guards:[spartacus_core.a1M],providers:[{provide:UpdateProfileComponentService,useClass:UpdateProfileComponentService,deps:[spartacus_user_profile_root.aT,spartacus_core.IWp]}]}}})],imports:[common.ez,fesm2020_forms.u5,fesm2020_forms.UX,spartacus_storefront.Fme,spartacus_core.LUR,spartacus_storefront.Fym,router.Bz,spartacus_core.bhT,ng_select_ng_select.A0,spartacus_storefront.LcC]});class UserProfileComponentsModule{}__name(UserProfileComponentsModule,"UserProfileComponentsModule"),UserProfileComponentsModule.\u0275fac=__name(function(t){return new(t||UserProfileComponentsModule)},"UserProfileComponentsModule_Factory"),UserProfileComponentsModule.\u0275mod=core.oAB({type:UserProfileComponentsModule}),UserProfileComponentsModule.\u0275inj=core.cJS({imports:[RegisterComponentModule,UpdateProfileModule,UpdateEmailModule,UpdatePasswordModule,ForgotPasswordModule,ResetPasswordModule,CloseAccountModule]});var throwError=__webpack_require__(1737),merge=__webpack_require__(6787),ngrx_store=__webpack_require__(8555);class CDCRegisterComponentService extends RegisterComponentService{constructor(userRegisterFacade,command,store,cdcJSService,globalMessageService,authService,eventService){super(userRegisterFacade,globalMessageService),this.userRegisterFacade=userRegisterFacade,this.command=command,this.store=store,this.cdcJSService=cdcJSService,this.globalMessageService=globalMessageService,this.authService=authService,this.eventService=eventService,this.registerCommand=this.command.create(({user})=>this.cdcJSService.registerUserWithoutScreenSet(user)),this.loadUserTokenFailed$=this.eventService.get(spartacus_cdc_root.yB).pipe((0,map.U)(event=>!!event),(0,tap.b)(failed=>{if(failed)throw new Error("User token failed to load.")})),this.isLoggedIn$=this.authService.isUserLoggedIn().pipe((0,filter.h)(loggedIn=>loggedIn))}register(user){return user.firstName&&user.lastName&&user.uid&&user.password?this.cdcJSService.didLoad().pipe((0,tap.b)(cdcLoaded=>{if(!cdcLoaded)throw this.globalMessageService.add({key:"errorHandlers.scriptFailedToLoad"},spartacus_core.xUg.MSG_TYPE_ERROR),new Error("CDC script didn't load.")}),(0,switchMap.w)(()=>this.registerCommand.execute({user})),(0,switchMap.w)(user2=>(0,merge.T)(this.loadUserTokenFailed$,this.isLoggedIn$).pipe((0,map.U)(()=>user2)))):(0,throwError._)(`The provided user is not valid: ${user}`)}postRegisterMessage(){}}__name(CDCRegisterComponentService,"CDCRegisterComponentService"),CDCRegisterComponentService.\u0275fac=__name(function(t){return new(t||CDCRegisterComponentService)(core.LFG(spartacus_user_profile_root.zm),core.LFG(spartacus_core.VDr),core.LFG(ngrx_store.yh),core.LFG(spartacus_cdc_root.bF),core.LFG(spartacus_core.IWp),core.LFG(spartacus_core.e80),core.LFG(spartacus_core.POd))},"CDCRegisterComponentService_Factory"),CDCRegisterComponentService.\u0275prov=core.Yz7({token:CDCRegisterComponentService,factory:CDCRegisterComponentService.\u0275fac});class CDCRegisterModule{}__name(CDCRegisterModule,"CDCRegisterModule"),CDCRegisterModule.\u0275fac=__name(function(t){return new(t||CDCRegisterModule)},"CDCRegisterModule_Factory"),CDCRegisterModule.\u0275mod=core.oAB({type:CDCRegisterModule}),CDCRegisterModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{RegisterCustomerComponent:{providers:[{provide:RegisterComponentService,useClass:CDCRegisterComponentService,deps:[spartacus_user_profile_root.zm,spartacus_core.VDr,ngrx_store.yh,spartacus_cdc_root.bF,spartacus_core.IWp,spartacus_core.e80,spartacus_core.POd]}]}}})],imports:[common.ez,fesm2020_forms.UX,router.Bz,spartacus_core.bhT,spartacus_core.LUR,spartacus_storefront.Fme,spartacus_storefront.Fym,ng_select_ng_select.A0,spartacus_storefront.LcC]});class CDCForgotPasswordComponentService extends ForgotPasswordComponentService{constructor(userPasswordService,routingService,authConfigService,globalMessage,cdcJsService){super(userPasswordService,routingService,authConfigService,globalMessage),this.userPasswordService=userPasswordService,this.routingService=routingService,this.authConfigService=authConfigService,this.globalMessage=globalMessage,this.cdcJsService=cdcJsService,this.subscription=new Subscription.w}requestEmail(){this.form.valid?(this.busy$.next(!0),this.subscription.add(this.cdcJsService.didLoad().subscribe(cdcLoaded=>{cdcLoaded?this.cdcJsService.resetPasswordWithoutScreenSet(this.form.value.userEmail).subscribe({next:response=>{this.busy$.next(!1),"OK"===response.status&&this.redirect()},error:()=>this.busy$.next(!1)}):(this.busy$.next(!1),this.globalMessage.add({key:"errorHandlers.scriptFailedToLoad"},spartacus_core.xUg.MSG_TYPE_ERROR))}))):this.form.markAllAsTouched()}ngOnDestroy(){this.subscription.unsubscribe()}}__name(CDCForgotPasswordComponentService,"CDCForgotPasswordComponentService"),CDCForgotPasswordComponentService.\u0275fac=__name(function(t){return new(t||CDCForgotPasswordComponentService)(core.LFG(spartacus_user_profile_root.LL),core.LFG(spartacus_core.Znh),core.LFG(spartacus_core.dSP),core.LFG(spartacus_core.IWp),core.LFG(spartacus_cdc_root.bF))},"CDCForgotPasswordComponentService_Factory"),CDCForgotPasswordComponentService.\u0275prov=core.Yz7({token:CDCForgotPasswordComponentService,factory:CDCForgotPasswordComponentService.\u0275fac});class CDCForgotPasswordModule{}__name(CDCForgotPasswordModule,"CDCForgotPasswordModule"),CDCForgotPasswordModule.\u0275fac=__name(function(t){return new(t||CDCForgotPasswordModule)},"CDCForgotPasswordModule_Factory"),CDCForgotPasswordModule.\u0275mod=core.oAB({type:CDCForgotPasswordModule}),CDCForgotPasswordModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({cmsComponents:{ForgotPasswordComponent:{component:ForgotPasswordComponent,providers:[{provide:ForgotPasswordComponentService,useClass:CDCForgotPasswordComponentService,deps:[spartacus_user_profile_root.LL,spartacus_core.Znh,spartacus_core.dSP,spartacus_core.IWp,spartacus_cdc_root.bF]}]}}})],imports:[common.ez,fesm2020_forms.UX,router.Bz,spartacus_core.bhT,spartacus_core.LUR,spartacus_storefront.Fym,spartacus_storefront.Fme]});class CDCUserProfileModule{}__name(CDCUserProfileModule,"CDCUserProfileModule"),CDCUserProfileModule.\u0275fac=__name(function(t){return new(t||CDCUserProfileModule)},"CDCUserProfileModule_Factory"),CDCUserProfileModule.\u0275mod=core.oAB({type:CDCUserProfileModule}),CDCUserProfileModule.\u0275inj=core.cJS({imports:[CDCRegisterModule,CDCForgotPasswordModule]});var spartacus_user_account_root=__webpack_require__(9309);const USER_PROFILE_NORMALIZER=new core.OlP("UserProfileNormalizer"),USER_PROFILE_SERIALIZER=new core.OlP("UserProfileSerializer"),USER_SIGN_UP_SERIALIZER=(new core.OlP("UserSerializer"),new core.OlP("UserSignUpSerializer")),TITLE_NORMALIZER=new core.OlP("TitleNormalizer");class UserProfileAdapter{}__name(UserProfileAdapter,"UserProfileAdapter");class UserProfileConnector{constructor(userProfileAdapter){this.userProfileAdapter=userProfileAdapter}update(username,user){return this.userProfileAdapter.update(username,user)}register(user){return this.userProfileAdapter.register(user)}registerGuest(guid,password){return this.userProfileAdapter.registerGuest(guid,password)}requestForgotPasswordEmail(userEmailAddress){return this.userProfileAdapter.requestForgotPasswordEmail(userEmailAddress)}resetPassword(token,newPassword){return this.userProfileAdapter.resetPassword(token,newPassword)}updateEmail(userId,currentPassword,newUserId){return this.userProfileAdapter.updateEmail(userId,currentPassword,newUserId)}updatePassword(userId,oldPassword,newPassword){return this.userProfileAdapter.updatePassword(userId,oldPassword,newPassword)}remove(userId){return this.userProfileAdapter.close(userId)}getTitles(){return this.userProfileAdapter.loadTitles()}}__name(UserProfileConnector,"UserProfileConnector"),UserProfileConnector.\u0275fac=__name(function(t){return new(t||UserProfileConnector)(core.LFG(UserProfileAdapter))},"UserProfileConnector_Factory"),UserProfileConnector.\u0275prov=core.Yz7({token:UserProfileConnector,factory:UserProfileConnector.\u0275fac});class UserEmailService{constructor(userIdService,userProfileConnector,command){this.userIdService=userIdService,this.userProfileConnector=userProfileConnector,this.command=command,this.updateCommand=this.command.create(payload=>this.userIdService.takeUserId(!0).pipe((0,switchMap.w)(uid=>this.userProfileConnector.updateEmail(uid,payload.password,payload.newUid))),{strategy:spartacus_core.flE.Queue})}update(password,newUid){return this.updateCommand.execute({password,newUid})}}__name(UserEmailService,"UserEmailService"),UserEmailService.\u0275fac=__name(function(t){return new(t||UserEmailService)(core.LFG(spartacus_core.XBV),core.LFG(UserProfileConnector),core.LFG(spartacus_core.VDr))},"UserEmailService_Factory"),UserEmailService.\u0275prov=core.Yz7({token:UserEmailService,factory:UserEmailService.\u0275fac});class UserPasswordService{constructor(userProfileConnector,userIdService,command){this.userProfileConnector=userProfileConnector,this.userIdService=userIdService,this.command=command,this.updateCommand=this.command.create(payload=>this.userIdService.takeUserId(!0).pipe((0,take.q)(1),(0,switchMap.w)(uid=>this.userProfileConnector.updatePassword(uid,payload.oldPassword,payload.newPassword)))),this.resetCommand=this.command.create(payload=>this.userProfileConnector.resetPassword(payload.token,payload.password)),this.requestForgotPasswordEmailCommand=this.command.create(payload=>this.userProfileConnector.requestForgotPasswordEmail(payload.email))}update(oldPassword,newPassword){return this.updateCommand.execute({oldPassword,newPassword})}reset(token,password){return this.resetCommand.execute({token,password})}requestForgotPasswordEmail(email){return this.requestForgotPasswordEmailCommand.execute({email})}}__name(UserPasswordService,"UserPasswordService"),UserPasswordService.\u0275fac=__name(function(t){return new(t||UserPasswordService)(core.LFG(UserProfileConnector),core.LFG(spartacus_core.XBV),core.LFG(spartacus_core.VDr))},"UserPasswordService_Factory"),UserPasswordService.\u0275prov=core.Yz7({token:UserPasswordService,factory:UserPasswordService.\u0275fac});class UserProfileService{constructor(userAccountService,authService,userProfileConnector,eventService,userIdService,query,command){this.userAccountService=userAccountService,this.authService=authService,this.userProfileConnector=userProfileConnector,this.eventService=eventService,this.userIdService=userIdService,this.query=query,this.command=command,this.updateCommand=this.command.create(payload=>this.userIdService.takeUserId(!0).pipe((0,switchMap.w)(uid=>this.userProfileConnector.update(uid,payload.details).pipe((0,tap.b)(()=>{this.eventService.dispatch({user:payload.details},spartacus_user_account_root.x7)})))),{strategy:spartacus_core.flE.Queue}),this.closeCommand=this.command.create(()=>this.userIdService.takeUserId(!0).pipe((0,switchMap.w)(uid=>this.userProfileConnector.remove(uid).pipe((0,tap.b)(()=>this.authService.logout()))))),this.titleQuery=this.query.create(()=>this.userProfileConnector.getTitles(),{reloadOn:[spartacus_core.QRE]})}get(){return this.userAccountService.get()}update(details){return this.updateCommand.execute({details})}close(){return this.closeCommand.execute(void 0)}getTitles(){return this.titleQuery.get().pipe((0,map.U)(titles=>titles??[]))}}__name(UserProfileService,"UserProfileService"),UserProfileService.\u0275fac=__name(function(t){return new(t||UserProfileService)(core.LFG(spartacus_user_account_root.gf),core.LFG(spartacus_core.e80),core.LFG(UserProfileConnector),core.LFG(spartacus_core.POd),core.LFG(spartacus_core.XBV),core.LFG(spartacus_core._7J),core.LFG(spartacus_core.VDr))},"UserProfileService_Factory"),UserProfileService.\u0275prov=core.Yz7({token:UserProfileService,factory:UserProfileService.\u0275fac});class UserRegisterService{constructor(userProfile,userConnector,authService,command,store){this.userProfile=userProfile,this.userConnector=userConnector,this.authService=authService,this.command=command,this.store=store,this.registerCommand=this.command.create(({user})=>this.userConnector.register(user).pipe((0,tap.b)(()=>{this.store.dispatch(new spartacus_core.EJN.RegisterUserSuccess)}))),this.registerGuestCommand=this.command.create(payload=>this.userConnector.registerGuest(payload.guid,payload.password).pipe((0,tap.b)(user=>{this.authService.loginWithCredentials(user.uid,payload.password)})))}register(user){return this.registerCommand.execute({user})}registerGuest(guid,password){return this.registerGuestCommand.execute({guid,password})}getTitles(){return this.userProfile.getTitles()}}__name(UserRegisterService,"UserRegisterService"),UserRegisterService.\u0275fac=__name(function(t){return new(t||UserRegisterService)(core.LFG(UserProfileService),core.LFG(UserProfileConnector),core.LFG(spartacus_core.e80),core.LFG(spartacus_core.VDr),core.LFG(ngrx_store.yh))},"UserRegisterService_Factory"),UserRegisterService.\u0275prov=core.Yz7({token:UserRegisterService,factory:UserRegisterService.\u0275fac});const facadeProviders=[UserEmailService,UserPasswordService,UserProfileService,UserRegisterService,{provide:spartacus_user_profile_root.PF,useExisting:UserEmailService},{provide:spartacus_user_profile_root.LL,useExisting:UserPasswordService},{provide:spartacus_user_profile_root.aT,useExisting:UserProfileService},{provide:spartacus_user_profile_root.zm,useExisting:UserRegisterService}];class UserProfileCoreModule{}__name(UserProfileCoreModule,"UserProfileCoreModule"),UserProfileCoreModule.\u0275fac=__name(function(t){return new(t||UserProfileCoreModule)},"UserProfileCoreModule_Factory"),UserProfileCoreModule.\u0275mod=core.oAB({type:UserProfileCoreModule}),UserProfileCoreModule.\u0275inj=core.cJS({providers:[UserProfileConnector,...facadeProviders]});var http=__webpack_require__(529),catchError=__webpack_require__(7221);class OccUserProfileAdapter{constructor(http2,occEndpoints,converter){this.http=http2,this.occEndpoints=occEndpoints,this.converter=converter}update(userId,user){const endpoint=this.occEndpoints.isConfigured("userUpdateProfile")?"userUpdateProfile":"user",url=this.occEndpoints.buildUrl(endpoint,{urlParams:{userId}});return user=this.converter.convert(user,USER_PROFILE_SERIALIZER),this.http.patch(url,user).pipe((0,catchError.K)(error=>(0,throwError._)((0,spartacus_core.cxH)(error))))}register(user){const url=this.occEndpoints.buildUrl("userRegister");let headers=new http.WM({"Content-Type":"application/json"});return headers=spartacus_core.Fox.createHeader(spartacus_core._Re,!0,headers),user=this.converter.convert(user,USER_SIGN_UP_SERIALIZER),this.http.post(url,user,{headers}).pipe((0,catchError.K)(error=>(0,throwError._)((0,spartacus_core.cxH)(error))),this.converter.pipeable(USER_PROFILE_NORMALIZER))}registerGuest(guid,password){const url=this.occEndpoints.buildUrl("userRegister");let headers=new http.WM({"Content-Type":"application/x-www-form-urlencoded"});headers=spartacus_core.Fox.createHeader(spartacus_core._Re,!0,headers);const httpParams=(new http.LE).set("guid",guid).set("password",password);return this.http.post(url,httpParams,{headers}).pipe((0,catchError.K)(error=>(0,throwError._)((0,spartacus_core.cxH)(error))),this.converter.pipeable(USER_PROFILE_NORMALIZER))}requestForgotPasswordEmail(userEmailAddress){const url=this.occEndpoints.buildUrl("userForgotPassword"),httpParams=(new http.LE).set("userId",userEmailAddress);let headers=new http.WM({"Content-Type":"application/x-www-form-urlencoded"});return headers=spartacus_core.Fox.createHeader(spartacus_core._Re,!0,headers),this.http.post(url,httpParams,{headers}).pipe((0,catchError.K)(error=>(0,throwError._)((0,spartacus_core.cxH)(error))))}resetPassword(token,newPassword){const url=this.occEndpoints.buildUrl("userResetPassword");let headers=new http.WM({"Content-Type":"application/json"});return headers=spartacus_core.Fox.createHeader(spartacus_core._Re,!0,headers),this.http.post(url,{token,newPassword},{headers}).pipe((0,catchError.K)(error=>(0,throwError._)((0,spartacus_core.cxH)(error))))}updateEmail(userId,currentPassword,newUserId){const url=this.occEndpoints.buildUrl("userUpdateLoginId",{urlParams:{userId}}),httpParams=(new http.LE).set("password",currentPassword).set("newLogin",newUserId),headers=new http.WM({"Content-Type":"application/x-www-form-urlencoded"});return this.http.put(url,httpParams,{headers}).pipe((0,catchError.K)(error=>(0,throwError._)((0,spartacus_core.cxH)(error))))}updatePassword(userId,oldPassword,newPassword){const url=this.occEndpoints.buildUrl("userUpdatePassword",{urlParams:{userId}}),httpParams=(new http.LE).set("old",oldPassword).set("new",newPassword),headers=new http.WM({"Content-Type":"application/x-www-form-urlencoded"});return this.http.put(url,httpParams,{headers}).pipe((0,catchError.K)(error=>(0,throwError._)((0,spartacus_core.cxH)(error))))}close(userId){const endpoint=this.occEndpoints.isConfigured("userCloseAccount")?"userCloseAccount":"user",url=this.occEndpoints.buildUrl(endpoint,{urlParams:{userId}});return this.http.delete(url).pipe((0,catchError.K)(error=>(0,throwError._)((0,spartacus_core.cxH)(error))))}loadTitles(){const url=this.occEndpoints.buildUrl("titles");return this.http.get(url).pipe((0,catchError.K)(error=>(0,throwError._)((0,spartacus_core.cxH)(error))),(0,map.U)(titleList=>titleList.titles??[]),this.converter.pipeableMany(TITLE_NORMALIZER))}}__name(OccUserProfileAdapter,"OccUserProfileAdapter"),OccUserProfileAdapter.\u0275fac=__name(function(t){return new(t||OccUserProfileAdapter)(core.LFG(http.eN),core.LFG(spartacus_core.Lz0),core.LFG(spartacus_core.IXI))},"OccUserProfileAdapter_Factory"),OccUserProfileAdapter.\u0275prov=core.Yz7({token:OccUserProfileAdapter,factory:OccUserProfileAdapter.\u0275fac});class UserProfileOccModule{}__name(UserProfileOccModule,"UserProfileOccModule"),UserProfileOccModule.\u0275fac=__name(function(t){return new(t||UserProfileOccModule)},"UserProfileOccModule_Factory"),UserProfileOccModule.\u0275mod=core.oAB({type:UserProfileOccModule}),UserProfileOccModule.\u0275inj=core.cJS({providers:[(0,spartacus_core.i51)({backend:{occ:{endpoints:{userRegister:"users",userForgotPassword:"forgottenpasswordtokens",userResetPassword:"resetpassword",userUpdateLoginId:"users/${userId}/login",userUpdatePassword:"users/${userId}/password",titles:"titles"}}}}),{provide:UserProfileAdapter,useClass:OccUserProfileAdapter}]});class UserProfileModule{}__name(UserProfileModule,"UserProfileModule"),UserProfileModule.\u0275fac=__name(function(t){return new(t||UserProfileModule)},"UserProfileModule_Factory"),UserProfileModule.\u0275mod=core.oAB({type:UserProfileModule}),UserProfileModule.\u0275inj=core.cJS({imports:[UserProfileCoreModule,UserProfileOccModule,UserProfileComponentsModule]});const extensions=[];__webpack_require__(988).N.cdc&&extensions.push(CDCUserProfileModule);class UserProfileWrapperModule{}__name(UserProfileWrapperModule,"UserProfileWrapperModule"),UserProfileWrapperModule.\u0275fac=__name(function(t){return new(t||UserProfileWrapperModule)},"UserProfileWrapperModule_Factory"),UserProfileWrapperModule.\u0275mod=core.oAB({type:UserProfileWrapperModule}),UserProfileWrapperModule.\u0275inj=core.cJS({imports:[UserProfileModule,extensions]})}};