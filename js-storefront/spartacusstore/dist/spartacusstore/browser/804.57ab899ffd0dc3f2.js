"use strict";(self.webpackChunkstorefrontapp=self.webpackChunkstorefrontapp||[]).push([[804],{1804:(y,C,n)=>{n.r(C),n.d(C,{MiniCartComponent:()=>D,MiniCartComponentService:()=>E,MiniCartModule:()=>L});var t=n(4650),p=n(6789),o=n(1742),v=n(1086),P=n(6053),_=n(7545),M=n(1059),a=n(4850),f=n(5778),h=n(4290),c=n(9764),l=n(610),d=n(6895);const g=function(){return{cxRoute:"cart"}},m=function(r){return{count:r}},O=function(r){return{total:r}};let E=(()=>{class r{constructor(e,i,u,A,T){this.activeCartFacade=e,this.authService=i,this.statePersistenceService=u,this.siteContextParamsService=A,this.eventService=T}getQuantity(){return this.activeCartRequired().pipe((0,_.w)(e=>e?this.activeCartFacade.getActive().pipe((0,M.O)({deliveryItemsQuantity:0}),(0,a.U)(i=>i.deliveryItemsQuantity||0)):(0,v.of)(0)))}getTotalPrice(){return this.activeCartRequired().pipe((0,_.w)(e=>e?this.activeCartFacade.getActive().pipe((0,a.U)(i=>i.totalPrice?.formattedValue??"")):(0,v.of)("")))}activeCartRequired(){return(0,P.aj)([this.hasActiveCartInStorage(),this.authService.isUserLoggedIn(),this.isCartCreated()]).pipe((0,a.U)(([e,i,u])=>e||i||u),(0,f.x)(),(0,h.o)(e=>!e,!0))}hasActiveCartInStorage(){return this.getCartStateFromBrowserStorage().pipe((0,a.U)(e=>Boolean(e?.active)))}isCartCreated(){return this.eventService.get(p.su).pipe((0,a.U)(e=>!0),(0,M.O)(!1))}getCartStateFromBrowserStorage(){return this.siteContextParamsService.getValues([o.iEg]).pipe((0,a.U)(e=>this.statePersistenceService.readStateFromStorage({key:"cart",context:e,storageType:o.iHd.LOCAL_STORAGE})))}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(p.bu),t.LFG(o.e80),t.LFG(o.WBb),t.LFG(o.Qnj),t.LFG(o.POd))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),D=(()=>{class r{constructor(e){this.miniCartComponentService=e,this.iconTypes=c.e1G,this.quantity$=this.miniCartComponentService.getQuantity(),this.total$=this.miniCartComponentService.getTotalPrice()}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(E))},r.\u0275cmp=t.Xpm({type:r,selectors:[["cx-mini-cart"]],decls:13,vars:29,consts:[[3,"routerLink"],[3,"type"],[1,"total"],[1,"count"]],template:function(e,i){1&e&&(t.TgZ(0,"a",0),t.ALo(1,"cxTranslate"),t.ALo(2,"async"),t.ALo(3,"cxUrl"),t._UZ(4,"cx-icon",1),t.TgZ(5,"span",2),t._uU(6),t.ALo(7,"cxTranslate"),t.ALo(8,"async"),t.qZA(),t.TgZ(9,"span",3),t._uU(10),t.ALo(11,"cxTranslate"),t.ALo(12,"async"),t.qZA()()),2&e&&(t.Q6J("routerLink",t.lcZ(3,10,t.DdM(22,g))),t.uIk("aria-label",t.xi3(1,5,"miniCart.item",t.VKq(23,m,t.lcZ(2,8,i.quantity$)))),t.xp6(4),t.Q6J("type",i.iconTypes.CART),t.xp6(2),t.hij(" ",t.xi3(7,12,"miniCart.total",t.VKq(25,O,t.lcZ(8,15,i.total$)))," "),t.xp6(4),t.hij(" ",t.xi3(11,17,"miniCart.count",t.VKq(27,m,t.lcZ(12,20,i.quantity$)))," "))},dependencies:[l.yS,c.oJW,d.Ov,o.l2T,o.X$D],encapsulation:2,changeDetection:0}),r})(),L=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({providers:[(0,o.i51)({cmsComponents:{MiniCartComponent:{component:D}}})],imports:[d.ez,l.Bz,o.bhT,c.QX1,o.LUR]}),r})()}}]);