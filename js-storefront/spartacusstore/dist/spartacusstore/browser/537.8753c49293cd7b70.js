"use strict";(self.webpackChunkstorefrontapp=self.webpackChunkstorefrontapp||[]).push([[537],{8537:(ge,$,s)=>{s.r($),s.d($,{ApproverGuard:()=>x,ORDER_APPROVALS_NORMALIZER:()=>z,ORDER_APPROVAL_DECISION_NORMALIZER:()=>Y,ORDER_APPROVAL_ENTITIES:()=>Z,ORDER_APPROVAL_FEATURE:()=>P,ORDER_APPROVAL_LIST:()=>C,ORDER_APPROVAL_MAKE_DECISION_PROCESS_ID:()=>g,ORDER_APPROVAL_NORMALIZER:()=>y,OccOrderApprovalAdapter:()=>Lr,OccOrderApprovalDecisionNormalizer:()=>Dr,OccOrderApprovalListNormalizer:()=>hr,OccOrderApprovalNormalizer:()=>Er,OrderApprovalActions:()=>re,OrderApprovalAdapter:()=>B,OrderApprovalComponentsModule:()=>xr,OrderApprovalConnector:()=>Q,OrderApprovalDecisionValue:()=>E,OrderApprovalDetailFormComponent:()=>gr,OrderApprovalDetailService:()=>R,OrderApprovalDetailsModule:()=>Or,OrderApprovalListComponent:()=>mr,OrderApprovalListModule:()=>fr,OrderApprovalModule:()=>ue,OrderApprovalOccModule:()=>Rr,OrderApprovalSelectors:()=>ee,OrderApprovalService:()=>M,OrderDetailPermissionResultsComponent:()=>q});var r=s(4650),v=s(4006),W=s(341),H=s(6053),S=s(1086),X=s(7770),F=s(2994),O=s(2198),c=s(4850),I=s(373),m=s(7545),Pr=s(5154),U=s(7221),a=s(1742),d=s(8555),_=s(6895),f=s(9764),T=s(610),u=s(6978),Zr=s(9309),Cr=s(529),Mr=s(5503),A=s(5024);function yr(o,n){1&o&&(r.TgZ(0,"div")(1,"div",3),r._UZ(2,"cx-spinner"),r.qZA()())}const Sr=function(o,n){return{orderCode:o,orderTotal:n}};function Fr(o,n){if(1&o&&(r.TgZ(0,"div",7)(1,"div",8),r._uU(2),r.ALo(3,"cxTranslate"),r.qZA()()),2&o){const e=r.oxw(3).ngIf,t=r.oxw();r.xp6(2),r.hij(" ",r.xi3(3,1,"orderApprovalDetails.form.title_"+t.approvalDecision,r.WLB(4,Sr,null==e||null==e.order?null:e.order.code,null==e||null==e.order||null==e.order.totalPriceWithTax?null:e.order.totalPriceWithTax.formattedValue))," ")}}function Ir(o,n){if(1&o){const e=r.EpF();r.TgZ(0,"form",9),r.NdJ("ngSubmit",function(){r.CHM(e);const i=r.oxw(3).ngIf,p=r.oxw();return r.KtG(p.submitDecision(i))}),r.TgZ(1,"label"),r._uU(2),r.ALo(3,"cxTranslate"),r._UZ(4,"textarea",10)(5,"cx-form-errors",11),r.qZA(),r.TgZ(6,"div",12)(7,"div",13)(8,"button",14),r.NdJ("click",function(){r.CHM(e);const i=r.oxw(4);return r.KtG(i.cancelDecisionForm())}),r._uU(9),r.ALo(10,"cxTranslate"),r.qZA()(),r.TgZ(11,"div",13)(12,"button",15),r._uU(13),r.ALo(14,"cxTranslate"),r.qZA()()()()}if(2&o){const e=r.oxw(4);r.Q6J("formGroup",e.approvalForm),r.xp6(2),r.hij("",r.lcZ(3,5,"orderApprovalDetails.form.comment_"+e.approvalDecision+".label")," "),r.xp6(3),r.Q6J("control",e.approvalForm.get("comment")),r.xp6(4),r.hij(" ",r.lcZ(10,7,"orderApprovalDetails.form.cancel")," "),r.xp6(4),r.hij(" ",r.lcZ(14,9,"orderApprovalDetails.form.submit_"+e.approvalDecision)," ")}}function Ur(o,n){if(1&o&&(r.ynx(0),r.YNc(1,Fr,4,7,"div",5),r.YNc(2,Ir,15,11,"form",6),r.BQk()),2&o){const e=r.oxw(3);r.xp6(1),r.Q6J("ngIf",e.approvalFormVisible),r.xp6(1),r.Q6J("ngIf",e.approvalFormVisible)}}function br(o,n){if(1&o){const e=r.EpF();r.TgZ(0,"div",16)(1,"button",19),r.NdJ("click",function(){r.CHM(e);const i=r.oxw(4);return r.KtG(i.displayDecisionForm(i.approvalDecisionValue.REJECT))}),r._uU(2),r.ALo(3,"cxTranslate"),r.qZA()()}2&o&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"orderApprovalDetails.showForm_REJECT")," "))}function kr(o,n){if(1&o){const e=r.EpF();r.TgZ(0,"div",16)(1,"button",19),r.NdJ("click",function(){r.CHM(e);const i=r.oxw(4);return r.KtG(i.displayDecisionForm(i.approvalDecisionValue.APPROVE))}),r._uU(2),r.ALo(3,"cxTranslate"),r.qZA()()}2&o&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"orderApprovalDetails.showForm_APPROVE")," "))}const Nr=function(){return{cxRoute:"orderApprovals"}};function wr(o,n){if(1&o&&(r.ynx(0),r.TgZ(1,"div",12)(2,"div",16)(3,"a",17),r.ALo(4,"cxUrl"),r._uU(5),r.ALo(6,"cxTranslate"),r.qZA()(),r.YNc(7,br,4,3,"div",18),r.YNc(8,kr,4,3,"div",18),r.qZA(),r.BQk()),2&o){const e=r.oxw(2).ngIf;r.xp6(3),r.Q6J("routerLink",r.lcZ(4,4,r.DdM(8,Nr))),r.xp6(2),r.Oqu(r.lcZ(6,6,"orderApprovalDetails.back")),r.xp6(2),r.Q6J("ngIf",null==e?null:e.approvalDecisionRequired),r.xp6(1),r.Q6J("ngIf",null==e?null:e.approvalDecisionRequired)}}function Vr(o,n){if(1&o&&(r._UZ(0,"div",4),r.ALo(1,"cxTranslate"),r.YNc(2,Ur,3,2,"ng-container",0),r.YNc(3,wr,9,9,"ng-container",0)),2&o){const e=r.oxw().ngIf,t=r.oxw();r.uIk("aria-label",r.lcZ(1,3,"common.loaded")),r.xp6(2),r.Q6J("ngIf",null==e?null:e.approvalDecisionRequired),r.xp6(1),r.Q6J("ngIf",!t.approvalFormVisible)}}function Gr(o,n){if(1&o&&(r.ynx(0),r.YNc(1,yr,3,0,"div",1),r.ALo(2,"async"),r.YNc(3,Vr,4,5,"ng-template",null,2,r.W1O),r.BQk()),2&o){const e=r.MAs(4),t=r.oxw();r.xp6(1),r.Q6J("ngIf",r.lcZ(2,2,t.loading$))("ngIfElse",e)}}function Kr(o,n){if(1&o&&(r.TgZ(0,"tr")(1,"td",7)(2,"div",8),r._uU(3),r.ALo(4,"cxTranslate"),r.qZA(),r._uU(5),r.ALo(6,"cxTranslate"),r.qZA(),r.TgZ(7,"td",9)(8,"div",8),r._uU(9),r.ALo(10,"cxTranslate"),r.qZA(),r._uU(11),r.qZA(),r.TgZ(12,"td",10)(13,"div",8),r._uU(14),r.ALo(15,"cxTranslate"),r.qZA(),r._uU(16),r.qZA(),r.TgZ(17,"td",11)(18,"div",8),r._uU(19),r.ALo(20,"cxTranslate"),r.qZA(),r._uU(21),r.ALo(22,"cxTranslate"),r.qZA()()),2&o){const e=n.$implicit;r.xp6(3),r.hij(" ",r.lcZ(4,8,"orderApprovalDetails.permissionResults.permission")," "),r.xp6(2),r.hij(" ",r.lcZ(6,10,"orderApprovalDetails.permissionResults.permissionType_"+(null==e||null==e.permissionType?null:e.permissionType.code))," "),r.xp6(4),r.hij(" ",r.lcZ(10,12,"orderApprovalDetails.permissionResults.approver")," "),r.xp6(2),r.hij(" ",e.approverName," "),r.xp6(3),r.hij(" ",r.lcZ(15,14,"orderApprovalDetails.permissionResults.status")," "),r.xp6(2),r.hij(" ",e.statusDisplay," "),r.xp6(3),r.hij(" ",r.lcZ(20,16,"orderApprovalDetails.permissionResults.approverComments")," "),r.xp6(2),r.hij(" ",e.approverNotes?e.approverNotes:r.lcZ(22,18,"orderApprovalDetails.permissionResults.noApprovalComments")," ")}}function Jr(o,n){if(1&o&&(r.ynx(0),r.TgZ(1,"div",1)(2,"div",2),r._uU(3),r.ALo(4,"cxTranslate"),r.qZA()(),r.TgZ(5,"table",3)(6,"thead",4)(7,"th",5),r._uU(8),r.ALo(9,"cxTranslate"),r.qZA(),r.TgZ(10,"th",5),r._uU(11),r.ALo(12,"cxTranslate"),r.qZA(),r.TgZ(13,"th",5),r._uU(14),r.ALo(15,"cxTranslate"),r.qZA(),r.TgZ(16,"th",5),r._uU(17),r.ALo(18,"cxTranslate"),r.qZA()(),r.TgZ(19,"tbody"),r.YNc(20,Kr,23,20,"tr",6),r.qZA()(),r.BQk()),2&o){const e=r.oxw().ngIf;r.xp6(3),r.hij(" ",r.lcZ(4,6,"orderApprovalDetails.permissionResults.header")," "),r.xp6(5),r.hij(" ",r.lcZ(9,8,"orderApprovalDetails.permissionResults.permission")," "),r.xp6(3),r.hij(" ",r.lcZ(12,10,"orderApprovalDetails.permissionResults.approver")," "),r.xp6(3),r.hij(" ",r.lcZ(15,12,"orderApprovalDetails.permissionResults.status")," "),r.xp6(3),r.hij(" ",r.lcZ(18,14,"orderApprovalDetails.permissionResults.approverComments")," "),r.xp6(3),r.Q6J("ngForOf",e.permissionResults)}}function jr(o,n){if(1&o&&(r.ynx(0),r.YNc(1,Jr,21,16,"ng-container",0),r.BQk()),2&o){const e=n.ngIf;r.xp6(1),r.Q6J("ngIf",null==e.permissionResults?null:e.permissionResults.length)}}function qr(o,n){if(1&o){const e=r.EpF();r.ynx(0),r.TgZ(1,"label")(2,"span",14),r._uU(3),r.ALo(4,"cxTranslate"),r.qZA(),r.TgZ(5,"cx-sorting",15),r.NdJ("sortListEvent",function(i){r.CHM(e);const p=r.oxw(3);return r.KtG(p.changeSortCode(i))}),r.ALo(6,"async"),r.ALo(7,"cxTranslate"),r.qZA()(),r.BQk()}if(2&o){const e=r.oxw(2).ngIf,t=r.oxw();r.xp6(3),r.Oqu(r.lcZ(4,5,"orderHistory.sortOrders")),r.xp6(2),r.Q6J("sortOptions",e.sorts)("sortLabels",r.lcZ(6,7,t.sortLabels$))("selectedOption",e.pagination.sort)("ariaLabel",r.lcZ(7,9,"orderHistory.sortOrders"))}}function Br(o,n){if(1&o){const e=r.EpF();r.ynx(0),r.TgZ(1,"cx-sorting",15),r.NdJ("sortListEvent",function(i){r.CHM(e);const p=r.oxw(3);return r.KtG(p.changeSortCode(i))}),r.ALo(2,"async"),r.ALo(3,"cxTranslate"),r.qZA(),r.BQk()}if(2&o){const e=r.oxw(2).ngIf,t=r.oxw();r.xp6(1),r.Q6J("sortOptions",e.sorts)("sortLabels",r.lcZ(2,4,t.sortLabels$))("selectedOption",e.pagination.sort)("ariaLabel",r.lcZ(3,6,"orderHistory.sortOrders"))}}function Qr(o,n){1&o&&(r.TgZ(0,"caption",14),r._uU(1),r.ALo(2,"cxTranslate"),r.qZA()),2&o&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"orderApprovalList.orderApprovalList")," "))}const D=function(o){return{approvalCode:o}},h=function(o){return{cxRoute:"orderApprovalDetails",params:o}};function zr(o,n){if(1&o){const e=r.EpF();r.TgZ(0,"tr",16),r.NdJ("click",function(i){const l=r.CHM(e).$implicit,L=r.oxw(3);return r.KtG(L.goToApprovalDetails(i,l))}),r.TgZ(1,"td",17)(2,"div",18),r._uU(3),r.ALo(4,"cxTranslate"),r.qZA(),r.TgZ(5,"a",19),r.ALo(6,"cxUrl"),r._uU(7),r.qZA()(),r.TgZ(8,"td",20)(9,"div",18),r._uU(10),r.ALo(11,"cxTranslate"),r.qZA(),r.TgZ(12,"a",19),r.ALo(13,"cxUrl"),r._uU(14),r.ALo(15,"cxTranslate"),r.qZA()(),r.TgZ(16,"td",21)(17,"div",18),r._uU(18),r.ALo(19,"cxTranslate"),r.qZA(),r.TgZ(20,"a",19),r.ALo(21,"cxUrl"),r._uU(22),r.qZA()(),r.TgZ(23,"td",22)(24,"div",18),r._uU(25),r.ALo(26,"cxTranslate"),r.qZA(),r.TgZ(27,"a",19),r.ALo(28,"cxUrl"),r._uU(29),r.ALo(30,"cxDate"),r.qZA()(),r.TgZ(31,"td",23)(32,"div",18),r._uU(33),r.ALo(34,"cxTranslate"),r.qZA(),r.TgZ(35,"a",19),r.ALo(36,"cxUrl"),r._uU(37),r.ALo(38,"cxTranslate"),r.qZA()(),r.TgZ(39,"td",24)(40,"div",18),r._uU(41),r.ALo(42,"cxTranslate"),r.qZA(),r.TgZ(43,"a",19),r.ALo(44,"cxUrl"),r._uU(45),r.qZA()()()}if(2&o){const e=n.$implicit;r.xp6(3),r.hij(" ",r.lcZ(4,18,"orderApprovalList.orderCode")," "),r.xp6(2),r.Q6J("routerLink",r.lcZ(6,20,r.VKq(51,h,r.VKq(49,D,null==e?null:e.code)))),r.xp6(2),r.hij(" ",null==e.order?null:e.order.code,""),r.xp6(3),r.hij(" ",r.lcZ(11,22,"orderApprovalList.POCode")," "),r.xp6(2),r.Q6J("routerLink",r.lcZ(13,24,r.VKq(55,h,r.VKq(53,D,null==e?null:e.code)))),r.xp6(2),r.Oqu((null==e.order?null:e.order.purchaseOrderNumber)||r.lcZ(15,26,"orderApprovalList.none")),r.xp6(4),r.hij(" ",r.lcZ(19,28,"orderApprovalList.placedBy")," "),r.xp6(2),r.Q6J("routerLink",r.lcZ(21,30,r.VKq(59,h,r.VKq(57,D,null==e?null:e.code)))),r.xp6(2),r.Oqu(null==e.order||null==e.order.orgCustomer?null:e.order.orgCustomer.name),r.xp6(3),r.hij(" ",r.lcZ(26,32,"orderApprovalList.date")," "),r.xp6(2),r.Q6J("routerLink",r.lcZ(28,34,r.VKq(63,h,r.VKq(61,D,null==e?null:e.code)))),r.xp6(2),r.Oqu(r.xi3(30,36,null==e.order?null:e.order.created,"longDate")),r.xp6(4),r.hij(" ",r.lcZ(34,39,"orderApprovalList.status")," "),r.xp6(2),r.Q6J("routerLink",r.lcZ(36,41,r.VKq(67,h,r.VKq(65,D,null==e?null:e.code)))),r.xp6(2),r.hij(" ",r.lcZ(38,43,"orderDetails.statusDisplay_"+(null==e.order?null:e.order.statusDisplay)),""),r.xp6(4),r.hij(" ",r.lcZ(42,45,"orderApprovalList.total")," "),r.xp6(2),r.Q6J("routerLink",r.lcZ(44,47,r.VKq(71,h,r.VKq(69,D,null==e?null:e.code)))),r.xp6(2),r.hij(" ",null==e.order||null==e.order.totalPrice?null:e.order.totalPrice.formattedValue,"")}}function Yr(o,n){if(1&o){const e=r.EpF();r.ynx(0),r.TgZ(1,"label")(2,"span",14),r._uU(3),r.ALo(4,"cxTranslate"),r.qZA(),r.TgZ(5,"cx-sorting",15),r.NdJ("sortListEvent",function(i){r.CHM(e);const p=r.oxw(3);return r.KtG(p.changeSortCode(i))}),r.ALo(6,"async"),r.ALo(7,"cxTranslate"),r.qZA()(),r.BQk()}if(2&o){const e=r.oxw(2).ngIf,t=r.oxw();r.xp6(3),r.Oqu(r.lcZ(4,5,"orderHistory.sortOrders")),r.xp6(2),r.Q6J("sortOptions",e.sorts)("sortLabels",r.lcZ(6,7,t.sortLabels$))("selectedOption",e.pagination.sort)("ariaLabel",r.lcZ(7,9,"orderHistory.sortOrders"))}}function $r(o,n){if(1&o){const e=r.EpF();r.ynx(0),r.TgZ(1,"cx-sorting",25),r.NdJ("sortListEvent",function(i){r.CHM(e);const p=r.oxw(3);return r.KtG(p.changeSortCode(i))}),r.ALo(2,"async"),r.qZA(),r.BQk()}if(2&o){const e=r.oxw(2).ngIf,t=r.oxw();r.xp6(1),r.Q6J("sortOptions",e.sorts)("sortLabels",r.lcZ(2,3,t.sortLabels$))("selectedOption",e.pagination.sort)}}function Wr(o,n){if(1&o){const e=r.EpF();r.ynx(0),r.TgZ(1,"div",3)(2,"div",4),r.YNc(3,qr,8,11,"ng-container",5),r.YNc(4,Br,4,8,"ng-container",5),r.qZA(),r.TgZ(5,"div",6)(6,"cx-pagination",7),r.NdJ("viewPageEvent",function(i){r.CHM(e);const p=r.oxw(2);return r.KtG(p.pageChange(i))}),r.qZA()()(),r.TgZ(7,"table",8),r.YNc(8,Qr,3,3,"caption",9),r.TgZ(9,"thead",10)(10,"th",11),r._uU(11),r.ALo(12,"cxTranslate"),r.qZA(),r.TgZ(13,"th",11),r._uU(14),r.ALo(15,"cxTranslate"),r.qZA(),r.TgZ(16,"th",11),r._uU(17),r.ALo(18,"cxTranslate"),r.qZA(),r.TgZ(19,"th",11),r._uU(20),r.ALo(21,"cxTranslate"),r.qZA(),r.TgZ(22,"th",11),r._uU(23),r.ALo(24,"cxTranslate"),r.qZA(),r.TgZ(25,"th",11),r._uU(26),r.ALo(27,"cxTranslate"),r.qZA()(),r.TgZ(28,"tbody"),r.YNc(29,zr,46,73,"tr",12),r.qZA()(),r.TgZ(30,"div",13)(31,"div",4),r.YNc(32,Yr,8,11,"ng-container",5),r.YNc(33,$r,3,5,"ng-container",5),r.qZA(),r.TgZ(34,"div",6)(35,"cx-pagination",7),r.NdJ("viewPageEvent",function(i){r.CHM(e);const p=r.oxw(2);return r.KtG(p.pageChange(i))}),r.qZA()()(),r.BQk()}if(2&o){const e=r.oxw().ngIf;r.xp6(3),r.Q6J("cxFeatureLevel","5.1"),r.xp6(1),r.Q6J("cxFeatureLevel","!5.1"),r.xp6(2),r.Q6J("pagination",e.pagination),r.xp6(2),r.Q6J("cxFeatureLevel","5.1"),r.xp6(3),r.hij(" ",r.lcZ(12,14,"orderApprovalList.orderCode")," "),r.xp6(3),r.Oqu(r.lcZ(15,16,"orderApprovalList.POCode")),r.xp6(3),r.Oqu(r.lcZ(18,18,"orderApprovalList.placedBy")),r.xp6(3),r.Oqu(r.lcZ(21,20,"orderApprovalList.date")),r.xp6(3),r.hij(" ",r.lcZ(24,22,"orderApprovalList.status")," "),r.xp6(3),r.Oqu(r.lcZ(27,24,"orderApprovalList.total")),r.xp6(3),r.Q6J("ngForOf",e.values),r.xp6(3),r.Q6J("cxFeatureLevel","5.1"),r.xp6(1),r.Q6J("cxFeatureLevel","!5.1"),r.xp6(2),r.Q6J("pagination",e.pagination)}}function Hr(o,n){1&o&&(r.TgZ(0,"div",26)(1,"div",27)(2,"div"),r._uU(3),r.ALo(4,"cxTranslate"),r.qZA()()()),2&o&&(r.xp6(3),r.Oqu(r.lcZ(4,1,"orderApprovalList.emptyList")))}function Xr(o,n){if(1&o&&(r.ynx(0),r.YNc(1,Wr,36,26,"ng-container",1),r.YNc(2,Hr,5,3,"ng-template",null,2,r.W1O),r.BQk()),2&o){const e=n.ngIf,t=r.MAs(3);r.xp6(1),r.Q6J("ngIf",e.pagination&&e.pagination.totalResults&&e.pagination.totalResults>0)("ngIfElse",t)}}var E=(()=>{return(o=E||(E={})).APPROVE="APPROVE",o.REJECT="REJECT",E;var o})();const P="order-approval",Z="order-approval-entities",C="order-approval-list",g="orderApproval.makeDecision",b="[OrderApproval] Load OrderApproval Data",rr="[OrderApproval] Load OrderApproval Data Fail",k="[OrderApproval] Load OrderApproval Data Success",N="[OrderApproval] Load OrderApprovals",er="[OrderApproval] Load OrderApprovals Fail",w="[OrderApproval] Load OrderApprovals Success",V="[OrderApproval] Make OrderApproval Decision",or="[OrderApproval] Make OrderApproval Decision Fail",G="[OrderApproval] Make OrderApproval Decision Success",tr="[OrderApproval] Make OrderApproval Decision Reset";class K extends a.kPG.EntityLoadAction{constructor(n){super(Z,n.orderApprovalCode),this.payload=n,this.type=b}}class nr extends a.kPG.EntityFailAction{constructor(n){super(Z,n.orderApprovalCode,n.error),this.payload=n,this.type=rr}}class J extends a.kPG.EntitySuccessAction{constructor(n){super(Z,Array.isArray(n)?n.map(e=>e.code??""):n.code??""),this.payload=n,this.type=k}}class ar extends a.kPG.EntityLoadAction{constructor(n){super(C,a.kPG.serializeSearchConfig(n.params)),this.payload=n,this.type=N}}class ir extends a.kPG.EntityFailAction{constructor(n){super(C,a.kPG.serializeSearchConfig(n.params),n.error),this.payload=n,this.type=er}}class pr extends a.kPG.EntitySuccessAction{constructor(n){super(C,a.kPG.serializeSearchConfig(n.params)),this.payload=n,this.type=w}}class sr extends a.kPG.EntityLoadAction{constructor(n){super(a.BzF,g),this.payload=n,this.type=V}}class lr extends a.kPG.EntityFailAction{constructor(n){super(a.BzF,g,n),this.payload=n,this.type=or}}class cr extends a.kPG.EntitySuccessAction{constructor(n){super(a.BzF,g),this.payload=n,this.type=G}}class dr extends a.kPG.EntityLoaderResetAction{constructor(){super(a.BzF,g),this.type=tr}}var re=Object.freeze({__proto__:null,LOAD_ORDER_APPROVAL:b,LOAD_ORDER_APPROVAL_FAIL:rr,LOAD_ORDER_APPROVAL_SUCCESS:k,LOAD_ORDER_APPROVALS:N,LOAD_ORDER_APPROVALS_FAIL:er,LOAD_ORDER_APPROVALS_SUCCESS:w,MAKE_DECISION:V,MAKE_DECISION_FAIL:or,MAKE_DECISION_SUCCESS:G,MAKE_DECISION_RESET:tr,LoadOrderApproval:K,LoadOrderApprovalFail:nr,LoadOrderApprovalSuccess:J,LoadOrderApprovals:ar,LoadOrderApprovalsFail:ir,LoadOrderApprovalsSuccess:pr,MakeDecision:sr,MakeDecisionFail:lr,MakeDecisionSuccess:cr,MakeDecisionReset:dr});const _r=(0,d.ZF)(P),j=(0,d.P1)(_r,o=>o[P]),vr=(0,d.P1)(j,o=>o&&o.entities),ur=o=>(0,d.P1)(vr,n=>a.kPG.entityLoaderStateSelector(n,o)),Ar=o=>(0,d.P1)(j,n=>a.kPG.denormalizeSearch(n,o));var ee=Object.freeze({__proto__:null,getOrderApprovalState:_r,getOrderApprovalManagementState:j,getOrderApprovalsState:vr,getOrderApproval:ur,getOrderApprovalList:Ar});let M=(()=>{class o{constructor(e,t){this.store=e,this.userIdService=t}loadOrderApproval(e){this.userIdService.takeUserId().subscribe(t=>this.store.dispatch(new K({userId:t,orderApprovalCode:e})))}loadOrderApprovals(e){this.userIdService.takeUserId().subscribe(t=>this.store.dispatch(new ar({userId:t,params:e})))}getOrderApproval(e){return this.store.select(ur(e))}getOrderApprovalList(e){return this.store.select(Ar(e))}get(e){return this.getOrderApproval(e).pipe((0,X.QV)(W.N),(0,F.b)(t=>{t.loading||t.success||t.error||this.loadOrderApproval(e)}),(0,O.h)(t=>Boolean(t.success||t.error)),(0,c.U)(t=>t.value))}getOrderApprovalLoading(e){return this.getOrderApproval(e).pipe((0,I.j)("loading"),(0,c.U)(t=>t??!1))}getList(e){return this.getOrderApprovalList(e).pipe((0,X.QV)(W.N),(0,F.b)(t=>{t.loading||t.success||t.error||this.loadOrderApprovals(e)}),(0,O.h)(t=>Boolean(t.success||t.error)),(0,c.U)(t=>t.value))}makeDecision(e,t){this.userIdService.takeUserId().subscribe(i=>this.store.dispatch(new sr({userId:i,orderApprovalCode:e,orderApprovalDecision:t})))}getMakeDecisionResultLoading(){return this.store.pipe((0,d.Ys)(a.VkE.getProcessLoadingFactory(g)))}getMakeDecisionResultError(){return this.store.pipe((0,d.Ys)(a.VkE.getProcessErrorFactory(g)))}getMakeDecisionResultSuccess(){return this.store.pipe((0,d.Ys)(a.VkE.getProcessSuccessFactory(g)))}resetMakeDecisionProcessState(){this.store.dispatch(new dr)}}return o.\u0275fac=function(e){return new(e||o)(r.LFG(d.yh),r.LFG(a.XBV))},o.\u0275prov=r.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),R=(()=>{class o{constructor(e,t){this.routingService=e,this.orderApprovalService=t,this.approvalCode$=this.routingService.getRouterState().pipe((0,c.U)(i=>i.state.params.approvalCode)),this.orderApproval$=this.approvalCode$.pipe((0,O.h)(i=>Boolean(i)),(0,F.b)(i=>this.orderApprovalService.loadOrderApproval(i)),(0,m.w)(i=>this.orderApprovalService.get(i)),(0,Pr.d)({bufferSize:1,refCount:!0})),this.order$=this.orderApproval$.pipe((0,I.j)("order"))}getOrderApprovalCodeFromRoute(){return this.approvalCode$}getOrderDetails(){return this.order$}getOrderApproval(){return this.orderApproval$}}return o.\u0275fac=function(e){return new(e||o)(r.LFG(a.Znh),r.LFG(M))},o.\u0275prov=r.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),gr=(()=>{class o{constructor(e,t,i){this.orderApprovalDetailService=e,this.orderApprovalService=t,this.fb=i,this.approvalDecisionValue=E,this.approvalFormVisible=!1,this.approvalForm=this.fb.group({comment:[""]}),this.orderApprovalLoading$=this.orderApprovalDetailService.getOrderApprovalCodeFromRoute().pipe((0,m.w)(p=>this.orderApprovalService.getOrderApprovalLoading(p))),this.decisionResultLoading$=this.orderApprovalService.getMakeDecisionResultLoading(),this.loading$=(0,H.aj)([this.orderApprovalLoading$,this.decisionResultLoading$]).pipe((0,c.U)(([p,l])=>p||l)),this.orderApproval$=this.orderApprovalDetailService.getOrderApproval(),this.orderApprovalService.resetMakeDecisionProcessState()}displayDecisionForm(e){this.approvalDecision=e,e===E.APPROVE?this.approvalForm.controls.comment.clearValidators():this.approvalForm.controls.comment.setValidators([v.kI.required]),this.approvalFormVisible=!0}cancelDecisionForm(){this.approvalFormVisible=!1,this.approvalForm.reset()}submitDecision(e){this.approvalForm.valid?(this.orderApprovalService.makeDecision(e.code??"",{decision:this.approvalDecision,comment:this.approvalForm.controls.comment.value}),this.approvalFormVisible=!1):this.approvalForm.markAllAsTouched()}ngOnDestroy(){this.orderApprovalService.resetMakeDecisionProcessState()}}return o.\u0275fac=function(e){return new(e||o)(r.Y36(R),r.Y36(M),r.Y36(v.QS))},o.\u0275cmp=r.Xpm({type:o,selectors:[["cx-order-approval-detail-form"]],decls:2,vars:3,consts:[[4,"ngIf"],[4,"ngIf","ngIfElse"],["approvalFormTemplate",""],[1,"cx-spinner"],["role","status"],["class","cx-approval-form-header row",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"cx-approval-form-header","row"],[1,"cx-approval-form-label","col-sm-12"],[3,"formGroup","ngSubmit"],["rows","3","formControlName","comment","maxlength","255",1,"form-control"],[3,"control"],[1,"form-group","row"],[1,"col-lg-6","col-md-12"],["type","button",1,"btn","btn-block","btn-secondary",3,"click"],["type","submit",1,"btn","btn-block","btn-primary"],[1,"col-lg-4","col-md-12"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],["class","col-lg-4 col-md-12",4,"ngIf"],[1,"btn","btn-block","btn-primary",3,"click"]],template:function(e,t){1&e&&(r.YNc(0,Gr,5,4,"ng-container",0),r.ALo(1,"async")),2&e&&r.Q6J("ngIf",r.lcZ(1,1,t.orderApproval$))},dependencies:[v._Y,v.Fj,v.JJ,v.JL,v.nD,v.sg,v.u,_.O5,f.Ahv,f.ORR,T.yS,_.Ov,a.X$D,a.l2T],encapsulation:2,changeDetection:0}),o})(),x=(()=>{class o{constructor(e,t,i){this.userAccountFacade=e,this.routingService=t,this.globalMessageService=i}canActivate(){return this.userAccountFacade.get().pipe((0,O.h)(e=>!!e&&Object.keys(e).length>0),(0,I.j)("roles"),(0,c.U)(e=>{const t=Array.isArray(e)&&(e.includes(a.KOx.APPROVER)||e.includes(a.KOx.ADMIN));return t||(this.routingService.go({cxRoute:"home"}),this.globalMessageService.add({key:"orderApprovalGlobal.notification.noSufficientPermissions"},a.xUg.MSG_TYPE_WARNING)),t}))}}return o.\u0275fac=function(e){return new(e||o)(r.LFG(Zr.gf),r.LFG(a.Znh),r.LFG(a.IWp))},o.\u0275prov=r.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),q=(()=>{class o{constructor(e){this.orderDetailsService=e,this.order$=this.orderDetailsService.getOrderDetails()}}return o.\u0275fac=function(e){return new(e||o)(r.Y36(u.SE))},o.\u0275cmp=r.Xpm({type:o,selectors:[["cx-order-detail-permission-results"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"cx-approval-header"],[1,"cx-approval-label"],[1,"table","table-striped","cx-approval-table"],[1,"cx-approval-thead-mobile"],["scope","col"],[4,"ngFor","ngForOf"],[1,"cx-approval-permissionCode"],[1,"cx-approval-table-label"],[1,"cx-approval-approverName"],[1,"cx-approval-statusDisplay"],[1,"cx-approval-approvalNotes"]],template:function(e,t){1&e&&(r.YNc(0,jr,2,1,"ng-container",0),r.ALo(1,"async")),2&e&&r.Q6J("ngIf",r.lcZ(1,1,t.order$))},dependencies:[_.sg,_.O5,_.Ov,a.X$D],encapsulation:2,changeDetection:0}),o})(),Or=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=r.oAB({type:o}),o.\u0275inj=r.cJS({imports:[v.UX,_.ez,a.LUR,a.bhT,f.Fym,f.Fme,T.Bz,a.pEA.withConfig({cmsComponents:{OrderApprovalDetailTotalsComponent:{component:u.sQ,providers:[{provide:u.SE,useExisting:R}],guards:[a.a1M,x]},OrderApprovalDetailApprovalDetailsComponent:{component:q,providers:[{provide:u.SE,useExisting:R}],guards:[a.a1M,x]},AccountOrderDetailsApprovalDetailsComponent:{component:q},OrderApprovalDetailShippingComponent:{component:u.KV,providers:[{provide:u.SE,useExisting:R}],guards:[a.a1M,x]},OrderApprovalDetailItemsComponent:{component:u.vI,providers:[{provide:u.SE,useExisting:R}],guards:[a.a1M,x]},OrderApprovalDetailFormComponent:{component:gr,guards:[a.a1M,x]}}})]}),o})(),mr=(()=>{class o{constructor(e,t,i){this.routing=e,this.orderApprovalService=t,this.translation=i,this.PAGE_SIZE=5}ngOnInit(){this.fetchApprovalListPage({}),this.sortLabels$=(0,H.aj)([this.translation.translate("sorting.date"),this.translation.translate("sorting.orderNumber")]).pipe((0,c.U)(([e,t])=>({byDate:e,byOrderNumber:t})))}changeSortCode(e){const t={sort:e,currentPage:0};this.sortType=e,this.fetchApprovalListPage(t)}pageChange(e){this.fetchApprovalListPage({sort:this.sortType,currentPage:e})}fetchApprovalListPage(e){e.pageSize=this.PAGE_SIZE,this.orderApprovalService.loadOrderApprovals(e),this.orderApprovals$=this.orderApprovalService.getList(e)}goToApprovalDetails(e,t){"a"!==e?.target?.nodeName.toLowerCase()&&this.routing.go({cxRoute:"orderApprovalDetails",params:{approvalCode:t.code}})}}return o.\u0275fac=function(e){return new(e||o)(r.Y36(a.Znh),r.Y36(M),r.Y36(a.D7D))},o.\u0275cmp=r.Xpm({type:o,selectors:[["cx-order-approval-list"]],decls:2,vars:3,consts:[[4,"ngIf"],[4,"ngIf","ngIfElse"],["noOrder",""],[1,"cx-order-approval-sort","top","row"],[1,"cx-order-approval-form-group","form-group","col-sm-12","col-md-4","col-lg-4"],[4,"cxFeatureLevel"],[1,"cx-order-approval-pagination"],[3,"pagination","viewPageEvent"],["role","table","id","order-approval-table",1,"table","cx-order-approval-table"],["class","cx-visually-hidden",4,"cxFeatureLevel"],[1,"cx-order-approval-thead-mobile"],["scope","col"],["role","row",3,"click",4,"ngFor","ngForOf"],[1,"cx-order-approval-sort","bottom","row"],[1,"cx-visually-hidden"],["ariaControls","order-approval-table",3,"sortOptions","sortLabels","selectedOption","ariaLabel","sortListEvent"],["role","row",3,"click"],["role","cell",1,"cx-order-approval-code"],[1,"d-md-none","cx-order-approval-label"],[1,"cx-order-approval-value",3,"routerLink"],["role","cell",1,"cx-order-approval-po-code"],["role","cell",1,"cx-order-approval-placed"],["role","cell",1,"cx-order-approval-date"],["role","cell",1,"cx-order-approval-status"],["role","cell",1,"cx-order-approval-total"],[3,"sortOptions","sortLabels","selectedOption","sortListEvent"],[1,"cx-order-approval-no-order","row"],[1,"col-sm-12","col-md-6","col-lg-4"]],template:function(e,t){1&e&&(r.YNc(0,Xr,4,2,"ng-container",0),r.ALo(1,"async")),2&e&&r.Q6J("ngIf",r.lcZ(1,1,t.orderApprovals$))},dependencies:[_.sg,_.O5,T.yS,f.iNG,f.QtL,a.EJv,_.Ov,a.l2T,a.X$D,a.dgE],encapsulation:2,changeDetection:0}),o})(),fr=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=r.oAB({type:o}),o.\u0275inj=r.cJS({imports:[_.ez,a.pEA.withConfig({cmsComponents:{OrderApprovalListComponent:{component:mr,guards:[a.a1M,x]}}}),a.bhT,T.Bz,f.xuE,a.LUR,a.GSh]}),o})(),xr=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=r.oAB({type:o}),o.\u0275inj=r.cJS({imports:[T.Bz,fr,Or]}),o})();class B{}let Q=(()=>{class o{constructor(e){this.adapter=e}get(e,t){return this.adapter.load(e,t)}getList(e,t){return this.adapter.loadList(e,t)}makeDecision(e,t,i){return this.adapter.makeDecision(e,t,i)}}return o.\u0275fac=function(e){return new(e||o)(r.LFG(B))},o.\u0275prov=r.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const y=new r.OlP("OrderApprovalNormalizer"),z=new r.OlP("OrderApprovalsListNormalizer"),Y=new r.OlP("OrderApprovalDecisionNormalizer");let Lr=(()=>{class o{constructor(e,t,i){this.http=e,this.occEndpoints=t,this.converter=i}load(e,t){return this.http.get(this.getOrderApprovalEndpoint(e,t)).pipe(this.converter.pipeable(y))}loadList(e,t){return this.http.get(this.getOrderApprovalsEndpoint(e,t)).pipe(this.converter.pipeable(z))}makeDecision(e,t,i){return this.http.post(this.getOrderApprovalDecisionEndpoint(e,t),i).pipe(this.converter.pipeable(Y))}getOrderApprovalEndpoint(e,t){return this.occEndpoints.buildUrl("orderApproval",{urlParams:{userId:e,orderApprovalCode:t}})}getOrderApprovalsEndpoint(e,t){return this.occEndpoints.buildUrl("orderApprovals",{urlParams:{userId:e},queryParams:t})}getOrderApprovalDecisionEndpoint(e,t){return this.occEndpoints.buildUrl("orderApprovalDecision",{urlParams:{userId:e,orderApprovalCode:t}})}}return o.\u0275fac=function(e){return new(e||o)(r.LFG(Cr.eN),r.LFG(a.Lz0),r.LFG(a.IXI))},o.\u0275prov=r.Yz7({token:o,factory:o.\u0275fac}),o})(),Dr=(()=>{class o{constructor(){}convert(e,t){return void 0===t&&(t={...e}),t}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=r.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),hr=(()=>{class o{constructor(e){this.converter=e}convert(e,t){return void 0===t&&(t={...e}),t.values=e.orderApprovals?.map(i=>({...this.converter.convert(i,y)}))??[],t}}return o.\u0275fac=function(e){return new(e||o)(r.LFG(a.IXI))},o.\u0275prov=r.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),Er=(()=>{class o{constructor(e){this.converter=e}convert(e,t){return void 0===t&&(t={...e}),e.order&&(t.order=this.converter.convert(e.order,Mr.YA)),t}}return o.\u0275fac=function(e){return new(e||o)(r.LFG(a.IXI))},o.\u0275prov=r.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const oe={backend:{occ:{endpoints:{orderApprovals:"/users/${userId}/orderapprovals",orderApproval:"/users/${userId}/orderapprovals/${orderApprovalCode}?fields=FULL",orderApprovalDecision:"/users/${userId}/orderapprovals/${orderApprovalCode}/decision"}}}};let Rr=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=r.oAB({type:o}),o.\u0275inj=r.cJS({providers:[(0,a.i51)(oe),{provide:B,useClass:Lr},{provide:y,useExisting:Er,multi:!0},{provide:z,useExisting:hr,multi:!0},{provide:Y,useExisting:Dr,multi:!0}],imports:[_.ez]}),o})();const te=[(()=>{class o{constructor(e,t){this.actions$=e,this.orderApprovalConnector=t,this.loadOrderApproval$=(0,A.GW)(()=>this.actions$.pipe((0,A.l4)(b),(0,c.U)(i=>i.payload),(0,O.h)(i=>i.userId!==a.Fds),(0,m.w)(({userId:i,orderApprovalCode:p})=>this.orderApprovalConnector.get(i,p).pipe((0,c.U)(l=>new J([l])),(0,U.K)(l=>(0,S.of)(new nr({orderApprovalCode:p,error:(0,a.cxH)(l)}))))))),this.loadOrderApprovals$=(0,A.GW)(()=>this.actions$.pipe((0,A.l4)(N),(0,c.U)(i=>i.payload),(0,O.h)(i=>i.userId!==a.Fds),(0,m.w)(({userId:i,params:p})=>this.orderApprovalConnector.getList(i,p).pipe((0,m.w)(l=>{const{values:L,page:Ae}=a.kPG.normalizeListPage(l,"code");return[new J(L),new pr({page:Ae,params:p})]}),(0,U.K)(l=>(0,S.of)(new ir({params:p,error:(0,a.cxH)(l)}))))))),this.makeDecision$=(0,A.GW)(()=>this.actions$.pipe((0,A.l4)(V),(0,c.U)(i=>i.payload),(0,O.h)(i=>i.userId!==a.Fds),(0,m.w)(({userId:i,orderApprovalCode:p,orderApprovalDecision:l})=>this.orderApprovalConnector.makeDecision(i,p,l).pipe((0,m.w)(L=>[new cr({orderApprovalCode:p,orderApprovalDecision:L}),new K({userId:i,orderApprovalCode:p})]),(0,U.K)(L=>(0,S.of)(new lr({orderApprovalCode:p,error:(0,a.cxH)(L)})))))))}}return o.\u0275fac=function(e){return new(e||o)(r.LFG(A.eX),r.LFG(Q))},o.\u0275prov=r.Yz7({token:o,factory:o.\u0275fac}),o})()];function ie(o,n){switch(n.type){case k:return n.payload;case G:return o}return o}function pe(o,n){return n.type===w?n.payload.page:o}const Tr=new r.OlP("OrganizationReducers"),le={provide:Tr,useFactory:function se(){return{[P]:(0,d.UY)({entities:a.kPG.entityLoaderReducer(Z,ie),list:a.kPG.entityLoaderReducer(C,pe)})}}},de=[function ce(o){return function(n,e){return e.type===a.uQL.LOGOUT&&(n=void 0),o(n,e)}}];let _e=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=r.oAB({type:o}),o.\u0275inj=r.cJS({providers:[le],imports:[d.Aw.forFeature(P,Tr,{metaReducers:de}),A.sQ.forFeature(te)]}),o})(),ve=(()=>{class o{static forRoot(){return{ngModule:o,providers:[Q]}}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=r.oAB({type:o}),o.\u0275inj=r.cJS({imports:[_e]}),o})(),ue=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=r.oAB({type:o}),o.\u0275inj=r.cJS({imports:[ve.forRoot(),Rr,xr]}),o})()}}]);