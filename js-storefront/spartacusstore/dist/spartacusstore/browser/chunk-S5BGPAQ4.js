import{a as Ct,b as ta,c as mt,d as ia,e as aa,f as na,g as St,h as ra,i as gt,j as oa,k as sa,l as ca,n as z,o as H,p as da,q as la}from"./chunk-GDIVNEM4.js";import{a as Xi,b as ea}from"./chunk-UULDJAOP.js";import{c as Hi}from"./chunk-QRJGJFDR.js";import{a as Ye,b as Ce,f as Zi,i as Ji,p as ut}from"./chunk-IGMJLRUW.js";import"./chunk-TN76WW3R.js";import{C as xe,H as We,M as Yi,N as zi,P as Ki,R as pt,S as vt,T as Me,q as He,r as lt,s as Wi}from"./chunk-OB3MC34I.js";import{B as Fi,C as Ri,I as wi,J as Vi,K as $i,N as fe,Na as Ui,S as Oi,U as Mi,Ua as Qi,V as rt,Va as qi,X as ot,Y as st,Z as ct,b as yi,c as Ge,d as Ei,dc as Gi,e as Di,g as Ti,j as Oe,l as Ii,ma as dt,p as bi,ra as ki,s as Ai,ua as Bi,w as Li,wa as ji,ya as Pi,za as Ni}from"./chunk-OOBMFFZN.js";import{Ab as ae,Ac as se,Ad as pi,Bb as C,Cb as K,Ce as _e,Da as w,Db as m,De as mi,Ea as V,Ee as ve,Fe as we,G as Ht,Gc as ri,I as O,Ia as Zt,Ie as Ve,If as nt,Jd as E,Kb as Xt,Kc as oi,Lb as R,Le as A,M as ee,Me as P,Nb as ei,O as Wt,Pb as ti,Pd as Re,Q as B,Qe as Si,Ra as o,Rb as s,Re as gi,Sa as f,Sb as c,Se as hi,Tb as Le,U as Ee,Wb as ne,Wc as si,We as _i,X as Yt,Xe as fi,Yc as ci,Yd as vi,Ye as tt,Zc as j,Zf as ue,_a as De,_e as xi,_f as $e,a as G,ab as y,ae as de,b as J,bb as Te,cb as v,da as Ue,dd as ce,ea as zt,eb as Jt,ed as di,f as X,fd as Z,ga as Kt,gd as li,ha as D,ib as d,jb as p,ka as U,kb as T,l as Pe,lb as I,ma as he,mb as b,me as ui,n as Qt,ob as q,oc as ii,pa as Q,pc as re,pd as et,q as Ne,qa as M,qb as F,qc as ai,r as qt,rb as h,rc as ni,rd as Fe,s as Y,sa as _,se as Ci,ta as te,tf as it,ub as Xe,uc as oe,v as g,w as ge,we as le,x as Gt,xa as ie,xb as Ie,ya as k,yb as be,ye as pe,yf as at,zb as Ae,zd as Qe,zf as qe}from"./chunk-M6I5A6DT.js";var ze=["element"],Ra=()=>({cxRoute:"savedCarts"});function wa(a,t){if(a&1){let r=q();I(0),d(1,"div",2)(2,"a",3),s(3,"cxUrl"),d(4,"span"),C(5),s(6,"cxTranslate"),p()(),d(7,"a",4,0),s(9,"async"),F("click",function(){let i=w(r).ngIf,n=h();return V(n.saveCart(i))}),d(10,"span"),C(11),s(12,"cxTranslate"),p()()(),b()}if(a&2){let r=h();o(2),v("routerLink",c(3,5,Xt(13,Ra))),o(3),K(c(6,7,"addToSavedCart.savedCarts")),o(2),Jt("disabled",c(9,9,r.disableSaveCartForLater$)),o(4),K(c(12,11,"addToSavedCart.saveCartForLater"))}}function Va(a,t){if(a&1){let r=q();I(0),d(1,"div",2)(2,"div",3)(3,"button",4,0),F("click",function(){let i=w(r).ngIf,n=h();return V(n.openDialog(i,n.savedCartFormType.DELETE))}),C(5),s(6,"cxTranslate"),p()(),d(7,"div",3)(8,"button",5,0),F("click",function(){let i=w(r).ngIf,n=h();return V(n.openDialog(i,n.savedCartFormType.RESTORE))}),C(10),s(11,"cxTranslate"),p()()(),b()}a&2&&(o(5),m(" ",c(6,2,"savedCartDetails.deleteSavedCart")," "),o(5),m(" ",c(11,4,"savedCartList.makeCartActive")," "))}var $a=(a,t,r)=>({displayAddToCart:!0,addToCartString:a,optionalBtn:t,cartType:r}),Oa=(a,t,r,e,i)=>({cartId:a,cartIsLoading:t,items:r,promotionLocation:e,options:i});function Ma(a,t){}function ka(a,t){if(a&1&&(I(0),T(1,"div",4),s(2,"cxTranslate"),d(3,"div",5),y(4,Ma,0,0,"ng-template",6),s(5,"async"),s(6,"async"),p(),b()),a&2){let r=h().ngIf,e=h(),i=ae(5);o(),Te("aria-label",c(2,3,"common.loaded")),o(3),v("cxOutlet",e.CartOutlets.CART_ITEM_LIST)("cxOutletContext",ti(13,Oa,r.code,!c(5,5,e.cartLoaded$),r.entries,e.CartLocation.SavedCart,ei(9,$a,c(6,7,e.buyItAgainTranslation$),i,e.CartType.SELECTIVE)))}}function Ba(a,t){if(a&1&&(I(0),y(1,ka,7,19,"ng-container",3),b()),a&2){let r=t.ngIf;h();let e=ae(3);o(),v("ngIf",(r==null||r.entries==null?null:r.entries.length)>0)("ngIfElse",e)}}function ja(a,t){a&1&&(d(0,"div",7),T(1,"cx-spinner"),p())}function Pa(a,t){if(a&1&&T(0,"cx-add-to-cart",8),a&2){let r=t.$implicit;v("productCode",r.item.product==null?null:r.item.product.code)("product",r.item.product)("showQuantity",!1)("options",r.options)("pickupStore",r.item.deliveryPointOfService==null?null:r.item.deliveryPointOfService.name)}}function Na(a,t){if(a&1){let r=q();I(0),d(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),T(5,"cx-card",6),s(6,"async"),d(7,"button",7,0),s(9,"cxTranslate"),s(10,"cxTranslate"),F("click",function(){let i=w(r).ngIf,n=h();return V(n.openDialog(i))}),T(11,"cx-icon",8),p()(),d(12,"div",9),T(13,"cx-card",10),s(14,"async"),p()(),d(15,"div",4),T(16,"cx-card",6),s(17,"async"),p(),d(18,"div",4),T(19,"cx-card",6),s(20,"cxDate"),s(21,"async"),T(22,"cx-card",6),s(23,"async"),p(),d(24,"div",4),T(25,"cx-card",6),s(26,"async"),T(27,"cx-card",6),s(28,"async"),p()()(),b()}if(a&2){let r=t.ngIf,e=h();o(5),v("content",c(6,12,e.getCartName(r==null?null:r.name))),o(2),Te("aria-label",c(9,14,"savedCartDetails.editSavedCart"))("title",c(10,16,"savedCartDetails.editSavedCart")),o(4),v("type",e.iconTypes.PENCIL),o(2),v("content",c(14,18,e.getCartDescription(r==null?null:r.description)))("truncateText",!0)("charactersLimit",30),o(3),v("content",c(17,20,e.getCartId(r==null?null:r.code))),o(3),v("content",c(21,24,e.getDateSaved(c(20,22,r==null?null:r.saveTime)))),o(3),v("content",c(23,26,e.getCartItems(r==null?null:r.totalItems))),o(3),v("content",c(26,28,e.getCartQuantity(r==null?null:r.totalUnitCount))),o(2),v("content",c(28,30,e.getCartTotal(r==null||r.totalPriceWithTax==null?null:r.totalPriceWithTax.formattedValue)))}}var va=a=>({count:a}),ke=a=>({savedCartId:a}),Be=a=>({cxRoute:"savedCartsDetails",params:a});function Ua(a,t){if(a&1){let r=q();d(0,"tr",13),F("click",function(){let i=w(r).$implicit,n=h(4);return V(n.goToSavedCartDetails(i))}),d(1,"td",14)(2,"div",15),C(3),s(4,"cxTranslate"),p(),d(5,"a",16),s(6,"cxUrl"),C(7),p()(),d(8,"td",17)(9,"div",15),C(10),s(11,"cxTranslate"),p(),d(12,"a",16),s(13,"cxUrl"),C(14),p()(),d(15,"td",18)(16,"div",15),C(17),s(18,"cxTranslate"),p(),d(19,"a",16),s(20,"cxUrl"),C(21),s(22,"cxDate"),p()(),d(23,"td",19)(24,"div",15),C(25),s(26,"cxTranslate"),p(),d(27,"a",16),s(28,"cxUrl"),C(29),p()(),d(30,"td",20)(31,"div",15),C(32),s(33,"cxTranslate"),p(),d(34,"a",16),s(35,"cxUrl"),C(36),p()(),d(37,"td",21)(38,"div",15),C(39),s(40,"cxTranslate"),p(),d(41,"button",22,2),F("click",function(i){let n=w(r).$implicit,l=h(4);return V(l.openDialog(i,n))}),C(43),s(44,"cxTranslate"),p()()()}if(a&2){let r=t.$implicit;o(3),m(" ",c(4,17,"savedCartList.cartName")," "),o(2),v("routerLink",c(6,19,R(46,Be,R(44,ke,r==null?null:r.code)))),o(2),m(" ",r==null?null:r.name,""),o(3),m(" ",c(11,21,"savedCartList.cartId")," "),o(2),v("routerLink",c(13,23,R(50,Be,R(48,ke,r==null?null:r.code)))),o(2),K(r==null?null:r.code),o(3),m(" ",c(18,25,"savedCartList.dateSaved")," "),o(2),v("routerLink",c(20,27,R(54,Be,R(52,ke,r==null?null:r.code)))),o(2),K(Le(22,29,r==null?null:r.saveTime,"longDate")),o(4),m(" ",c(26,32,"savedCartList.quantity")," "),o(2),v("routerLink",c(28,34,R(58,Be,R(56,ke,r==null?null:r.code)))),o(2),m(" ",r==null?null:r.totalUnitCount,""),o(3),m(" ",c(33,36,"savedCartList.total")," "),o(2),v("routerLink",c(35,38,R(62,Be,R(60,ke,r==null?null:r.code)))),o(2),m(" ",r==null||r.totalPrice==null?null:r.totalPrice.formattedValue,""),o(3),m(" ",c(40,40,"savedCartList.actions")," "),o(4),m(" ",c(44,42,"savedCartList.makeCartActive")," ")}}function Qa(a,t){if(a&1&&(I(0),d(1,"table",7)(2,"thead",8)(3,"th",9),C(4),s(5,"cxTranslate"),p(),d(6,"th",9),C(7),s(8,"cxTranslate"),p(),d(9,"th",9),C(10),s(11,"cxTranslate"),p(),d(12,"th",10),C(13),s(14,"cxTranslate"),p(),d(15,"th",11),C(16),s(17,"cxTranslate"),p(),d(18,"th",9),C(19),s(20,"cxTranslate"),p()(),d(21,"tbody"),y(22,Ua,45,64,"tr",12),p()(),b()),a&2){let r=h(2).ngIf;o(4),m(" ",c(5,7,"savedCartList.cartName")," "),o(3),m(" ",c(8,9,"savedCartList.cartId")," "),o(3),m(" ",c(11,11,"savedCartList.dateSaved")," "),o(3),m(" ",c(14,13,"savedCartList.quantity")," "),o(3),m(" ",c(17,15,"savedCartList.total")," "),o(3),m(" ",c(20,17,"savedCartList.actions")," "),o(3),v("ngForOf",r)}}function qa(a,t){a&1&&(d(0,"div",23)(1,"div",24)(2,"div"),C(3),s(4,"cxTranslate"),p()()()),a&2&&(o(3),K(c(4,1,"savedCartList.notFound")))}function Ga(a,t){if(a&1&&(I(0),T(1,"div",5),s(2,"cxTranslate"),d(3,"div",6)(4,"h2"),C(5),s(6,"cxTranslate"),p()(),y(7,Qa,23,19,"ng-container",4)(8,qa,5,3,"ng-template",null,1,ne),b()),a&2){let r=ae(9),e=h().ngIf;o(),Te("aria-label",c(2,4,"common.loaded")),o(4),m(" ",Le(6,6,"savedCartList.savedCarts",R(9,va,e.length))," "),o(2),v("ngIf",(e==null?null:e.length)>0)("ngIfElse",r)}}function Ha(a,t){a&1&&(d(0,"div",25),T(1,"cx-spinner"),p())}function Wa(a,t){if(a&1&&(I(0),y(1,Ga,10,11,"ng-container",4),s(2,"async"),y(3,Ha,2,0,"ng-template",null,0,ne),b()),a&2){let r=ae(4),e=h();o(),v("ngIf",!c(2,2,e.isLoading$))("ngIfElse",r)}}var Ya=a=>({name:a}),ua=a=>({label:a});function za(a,t){a&1&&(I(0),C(1),s(2,"cxTranslate"),b()),a&2&&(o(),m(" ",c(2,1,"savedCartDialog.editSavedCart")," "))}function Ka(a,t){a&1&&(I(0),C(1),s(2,"cxTranslate"),b()),a&2&&(o(),m(" ",c(2,1,"savedCartDialog.deleteSavedCart")," "))}function Za(a,t){a&1&&(I(0),C(1),s(2,"cxTranslate"),b()),a&2&&(o(),m(" ",c(2,1,"savedCartDialog.saveForLater")," "))}function Ja(a,t){a&1&&(I(0),C(1),s(2,"cxTranslate"),b()),a&2&&(o(),m(" ",c(2,1,"savedCartDialog.restoreSavedCart")," "))}function Xa(a,t){if(a&1&&(d(0,"div",25)(1,"label")(2,"span",26),C(3),s(4,"cxTranslate"),p(),T(5,"input",27),s(6,"cxTranslate"),p()()),a&2){let r,e=h(4);o(3),m(" ",c(4,3,"savedCartDialog.nameOfCloneCart")," "),o(2),Xe("placeholder",Le(6,5,"savedCartDialog.defaultCloneCartName",R(8,Ya,(r=e.form.get("name"))==null?null:r.value))),v("maxLength",e.nameMaxLength)}}function en(a,t){if(a&1){let r=q();I(0),d(1,"div",21)(2,"input",22),F("change",function(){w(r);let i=h(3);return V(i.toggleIsCloneSavedCart())}),p(),d(3,"label",23),C(4),s(5,"cxTranslate"),p()(),y(6,Xa,7,10,"div",24),b()}if(a&2){let r=h(3);o(2),v("checked",r.isCloneSavedCart),o(2),K(c(5,3,"savedCartDialog.keepCopySavedCart")),o(2),v("ngIf",r.isCloneSavedCart)}}function tn(a,t){if(a&1){let r=q();d(0,"button",29),s(1,"async"),F("click",function(){w(r);let i=h(4);return V(i.deleteCart(i.cart.code))}),C(2),s(3,"cxTranslate"),p()}if(a&2){let r=h(4);v("disabled",c(1,2,r.isDisableDeleteButton$)),o(2),m(" ",c(3,4,"savedCartDialog.delete")," ")}}function an(a,t){if(a&1&&(I(0),y(1,tn,4,6,"button",28),b()),a&2){let r=h(3);o(),v("ngIf",r.cart.code)}}function nn(a,t){if(a&1){let r=q();d(0,"button",29),s(1,"async"),F("click",function(){w(r);let i=h(4);return V(i.restoreSavedCart(i.cart.code))}),C(2),s(3,"cxTranslate"),p()}if(a&2){let r=h(4);v("disabled",c(1,2,r.isDisableRestoreButton$)),o(2),m(" ",c(3,4,"savedCartDialog.restore")," ")}}function rn(a,t){if(a&1&&y(0,nn,4,6,"button",28),a&2){let r=h(3);v("ngIf",r.cart.code)}}function on(a,t){if(a&1){let r=q();I(0),d(1,"p",14),C(2),s(3,"cxTranslate"),p(),d(4,"div",15)(5,"div",16)(6,"div",17),C(7),s(8,"cxTranslate"),p(),d(9,"div",18),C(10),p()(),d(11,"div",16)(12,"div",17),C(13),s(14,"cxTranslate"),p(),d(15,"div",18),C(16),p()(),d(17,"div",16)(18,"div",17),C(19),s(20,"cxTranslate"),p(),d(21,"div",18),C(22),p()(),d(23,"div",16)(24,"div",17),C(25),s(26,"cxTranslate"),p(),d(27,"div",18),C(28),p()(),d(29,"div",16)(30,"div",17),C(31),s(32,"cxTranslate"),p(),d(33,"div",18),C(34),p()()(),y(35,en,7,5,"ng-container",2),d(36,"div",19)(37,"button",20),F("click",function(){w(r);let i=h(2);return V(i.close("Close Save Cart Dialog"))}),C(38),s(39,"cxTranslate"),p(),y(40,an,2,1,"ng-container",13)(41,rn,1,1,"ng-template",null,1,ne),p(),b()}if(a&2){let r=ae(42),e=h(2);o(2),m(" ",c(3,15,e.layoutOption===e.savedCartFormType.DELETE?"savedCartDialog.followingCartDelete":"savedCartDialog.followingCartRestore")," "),o(5),m(" ",c(8,17,"savedCartDialog.name")," "),o(3),m(" ",e.cart==null?null:e.cart.name," "),o(3),m(" ",c(14,19,"savedCartDialog.id")," "),o(3),m(" ",e.cart==null?null:e.cart.code," "),o(3),m(" ",c(20,21,"savedCartDialog.description")," "),o(3),m(" ",e.cart==null?null:e.cart.description," "),o(3),m(" ",c(26,23,"savedCartDialog.quantity")," "),o(3),m(" ",e.cart==null?null:e.cart.totalUnitCount," "),o(3),m(" ",c(32,25,"savedCartDialog.total")," "),o(3),m(" ",e.cart==null||e.cart.totalPriceWithTax==null?null:e.cart.totalPriceWithTax.formattedValue," "),o(),v("ngIf",e.layoutOption===e.savedCartFormType.RESTORE),o(3),m(" ",c(39,27,"savedCartDialog.cancel")," "),o(2),v("ngIf",e.layoutOption===e.savedCartFormType.DELETE)("ngIfElse",r)}}function sn(a,t){a&1&&(I(0),d(1,"p",14),C(2),s(3,"cxTranslate"),p(),b()),a&2&&(o(2),m(" ",c(3,1,"savedCartDialog.itemsSavedForLater")," "))}function cn(a,t){if(a&1&&(T(0,"cx-form-errors",39),s(1,"cxTranslate")),a&2){let r=h(3);v("translationParams",R(4,ua,c(1,2,"savedCartDialog.savedCartName")))("control",r.form.get("name"))}}function dn(a,t){if(a&1&&T(0,"cx-form-errors",40),a&2){let r=h(3);v("control",r.form.get("name"))}}function ln(a,t){if(a&1&&(T(0,"cx-form-errors",39),s(1,"cxTranslate")),a&2){let r=h(3);v("translationParams",R(4,ua,c(1,2,"savedCartDialog.savedCartDescription")))("control",r.form.get("description"))}}function pn(a,t){if(a&1&&T(0,"cx-form-errors",40),a&2){let r=h(3);v("control",r.form.get("description"))}}function vn(a,t){if(a&1){let r=q();y(0,sn,4,3,"ng-container",2),d(1,"div",15),I(2),d(3,"label")(4,"span",30),C(5),s(6,"cxTranslate"),p(),T(7,"input",31),y(8,cn,2,6,"cx-form-errors",32)(9,dn,1,1,"cx-form-errors",33),p(),b(),p(),d(10,"div",15)(11,"label")(12,"span",30),C(13),s(14,"cxTranslate"),d(15,"span",34),C(16),s(17,"cxTranslate"),p()(),T(18,"textarea",35),y(19,ln,2,6,"cx-form-errors",32)(20,pn,1,1,"cx-form-errors",33),d(21,"p",36),C(22),s(23,"cxTranslate"),p()()(),d(24,"div",19)(25,"button",37),s(26,"async"),F("click",function(){w(r);let i=h(2);return V(i.close("Close Save Cart Dialog"))}),C(27),s(28,"cxTranslate"),p(),d(29,"button",38),s(30,"async"),F("click",function(){w(r);let i=h(2);return V(i.saveOrEditCart(i.cart==null?null:i.cart.code))}),C(31),s(32,"cxTranslate"),p()()}if(a&2){let r=h(2);v("ngIf",r.layoutOption===r.savedCartFormType.SAVE),o(5),K(c(6,15,"savedCartDialog.savedCartName")),o(2),v("maxLength",r.nameMaxLength),o(),v("cxFeature","formErrorsDescriptiveMessages"),o(),v("cxFeature","!formErrorsDescriptiveMessages"),o(4),m("",c(14,17,"savedCartDialog.savedCartDescription")," "),o(3),m(" (",c(17,19,"savedCartDialog.optional"),") "),o(2),v("maxLength",r.descriptionMaxLength),o(),v("cxFeature","formErrorsDescriptiveMessages"),o(),v("cxFeature","!formErrorsDescriptiveMessages"),o(2),m(" ",Le(23,21,"savedCartDialog.charactersLeft",R(32,va,r.descriptionsCharacterLeft))," "),o(3),v("disabled",c(26,24,r.isLoading$)),o(2),m(" ",c(28,26,"savedCartDialog.cancel")," "),o(2),v("disabled",c(30,28,r.isLoading$)),o(2),m(" ",c(32,30,"savedCartDialog.save")," ")}}function un(a,t){if(a&1){let r=q();I(0),d(1,"div",3),F("esc",function(){w(r);let i=h();return V(i.close("Escape clicked"))}),d(2,"form",4)(3,"div",5),I(4,6),d(5,"div",7),y(6,za,3,3,"ng-container",8)(7,Ka,3,3,"ng-container",8)(8,Za,3,3,"ng-container",8)(9,Ja,3,3,"ng-container",8),p(),b(),d(10,"button",9),s(11,"cxTranslate"),s(12,"async"),s(13,"cxTranslate"),F("click",function(){w(r);let i=h();return V(i.close("Close Save Cart Dialog"))}),d(14,"span",10),T(15,"cx-icon",11),p()()(),d(16,"div",12),y(17,on,43,29,"ng-container",13)(18,vn,33,34,"ng-template",null,0,ne),p()()(),b()}if(a&2){let r=ae(19),e=h();o(),v("cxFocus",e.focusConfig),o(),v("formGroup",e.form),o(2),v("ngSwitch",e.layoutOption),o(2),v("ngSwitchCase",e.savedCartFormType.EDIT),o(),v("ngSwitchCase",e.savedCartFormType.DELETE),o(),v("ngSwitchCase",e.savedCartFormType.SAVE),o(),v("ngSwitchCase",e.savedCartFormType.RESTORE),o(),Xe("title",c(11,13,"common.close")),v("disabled",c(12,15,e.isLoading$)),Te("aria-label",c(13,17,"common.close")),o(5),v("type",e.iconTypes.CLOSE),o(2),v("ngIf",e.layoutOption===e.savedCartFormType.DELETE||e.layoutOption===e.savedCartFormType.RESTORE)("ngIfElse",r)}}var Cn=(()=>{let t=class t{constructor(e,i,n,l,L){this.activeCartFacade=e,this.authService=i,this.routingService=n,this.vcr=l,this.launchDialogService=L,this.subscription=new X,this.loggedIn=!1,tt("a11yExpandedFocusIndicator")}ngOnInit(){this.cart$=ge([this.activeCartFacade.getActive(),this.authService.isUserLoggedIn()]).pipe(U(([e,i])=>this.loggedIn=i),g(([e])=>e)),this.disableSaveCartForLater$=this.cart$.pipe(g(e=>!e.entries?.length))}saveCart(e){this.subscription.add(this.disableSaveCartForLater$.subscribe(i=>{i||(this.loggedIn?this.openDialog(e):this.routingService.go({cxRoute:"login"}))}))}openDialog(e){let i=this.launchDialogService.openDialog("SAVED_CART",this.element,this.vcr,{cart:e,layoutOption:"save"});i&&this.subscription.add(i.pipe(B(1)).subscribe())}ngOnDestroy(){this.subscription?.unsubscribe()}};t.\u0275fac=function(i){return new(i||t)(f(We),f(ui),f(de),f(De),f(fe))},t.\u0275cmp=ie({type:t,selectors:[["cx-add-to-saved-cart"]],viewQuery:function(i,n){if(i&1&&Ie(ze,5),i&2){let l;be(l=Ae())&&(n.element=l.first)}},decls:2,vars:3,consts:[["element",""],[4,"ngIf"],[1,"cx-add-to-saved-cart-container"],["cxAutoFocus","",1,"link","cx-action-link",3,"routerLink"],["tabindex","0","cxAutoFocus","",1,"link","cx-action-link",3,"click"]],template:function(i,n){i&1&&(y(0,wa,13,14,"ng-container",1),s(1,"async")),i&2&&v("ngIf",c(1,1,n.cart$))},dependencies:[re,et,oe,ue,at],encapsulation:2,changeDetection:0});let a=t;return a})(),mn=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=k({type:t}),t.\u0275inj=M({providers:[Qe({cmsComponents:{AddToSavedCartsComponent:{component:Cn}}})],imports:[se,Fe,$e,qe]});let a=t;return a})(),_t=(()=>{let t=class t{constructor(e,i){this.routingService=e,this.savedCartService=i,this.savedCartId$=this.routingService.getRouterState().pipe(g(n=>n.state.params.savedCartId),Ee()),this.savedCart$=this.savedCartId$.pipe(O(n=>!!n),U(n=>this.savedCartService.loadSavedCart(n)),D(n=>this.savedCartService.get(n)),Ue({bufferSize:1,refCount:!0}))}getSavedCartId(){return this.savedCartId$}getCartDetails(){return this.savedCart$}};t.\u0275fac=function(i){return new(i||t)(_(de),_(z))},t.\u0275prov=Q({token:t,factory:t.\u0275fac,providedIn:"root"});let a=t;return a})(),Sn=(()=>{let t=class t{constructor(e,i,n){this.savedCartDetailsService=e,this.vcr=i,this.launchDialogService=n,this.subscription=new X,this.savedCartFormType=H,this.savedCart$=this.savedCartDetailsService.getCartDetails()}openDialog(e,i){let n=this.launchDialogService.openDialog("SAVED_CART",this.element,this.vcr,{cart:e,layoutOption:i});n&&this.subscription.add(n.pipe(B(1)).subscribe())}ngOnDestroy(){this.subscription?.unsubscribe()}};t.\u0275fac=function(i){return new(i||t)(f(_t),f(De),f(fe))},t.\u0275cmp=ie({type:t,selectors:[["cx-saved-cart-details-action"]],viewQuery:function(i,n){if(i&1&&Ie(ze,5),i&2){let l;be(l=Ae())&&(n.element=l.first)}},decls:2,vars:3,consts:[["element",""],[4,"ngIf"],[1,"cx-saved-cart-restore-btns","row"],[1,"col-xs-12","col-md-5","col-lg-4"],[1,"btn","btn-block","btn-secondary",3,"click"],[1,"btn","btn-block","btn-primary",3,"click"]],template:function(i,n){i&1&&(y(0,Va,12,6,"ng-container",1),s(1,"async")),i&2&&v("ngIf",c(1,1,n.savedCart$))},dependencies:[re,oe,ue],encapsulation:2});let a=t;return a})(),gn=(()=>{let t=class t{constructor(e,i,n,l,L,u){this.savedCartDetailsService=e,this.savedCartService=i,this.eventSercvice=n,this.globalMessageService=l,this.routingService=L,this.translation=u,this.subscription=new X,this.CartOutlets=Yi,this.CartType=Ki,this.CartLocation=zi,this.cartLoaded$=this.savedCartDetailsService.getSavedCartId().pipe(D(S=>this.savedCartService.isStable(S))),this.savedCart$=this.savedCartDetailsService.getCartDetails().pipe(U(S=>{(S?.entries??[]).length<=0&&S?.code&&this.savedCartService.deleteSavedCart(S.code)}))}ngOnInit(){this.subscription.add(this.eventSercvice.get(lt).pipe(B(1),g(()=>!0)).subscribe(e=>this.onDeleteComplete(e))),this.buyItAgainTranslation$=this.translation.translate("addToCart.addToActiveCart")}onDeleteComplete(e){e&&(this.routingService.go({cxRoute:"savedCarts"}),this.globalMessageService.add({key:"savedCartDialog.deleteCartSuccess"},ve.MSG_TYPE_CONFIRMATION))}ngOnDestroy(){this.subscription?.unsubscribe()}};t.\u0275fac=function(i){return new(i||t)(f(_t),f(z),f(_e),f(we),f(de),f(it))},t.\u0275cmp=ie({type:t,selectors:[["cx-saved-cart-details-items"]],decls:6,vars:3,consts:[["emptyCartItems",""],["addToCartBtn",""],[4,"ngIf"],[4,"ngIf","ngIfElse"],["role","status"],[1,"cart-details-wrapper"],[3,"cxOutlet","cxOutletContext"],[1,"cx-spinner"],[3,"productCode","product","showQuantity","options","pickupStore"]],template:function(i,n){i&1&&(y(0,Ba,2,2,"ng-container",2),s(1,"async"),y(2,ja,2,0,"ng-template",null,0,ne)(4,Pa,1,5,"ng-template",null,1,ne)),i&2&&v("ngIf",c(1,1,n.savedCart$))},dependencies:[re,ct,Oi,Xi,oe,ue],encapsulation:2,changeDetection:0});let a=t;return a})(),hn=(()=>{let t=class t{constructor(e,i,n,l){this.savedCartDetailsService=e,this.translation=i,this.vcr=n,this.launchDialogService=l,this.subscription=new X,this.iconTypes=rt,this.savedCart$=this.savedCartDetailsService.getCartDetails()}getCartName(e){return this.translation.translate("savedCartDetails.cartName").pipe(O(()=>!!e),g(i=>({title:i,text:[e]})))}getCartDescription(e){return this.translation.translate("savedCartDetails.cartDescription").pipe(O(()=>!!e),g(i=>({title:i,text:[e]})))}getCartId(e){return this.translation.translate("savedCartDetails.cartId").pipe(O(()=>!!e),g(i=>({title:i,text:[e]})))}getDateSaved(e){return this.translation.translate("savedCartDetails.dateSaved").pipe(O(()=>!!e),g(i=>({title:i,text:[e??""]})))}getCartItems(e){return this.translation.translate("savedCartDetails.items").pipe(O(()=>!!e),g(i=>({title:i,text:[e.toString()]})))}getCartQuantity(e){return this.translation.translate("savedCartDetails.quantity").pipe(O(()=>!!e),g(i=>({title:i,text:[e.toString()]})))}getCartTotal(e){return this.translation.translate("savedCartDetails.total").pipe(O(()=>!!e),g(i=>({title:i,text:[e]})))}openDialog(e){let i=this.launchDialogService.openDialog("SAVED_CART",this.element,this.vcr,{cart:e,layoutOption:"edit"});i&&this.subscription.add(i.pipe(B(1)).subscribe())}ngOnDestroy(){this.subscription?.unsubscribe()}};t.\u0275fac=function(i){return new(i||t)(f(_t),f(it),f(De),f(fe))},t.\u0275cmp=ie({type:t,selectors:[["cx-saved-cart-details-overview"]],viewQuery:function(i,n){if(i&1&&Ie(ze,5),i&2){let l;be(l=Ae())&&(n.element=l.first)}},decls:2,vars:3,consts:[["element",""],[4,"ngIf"],[1,"cx-cart-summary"],[1,"container"],[1,"cx-summary-card"],[1,"cx-edit-container"],[3,"content"],[1,"cx-edit-cart",3,"click"],[3,"type"],[1,"cx-card-description"],[3,"content","truncateText","charactersLimit"]],template:function(i,n){i&1&&(y(0,Na,29,32,"ng-container",1),s(1,"async")),i&2&&v("ngIf",c(1,1,n.savedCart$))},dependencies:[re,ki,ot,oe,ue,nt],encapsulation:2});let a=t;return a})(),_n=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=k({type:t}),t.\u0275inj=M({imports:[se,$e,qe,Fe,Bi,ji,st,dt,Mi,ea,_i.withConfig({cmsComponents:{SavedCartDetailsOverviewComponent:{component:hn,guards:[Ve]},SavedCartDetailsItemsComponent:{component:gn,guards:[Ve]},SavedCartDetailsActionComponent:{component:Sn,guards:[Ve]}}})]});let a=t;return a})(),fn=(()=>{let t=class t{constructor(e,i,n,l){this.routing=e,this.savedCartService=i,this.vcr=n,this.launchDialogService=l,this.subscription=new X,this.siteContextService=te(qi,{optional:!0}),this.savedCarts$=this.savedCartService.getList().pipe(g(L=>L.sort((u,S)=>{let x=u.saveTime?new Date(u.saveTime).getTime():new Date().getTime();return(S.saveTime?new Date(S.saveTime).getTime():new Date().getTime())-x}))),tt("a11ySavedCartsZoom")}ngOnInit(){this.isLoading$=this.savedCartService.getSavedCartListProcessLoading(),this.savedCartService.loadSavedCarts(),this.observeAndReloadSavedCartOnContextChange()}goToSavedCartDetails(e){this.routing.go({cxRoute:"savedCartsDetails",params:{savedCartId:e?.code}})}openDialog(e,i){let n=this.launchDialogService.openDialog("SAVED_CART",this.restoreButton,this.vcr,{cart:i,layoutOption:H.RESTORE});n&&this.subscription.add(n.pipe(B(1)).subscribe()),e.stopPropagation()}observeAndReloadSavedCartOnContextChange(){if(this.siteContextService){let e=Object.values(Qi),i=this.siteContextService;if(!e.length)return;this.subscription.add(qt(e).pipe(Gt(n=>i.getActiveItem(n).pipe(zt(1)))).subscribe(()=>{this.savedCartService.loadSavedCarts()}))}}ngOnDestroy(){this.savedCartService.clearSavedCarts(),this.savedCartService.clearSaveCart(),this.savedCartService.clearRestoreSavedCart(),this.subscription?.unsubscribe()}};t.\u0275fac=function(i){return new(i||t)(f(de),f(z),f(De),f(fe))},t.\u0275cmp=ie({type:t,selectors:[["cx-saved-cart-list"]],viewQuery:function(i,n){if(i&1&&Ie(ze,5),i&2){let l;be(l=Ae())&&(n.restoreButton=l.first)}},decls:2,vars:3,consts:[["loading",""],["noSavedCarts",""],["element",""],[4,"ngIf"],[4,"ngIf","ngIfElse"],["role","status"],[1,"cx-saved-cart-list-header"],["role","table",1,"table","cx-saved-cart-list-table"],["role","row",1,"cx-saved-cart-list-thead-mobile"],["role","columnheader","scope","col"],["role","columnheader","scope","col",1,"cx-saved-cart-list-th-qty"],["role","columnheader","scope","col",1,"cx-saved-cart-list-th-total"],["role","row",3,"click",4,"ngFor","ngForOf"],["role","row",3,"click"],[1,"cx-saved-cart-list-cart-name"],[1,"cx-table-label-mobile","cx-saved-cart-list-label"],[1,"cx-saved-cart-list-value",3,"routerLink"],[1,"cx-saved-cart-list-cart-id"],[1,"cx-saved-cart-list-date-saved"],[1,"cx-saved-cart-list-quantity"],[1,"cx-saved-cart-list-total"],[1,"cx-saved-cart-list-make-cart-active"],[1,"btn","btn-tertiary","cx-saved-cart-make-active",3,"click"],[1,"cx-saved-cart-list-no-saved-carts","row"],[1,"col-sm-12","col-md-6","col-lg-4"],[1,"cx-spinner"]],template:function(i,n){i&1&&(y(0,Wa,5,4,"ng-container",3),s(1,"async")),i&2&&v("ngIf",c(1,1,n.savedCarts$))},dependencies:[ii,re,et,ct,oe,at,ue,nt],encapsulation:2,changeDetection:0});let a=t;return a})(),xn=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=k({type:t}),t.\u0275inj=M({providers:[Qe({cmsComponents:{AccountSavedCartHistoryComponent:{component:fn,guards:[Ve]}}})],imports:[se,qe,Fe,Ui,$e,dt]});let a=t;return a})(),yn=(()=>{let t=class t{constructor(e,i,n,l,L){this.importInfoService=e,this.userIdService=i,this.multiCartService=n,this.savedCartService=l,this.routingService=L,this.type=pt.SAVED_CART,this.savedCartId$=this.routingService.getRouterState().pipe(g(u=>u.state.params.savedCartId),Ee())}addEntries(e){return this.add(e).pipe(D(i=>this.importInfoService.getResults(i)),B(e.length))}getEntries(){return this.savedCartId$.pipe(D(e=>this.savedCartService.get(e)),g(e=>e?.entries??[]))}add(e){return ge([this.userIdService.takeUserId(),this.savedCartId$]).pipe(U(([i,n])=>this.multiCartService.addEntries(i,n,e)),g(([i,n])=>n))}};t.\u0275fac=function(i){return new(i||t)(_(ut),_(Re),_(xe),_(z),_(de))},t.\u0275prov=Q({token:t,factory:t.\u0275fac,providedIn:"root"});let a=t;return a})(),En=(()=>{let t=class t{constructor(e,i,n,l){this.importInfoService=e,this.userIdService=i,this.multiCartService=n,this.savedCartService=l,this.type=pt.NEW_SAVED_CART}addEntries(e,i){return this.add(e,i).pipe(U(n=>{this.importInfoService.getResults(n).pipe(B(e.length),Yt(l=>l.statusCode===vt.UNKNOWN_IDENTIFIER||l.statusCode===vt.UNKNOWN_ERROR)).subscribe(l=>{l&&this.savedCartService.deleteSavedCart(n)})}),D(n=>this.importInfoService.getResults(n)),B(e.length))}add(e,i){return this.userIdService.takeUserId().pipe(D(n=>this.multiCartService.createCart({userId:n,extraData:{active:!1}}).pipe(g(l=>l.code),U(l=>{this.savedCartService.saveCart({cartId:l,saveCartName:i?.name,saveCartDescription:i?.description}),this.savedCartService.loadSavedCarts()}),Ne(Pe),Wt(()=>this.savedCartService.getSaveCartProcessLoading().pipe(O(l=>!l))),U(l=>this.multiCartService.addEntries(n,l,e)))))}};t.\u0275fac=function(i){return new(i||t)(_(ut),_(Re),_(xe),_(z))},t.\u0275prov=Q({token:t,factory:t.\u0275fac,providedIn:"root"});let a=t;return a})(),Dn=(()=>{let t=class t{get descriptionsCharacterLeft(){return this.descriptionMaxLength-(this.form.get("description")?.value?.length||0)}handleClick(e){e.target.tagName===this.el.nativeElement.tagName&&this.close("Cross click")}constructor(e,i,n,l,L,u){this.launchDialogService=e,this.el=i,this.savedCartService=n,this.eventService=l,this.routingService=L,this.globalMessageService=u,this.subscription=new X,this.savedCartFormType=H,this.iconTypes=rt,this.descriptionMaxLength=250,this.nameMaxLength=50,this.isCloneSavedCart=!1,this.focusConfig={trap:!0,block:!0,autofocus:"button",focusOnEscape:!0}}ngOnInit(){this.resetSavedCartStates(),this.isLoading$=this.savedCartService.getSaveCartProcessLoading(),this.isDisableDeleteButton$=Ht(this.eventService.get(He).pipe(B(1),g(()=>!0)),this.eventService.get(Wi).pipe(B(1),g(()=>!1))),this.isDisableRestoreButton$=ge([this.savedCartService.getCloneSavedCartProcessLoading(),this.savedCartService.getRestoreSavedCartProcessLoading()]).pipe(g(([e,i])=>e||i)),this.subscription.add(this.launchDialogService.data$.subscribe(e=>{this.cart=e.cart,this.layoutOption=e.layoutOption,this.build(this.cart)})),this.subscription.add(this.savedCartService.getSaveCartProcessSuccess().subscribe(e=>this.onComplete(e))),this.subscription.add(this.eventService.get(lt).pipe(B(1),g(()=>!0)).subscribe(e=>this.onComplete(e))),this.subscription.add(this.savedCartService.getRestoreSavedCartProcessSuccess().subscribe(e=>this.onComplete(e)))}saveOrEditCart(e){if(this.form.invalid)this.form.markAllAsTouched(),Gi.deepUpdateValueAndValidity(this.form);else{let i=this.form.get("name")?.value,n=this.form.get("description")?.value||"-";switch(this.layoutOption){case H.SAVE:{this.savedCartService.saveCart({cartId:e,saveCartName:i,saveCartDescription:n});break}case H.EDIT:{this.savedCartService.editSavedCart({cartId:e,saveCartName:i,saveCartDescription:n});break}}}}deleteCart(e){this.savedCartService.deleteSavedCart(e)}restoreSavedCart(e){this.isCloneSavedCart?this.savedCartService.cloneSavedCart(e,this.form.get("cloneName")?.value):this.savedCartService.restoreSavedCart(e)}close(e){this.launchDialogService.closeDialog(e)}onComplete(e){if(e)switch(this.layoutOption){case H.DELETE:{this.routingService.go({cxRoute:"savedCarts"}),this.globalMessageService.add({key:"savedCartDialog.deleteCartSuccess"},ve.MSG_TYPE_CONFIRMATION),this.close("Successfully deleted a saved cart");break}case H.SAVE:{this.close("Successfully saved cart"),this.savedCartService.clearSaveCart(),this.globalMessageService.add({key:"savedCartCartPage.messages.cartSaved",params:{cartName:this.form.get("name")?.value||this.cart?.code}},ve.MSG_TYPE_CONFIRMATION);break}case H.EDIT:{this.close("Successfully edited saved cart"),this.savedCartService.clearSaveCart(),this.globalMessageService.add({key:"savedCartDialog.editCartSuccess",params:{cartName:this.form.get("name")?.value||this.cart?.code}},ve.MSG_TYPE_CONFIRMATION);break}case H.RESTORE:{this.close("Successfully restored saved cart"),this.routingService.go({cxRoute:"savedCarts"}),this.resetSavedCartStates();break}}}toggleIsCloneSavedCart(){return this.isCloneSavedCart=!this.isCloneSavedCart}build(e){let i=new Ti({});i.setControl("name",new Oe("",[Ge.required,Ge.maxLength(this.nameMaxLength)])),i.setControl("description",new Oe("",[Ge.maxLength(this.descriptionMaxLength)])),i.setControl("isCloneSavedCart",new Oe("")),i.setControl("cloneName",new Oe("")),this.form=i,this.patchData(e)}patchData(e){this.form.patchValue(G({},e))}resetSavedCartStates(){this.savedCartService.clearCloneSavedCart(),this.savedCartService.clearSaveCart(),this.savedCartService.clearRestoreSavedCart()}ngOnDestroy(){this.subscription?.unsubscribe(),this.close("close dialog")}};t.\u0275fac=function(i){return new(i||t)(f(fe),f(Zt),f(z),f(_e),f(de),f(we))},t.\u0275cmp=ie({type:t,selectors:[["cx-saved-cart-form-dialog"]],hostBindings:function(i,n){i&1&&F("click",function(L){return n.handleClick(L)})},decls:1,vars:1,consts:[["saveAndEditCart",""],["isRestoreSavedCart",""],[4,"ngIf"],["role","dialog",1,"cx-saved-cart-form-dialog",3,"esc","cxFocus"],[1,"cx-saved-cart-form-container",3,"formGroup"],[1,"modal-header","cx-saved-cart-form-header"],[3,"ngSwitch"],[1,"cx-saved-cart-form-title","modal-title"],[4,"ngSwitchCase"],["type","button",1,"cx-saved-cart-form-close","close",3,"click","disabled","title"],["aria-hidden","true"],[3,"type"],[1,"cx-saved-cart-form-body"],[4,"ngIf","ngIfElse"],[1,"cx-saved-cart-form-subtitle"],[1,"cx-saved-cart-form-row"],[1,"cx-saved-cart-values-container"],[1,"cx-saved-cart-label"],[1,"cx-saved-cart-value"],[1,"cx-saved-cart-form-footer"],["type","button",1,"mr-2","btn","btn-secondary",3,"click"],[1,"cx-copy-saved-cart-row","form-check"],["id","cx-copy-saved-cart","type","checkbox",1,"cx-copy-saved-cart-input",3,"change","checked"],["for","cx-copy-saved-cart",1,"cx-copy-saved-cart-label"],["class","cx-copy-saved-cart-row",4,"ngIf"],[1,"cx-copy-saved-cart-row"],[1,"label-content"],["formControlName","cloneName","type","text",1,"form-control",3,"maxLength","placeholder"],["class","ml-2 btn btn-primary","type","button",3,"disabled","click",4,"ngIf"],["type","button",1,"ml-2","btn","btn-primary",3,"click","disabled"],[1,"cx-saved-carts-label","label-content"],["required","true","formControlName","name","required","","type","text",1,"form-control",3,"maxLength"],[3,"translationParams","control",4,"cxFeature"],[3,"control",4,"cxFeature"],[1,"cx-saved-carts-label-optional"],["formControlName","description","rows","5",1,"form-control",3,"maxLength"],[1,"cx-saved-carts-input-hint"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[3,"translationParams","control"],[3,"control"]],template:function(i,n){i&1&&y(0,un,20,19,"ng-container",2),i&2&&v("ngIf",n.cart)},dependencies:[re,ai,ni,Ii,yi,Ei,Di,Li,bi,Ai,Pi,ot,wi,gi,oe,ue],encapsulation:2,changeDetection:0});let a=t;return a})(),Tn={launch:{SAVED_CART:{inline:!0,component:Dn,dialogType:$i.DIALOG}}},In=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=k({type:t}),t.\u0275inj=M({imports:[se,Fi,Ri,Ni,$e,st,Vi,fi]});let a=t;return a})(),Ca=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=k({type:t}),t.\u0275inj=M({providers:[{provide:da,useExisting:yn},{provide:la,useExisting:En},Qe(Tn)],imports:[Fe,mn,In,xn,_n]});let a=t;return a})();var je=class{},Sa=(()=>{let t=class t{constructor(e){this.adapter=e}get(e,i){return this.adapter.load(e,i)}getList(e){return this.adapter.loadList(e)}restoreSavedCart(e,i){return this.adapter.restoreSavedCart(e,i)}cloneSavedCart(e,i,n){return this.adapter.cloneSavedCart(e,i,n)}};t.\u0275fac=function(i){return new(i||t)(_(je))},t.\u0275prov=Q({token:t,factory:t.\u0275fac});let a=t;return a})(),ye="saved-cart-list",me="saved-cart-restore-cart",W="saved-cart-save-cart",Se="saved-cart-clone-cart",ga="[Saved Cart] Load Saved Cart",bn="[Saved Cart] Load Saved Cart Success",An="[Saved Cart] Load Saved Cart Fail",ha="[Saved Cart] Load Saved Carts",Ln="[Saved Cart] Load Saved Carts Success",Fn="[Saved Cart] Load Saved Carts Fail",Rn="[Saved Cart] Clear Saved Carts",jt="[Saved Cart] Restore Saved Cart",_a="[Saved Cart] Restore Saved Cart Success",fa="[Saved Cart] Restore Saved Cart Fail",wn="[Saved Cart] Clear Restore Saved Cart",Pt="[Saved Cart] Save Cart",xa="[Saved Cart] Save Cart Success",ya="[Saved Cart] Save Cart Fail",Vn="[Saved Cart] Clear Save Cart",Nt="[Saved Cart] Edit Saved Cart",Ea="[Saved Cart] Edit Saved Cart Success",Da="[Saved Cart] Edit Saved Cart Fail",Ut="[Saved Cart] Clone Saved Cart",Ta="[Saved Cart] Clone Saved Cart Success",Ia="[Saved Cart] Clone Saved Cart Fail",$n="[Saved Cart] Clear Clone Saved Cart",ft=class extends E.EntityLoadAction{constructor(t){super(Ye,t.cartId),this.payload=t,this.type=ga}},xt=class extends E.EntitySuccessAction{constructor(t){super(Ye,t.cartId),this.payload=t,this.type=bn}},yt=class extends E.EntityFailAction{constructor(t){super(Ye,t.cartId,t?.error),this.payload=t,this.type=An}},Ke=class extends E.EntityLoadAction{constructor(t){super(A,ye),this.payload=t,this.type=ha}},Et=class extends E.EntitySuccessAction{constructor(t){super(A,ye),this.payload=t,this.type=Ln}},Dt=class extends E.EntityFailAction{constructor(t){super(A,ye,t.error),this.payload=t,this.type=Fn}},Tt=class extends E.EntityLoaderResetAction{constructor(){super(A,ye),this.type=Rn}},Ze=class extends E.EntityLoadAction{constructor(t){super(A,me),this.payload=t,this.type=jt}},It=class extends E.EntitySuccessAction{constructor(t){super(A,me),this.payload=t,this.type=_a}},bt=class extends E.EntityFailAction{constructor(t){super(A,me,t.error),this.payload=t,this.type=fa}},At=class extends E.EntityLoaderResetAction{constructor(){super(A,me),this.type=wn}},Lt=class extends E.EntityLoadAction{constructor(t){super(A,W),this.payload=t,this.type=Pt}},Ft=class extends E.EntitySuccessAction{constructor(t){super(A,W),this.payload=t,this.type=xa}},Rt=class extends E.EntityFailAction{constructor(t){super(A,W,t.error),this.payload=t,this.type=ya}},wt=class extends E.EntityLoaderResetAction{constructor(){super(A,W),this.type=Vn}},Je=class extends E.EntityLoadAction{constructor(t){super(A,W),this.payload=t,this.type=Nt}},Vt=class extends E.EntitySuccessAction{constructor(t){super(A,W),this.payload=t,this.type=Ea}},$t=class extends E.EntityFailAction{constructor(t){super(A,W,t.error),this.payload=t,this.type=Da}},Ot=class extends E.EntityLoadAction{constructor(t){super(A,Se),this.payload=t,this.type=Ut}},Mt=class extends E.EntitySuccessAction{constructor(t){super(A,Se),this.payload=t,this.type=Ta}},kt=class extends E.EntityFailAction{constructor(t){super(A,Se,t.error),this.payload=t,this.type=Ia}},Bt=class extends E.EntityLoaderResetAction{constructor(){super(A,Se),this.type=$n}};var On=(()=>{let t=class t{constructor(e,i,n,l){this.actionsSubject=e,this.eventService=i,this.stateEventService=n,this.multiCartService=l,this.register()}register(){this.registerRestoreSavedCartEvents(),this.registerSaveCartEvents(),this.registerEditSavedCartEvents(),this.registerCloneSavedCartEvents()}registerRestoreSavedCartEvents(){this.buildRestoreSavedCartEvents({action:jt,event:ia}),this.buildRestoreSavedCartEvents({action:_a,event:aa}),this.buildRestoreSavedCartEvents({action:fa,event:na})}registerSaveCartEvents(){this.buildSaveCartSuccessEvent({action:xa,event:ta}),this.stateEventService.register({action:ya,event:mt,factory:e=>pe(mt,J(G({},e.payload),{cartCode:e.payload.cartId}))}),this.stateEventService.register({action:Pt,event:Ct,factory:e=>pe(Ct,J(G({},e.payload),{cartCode:e.payload.cartId}))})}registerEditSavedCartEvents(){this.buildSaveCartSuccessEvent({action:Ea,event:ra}),this.stateEventService.register({action:Da,event:gt,factory:e=>pe(gt,J(G({},e.payload),{cartCode:e.payload.cartId}))}),this.stateEventService.register({action:Nt,event:St,factory:e=>pe(St,J(G({},e.payload),{cartCode:e.payload.cartId}))})}registerCloneSavedCartEvents(){this.buildRestoreSavedCartEvents({action:Ut,event:oa}),this.buildRestoreSavedCartEvents({action:Ta,event:sa}),this.buildRestoreSavedCartEvents({action:Ia,event:ca})}buildRestoreSavedCartEvents(e){let i=this.getAction(e.action).pipe(D(n=>Y(n).pipe(he(this.multiCartService.getCart(n.payload.cartId)))),g(([n,l])=>pe(e.event,G(J(G({},n.payload),{cartCode:l.code,saveCartName:l.name,saveCartDescription:l.description}),l.saveTime&&{saveTime:l.saveTime}))));return this.eventService.register(e.event,i)}buildSaveCartSuccessEvent(e){let i=this.getAction(e.action).pipe(D(n=>Y(n).pipe(he(this.multiCartService.getCart(n.payload.cartId)))),O(([,n])=>!!n),g(([n,l])=>pe(e.event,J(G({},n.payload),{cartCode:l.code,saveTime:l.saveTime}))));return this.eventService.register(e.event,i)}getAction(e){return this.actionsSubject.pipe(Z(...[].concat(e)))}};t.\u0275fac=function(i){return new(i||t)(_(si),_(_e),_(mi),_(xe))},t.\u0275prov=Q({token:t,factory:t.\u0275fac,providedIn:"root"});let a=t;return a})(),Mn=(()=>{let t=class t{constructor(e){}};t.\u0275fac=function(i){return new(i||t)(_(On))},t.\u0275mod=k({type:t}),t.\u0275inj=M({});let a=t;return a})(),kn=(()=>{let t=class t{constructor(e,i,n,l,L){this.actions$=e,this.savedCartConnector=i,this.activeCartService=n,this.globalMessageService=l,this.cartConnector=L,this.logger=te(vi),this.loadSavedCart$=ce(()=>this.actions$.pipe(Z(ga),g(u=>u.payload),D(({userId:u,cartId:S})=>this.savedCartConnector.get(u,S).pipe(D(x=>[new Ce.LoadCartSuccess({userId:u,cartId:S,cart:x}),new xt({userId:u,cartId:S})]),ee(x=>Y(new yt({userId:u,cartId:S,error:le(x,this.logger)}))))))),this.loadSavedCarts$=ce(()=>this.actions$.pipe(Z(ha),g(u=>u.payload),D(({userId:u})=>this.savedCartConnector.getList(u).pipe(D(S=>[new Ce.LoadCartsSuccess(S),new Et({userId:u})]),ee(S=>Y(new Dt({userId:u,error:le(S,this.logger)}))))))),this.restoreSavedCart$=ce(()=>this.actions$.pipe(Z(jt),g(u=>u.payload),he(this.activeCartService.getActive()),D(([{userId:u,cartId:S},x])=>{let $=[];return(x?.entries??[]).length>0&&!x.quoteCode&&x.code&&$.push(new Je({userId:u,cartId:x.code,saveCartName:"",saveCartDescription:""})),this.savedCartConnector.restoreSavedCart(u,S).pipe(D(N=>(this.globalMessageService.add({key:(x?.entries??[]).length>0&&!x.quoteCode?"savedCartList.swapCartWithActiveCart":"savedCartList.swapCartNoActiveCart",params:{cartName:S,previousCartName:x.code}},ve.MSG_TYPE_CONFIRMATION),[...$,new Ce.LoadCartSuccess({userId:u,cartId:S,cart:N,extraData:{active:!0}}),new It({userId:u,cartId:S})])),ee(N=>Y(new bt({userId:u,cartId:S,error:le(N,this.logger)}))))}))),this.saveCart$=ce(()=>this.actions$.pipe(Z(Pt),g(u=>u.payload),D(({userId:u,cartId:S,saveCartName:x,saveCartDescription:$})=>this.cartConnector.save(u,S,x,$).pipe(D(N=>[new Ce.ClearCartState,new Ce.LoadCartSuccess({userId:u,cartId:S,cart:N}),new Ft({userId:u,cartId:S,saveCartName:x,saveCartDescription:$})]),ee(N=>Y(new Rt({userId:u,cartId:S,saveCartName:x,saveCartDescription:$,error:le(N,this.logger)}))))))),this.editSavedCart$=ce(()=>this.actions$.pipe(Z(Nt),g(u=>u.payload),D(({userId:u,cartId:S,saveCartName:x,saveCartDescription:$})=>this.cartConnector.save(u,S,x,$).pipe(D(N=>[new Ce.LoadCartSuccess({userId:u,cartId:S,cart:N}),new Vt({userId:u,cartId:S,saveCartName:x,saveCartDescription:$})]),ee(N=>Y(new $t({userId:u,cartId:S,saveCartName:x,saveCartDescription:$,error:le(N,this.logger)}))))))),this.cloneSavedCart$=ce(()=>this.actions$.pipe(Z(Ut),g(u=>u.payload),D(({userId:u,cartId:S,saveCartName:x})=>this.savedCartConnector.cloneSavedCart(u,S,x).pipe(D($=>[new Mt({userId:u,cartId:S,saveCartName:x}),new Ze({userId:u,cartId:S}),new Ke({userId:u})]),ee($=>Y(new kt({userId:u,cartId:S,saveCartName:x,error:le($,this.logger)})))))))}};t.\u0275fac=function(i){return new(i||t)(_(di),_(Sa),_(We),_(we),_(Ji))},t.\u0275prov=Q({token:t,factory:t.\u0275fac});let a=t;return a})(),Bn=[kn],jn=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=k({type:t}),t.\u0275inj=M({imports:[li.forFeature(Bn)]});let a=t;return a})(),ma=(()=>{let t=class t{constructor(e,i,n,l,L){this.store=e,this.userIdService=i,this.userAccountFacade=n,this.multiCartService=l,this.eventService=L}loadSavedCart(e){this.userIdService.takeUserId(!0).subscribe({next:i=>this.store.dispatch(new ft({userId:i,cartId:e})),error:()=>{}})}get(e){return this.getSavedCart(e).pipe(Ne(Pe),he(this.eventService.get(He).pipe(Kt({}))),O(([i,n])=>!!i),U(([i,n])=>{if(Object.keys(n).length>0)return Qt;i.loading||i.success||i.error||this.loadSavedCart(e)}),O(([i])=>i.success||!!i.error),g(([i])=>i.value))}getSavedCart(e){return this.multiCartService.getCartEntity(e)}isStable(e){return this.multiCartService.isStable(e)}loadSavedCarts(){this.userIdService.takeUserId(!0).subscribe({next:e=>this.store.dispatch(new Ke({userId:e})),error:()=>{}})}getList(){return this.getSavedCartList().pipe(he(this.getSavedCartListProcess()),U(([e,i])=>{i.loading||i.success||i.error||this.loadSavedCarts()}),g(([e,i])=>e),Ue({bufferSize:1,refCount:!0}))}getSavedCartList(){return ge([this.multiCartService.getCarts(),this.userAccountFacade.get()]).pipe(Ee(),g(([e,i])=>e.filter(n=>(i?.customerId!==void 0?n?.name!==`wishlist${i?.customerId}`:!0)&&!Zi(n?.code)&&n?.saveTime)))}getSavedCartListProcessLoading(){return this.store.pipe(j(P.getProcessLoadingFactory(ye)))}getSavedCartListProcess(){return this.store.pipe(j(P.getProcessStateFactory(ye)))}clearSavedCarts(){this.store.dispatch(new Tt)}restoreSavedCart(e){this.userIdService.takeUserId(!0).subscribe({next:i=>this.store.dispatch(new Ze({userId:i,cartId:e})),error:()=>{}})}getRestoreSavedCartProcessLoading(){return this.store.pipe(j(P.getProcessLoadingFactory(me)))}getRestoreSavedCartProcessSuccess(){return this.store.pipe(j(P.getProcessSuccessFactory(me)))}getRestoreSavedCartProcessError(){return this.store.pipe(j(P.getProcessErrorFactory(me)))}clearRestoreSavedCart(){this.store.dispatch(new At)}deleteSavedCart(e){this.userIdService.takeUserId(!0).subscribe({next:i=>this.multiCartService.deleteCart(e,i),error:()=>{}})}saveCart({cartId:e,saveCartName:i,saveCartDescription:n}){this.userIdService.takeUserId(!0).subscribe({next:l=>this.store.dispatch(new Lt({userId:l,cartId:e,saveCartName:i,saveCartDescription:n})),error:()=>{}})}getSaveCartProcessLoading(){return this.store.pipe(j(P.getProcessLoadingFactory(W)))}getSaveCartProcessSuccess(){return this.store.pipe(j(P.getProcessSuccessFactory(W)))}getSaveCartProcessError(){return this.store.pipe(j(P.getProcessErrorFactory(W)))}clearSaveCart(){this.store.dispatch(new wt)}editSavedCart({cartId:e,saveCartName:i,saveCartDescription:n}){this.userIdService.takeUserId(!0).subscribe({next:l=>this.store.dispatch(new Je({userId:l,cartId:e,saveCartName:i,saveCartDescription:n})),error:()=>{}})}cloneSavedCart(e,i){this.userIdService.takeUserId(!0).subscribe({next:n=>this.store.dispatch(new Ot({userId:n,cartId:e,saveCartName:i})),error:()=>{}})}getCloneSavedCartProcessLoading(){return this.store.pipe(j(P.getProcessLoadingFactory(Se)))}getCloneSavedCartProcessSuccess(){return this.store.pipe(j(P.getProcessSuccessFactory(Se)))}getCloneSavedCartProcessError(){return this.store.pipe(j(P.getProcessErrorFactory(Se)))}clearCloneSavedCart(){this.store.dispatch(new Bt)}};t.\u0275fac=function(i){return new(i||t)(_(ci),_(Re),_(Hi),_(xe),_(_e))},t.\u0275prov=Q({token:t,factory:t.\u0275fac});let a=t;return a})(),Pn=[ma,{provide:z,useExisting:ma}],ba=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=k({type:t}),t.\u0275inj=M({providers:[Sa,...Pn],imports:[jn,Mn]});let a=t;return a})();var Nn=(()=>{let t=class t{constructor(e,i,n){this.http=e,this.occEndpoints=i,this.converter=n,this.featureConfigService=te(Si)}load(e,i){return this.http.get(this.getSavedCartEndpoint(e,i)).pipe(g(n=>n.savedCartData),this.converter.pipeable(Me))}loadList(e){return this.http.get(this.getSavedCartListEndpoint(e)).pipe(g(i=>i.carts??[]),this.converter.pipeableMany(Me))}restoreSavedCart(e,i){return this.http.patch(this.getRestoreSavedCartEndpoint(e,i),i).pipe(g(n=>n.savedCartData),this.converter.pipeable(Me))}cloneSavedCart(e,i,n){let l=new ri;this.featureConfigService?.isEnabled("occCartNameAndDescriptionInHttpRequestBody")&&(l=l.set("name",n));let L=this.getCloneSavedCartEndpoint(e,i,n);return this.http.post(L,l).pipe(g(u=>u.savedCartData),this.converter.pipeable(Me))}getSavedCartEndpoint(e,i){return this.occEndpoints.buildUrl("savedCart",{urlParams:{userId:e,cartId:i}})}getSavedCartListEndpoint(e){return this.occEndpoints.buildUrl("savedCarts",{urlParams:{userId:e}})}getRestoreSavedCartEndpoint(e,i){return this.occEndpoints.buildUrl("restoreSavedCart",{urlParams:{userId:e,cartId:i}})}getCloneSavedCartEndpoint(e,i,n){return this.occEndpoints.buildUrl("cloneSavedCart",{urlParams:{userId:e,cartId:i,saveCartName:n}})}};t.\u0275fac=function(i){return new(i||t)(_(oi),_(Ci),_(xi))},t.\u0275prov=Q({token:t,factory:t.\u0275fac});let a=t;return a})();function Un(){return{backend:{occ:{endpoints:{savedCarts:"/users/${userId}/carts?savedCartsOnly=true&fields=carts(DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),totalUnitCount,deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),saveTime,user,name,description)",savedCart:"/users/${userId}/carts/${cartId}/savedcart",restoreSavedCart:"/users/${userId}/carts/${cartId}/restoresavedcart",cloneSavedCart:te(hi).occCartNameAndDescriptionInHttpRequestBody?"/users/${userId}/carts/${cartId}/clonesavedcart":"/users/${userId}/carts/${cartId}/clonesavedcart?name=${saveCartName}"}}}}}var Aa=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=k({type:t}),t.\u0275inj=M({providers:[pi(Un),{provide:je,useClass:Nn}],imports:[se]});let a=t;return a})();var qr=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=k({type:t}),t.\u0275inj=M({imports:[ba,Aa,Ca]});let a=t;return a})();export{qr as SavedCartModule};
