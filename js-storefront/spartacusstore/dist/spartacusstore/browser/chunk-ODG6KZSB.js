import{a as kt}from"./chunk-5UGD7CLM.js";import{L as J,M as Z,N as _t,O as M}from"./chunk-OB3MC34I.js";import{O as q,T as K,V as At,X as Ft,Y as W,aa as Lt,ka as Mt,yb as Ut,zb as $t}from"./chunk-OOBMFFZN.js";import{$b as Tt,Ab as pt,Ac as A,Bb as C,Cb as B,Da as at,Db as I,Ea as ct,I as ot,Lb as dt,Ld as Rt,Mb as w,Nb as Et,Pd as bt,Q as b,Ra as a,Rb as l,Re as Nt,Sa as x,Sb as u,Tb as z,Wb as vt,We as Bt,Xe as wt,Yd as St,Yf as Pt,Zf as F,_f as L,ab as p,ae as j,bb as S,cb as s,eb as ht,ib as g,jb as y,kb as k,lb as d,mb as f,n as v,nb as st,ob as lt,oc as ft,pa as Q,pc as D,pd as gt,qa as T,qb as ut,rb as c,rd as mt,s as rt,sa as H,ta as $,tf as Dt,ub as X,uc as P,v as R,xa as N,ya as O,yf as yt,zd as Ot,zf as V}from"./chunk-M6I5A6DT.js";var Gt=(e,n,r)=>({ownerType:e,entityKey:n,displayOnly:r}),Vt=(e,n)=>({cxRoute:e,params:n});function Yt(e,n){e&1&&st(0)}function Qt(e,n){if(e&1&&(g(0,"label",4),p(1,Yt,1,0,"ng-container",5),y()),e&2){c(2);let r=pt(3),t=c();a(),s("ngIf",t.isDisabled())("ngIfThen",r)}}function Ht(e,n){e&1&&st(0)}function Xt(e,n){if(e&1&&(g(0,"a",6),l(1,"cxUrl"),l(2,"async"),p(3,Ht,1,0,"ng-container",5),y()),e&2){let r=c(2).ngIf,t=pt(3),i=c();s("routerLink",u(1,5,w(13,Vt,i.getRoute(),Et(9,Gt,i.retrieveOwnerTypeFromAbstractOrderType(r),i.retrieveEntityKey(r),i.getDisplayOnly()))))("queryParams",u(2,7,i.queryParams$)),S("aria-describedby",i.getResolveIssuesA11yDescription()),a(3),s("ngIf",!i.isDisabled())("ngIfThen",t)}}function zt(e,n){if(e&1&&(d(0),p(1,Qt,2,2,"label",2)(2,Xt,4,16,"a",3),f()),e&2){let r=c(2);a(),s("ngIf",r.isDisabled()),a(),s("ngIf",!r.isDisabled())}}function Jt(e,n){e&1&&(d(0),C(1),l(2,"cxTranslate"),f()),e&2&&(a(),I(" ",u(2,1,"configurator.header.displayConfiguration"),""))}function Zt(e,n){e&1&&(d(0),C(1),l(2,"cxTranslate"),f()),e&2&&(a(),I(" ",u(2,1,"configurator.header.editConfiguration")," "))}function te(e,n){e&1&&(d(0),C(1),l(2,"cxTranslate"),f()),e&2&&(a(),I(" ",u(2,1,"configurator.header.resolveIssues")," "))}function ee(e,n){if(e&1&&p(0,Jt,3,3,"ng-container",1)(1,Zt,3,3,"ng-container",1)(2,te,3,3,"ng-container",1),e&2){let r=c(2);s("ngIf",r.getDisplayOnly()),a(),s("ngIf",!r.getDisplayOnly()&&!r.msgBanner),a(),s("ngIf",!r.getDisplayOnly()&&r.msgBanner)}}function ne(e,n){if(e&1&&(d(0),p(1,zt,3,2,"ng-container",1)(2,ee,3,3,"ng-template",null,0,vt),f()),e&2){let r=c();a(),s("ngIf",r.cartEntry)}}var qt=e=>({count:e});function ie(e,n){if(e&1&&(k(0,"cx-configure-cart-entry",4),l(1,"async")),e&2){let r,t=c().ngIf,i=c(2).ngIf,o=c();s("cartEntry",i)("readOnly",(r=u(1,4,o.readonly$))!==null&&r!==void 0?r:!1)("msgBanner",!0)("disabled",t.disabled)}}function re(e,n){if(e&1&&(d(0),p(1,ie,2,6,"cx-configure-cart-entry",3),l(2,"async"),f()),e&2){let r=c(2).ngIf,t=c();a(),s("ngIf",u(2,1,t.shouldShowButton$)&&(r==null||r.product==null?null:r.product.configurable))}}function oe(e,n){if(e&1&&(d(0),k(1,"cx-icon",1),g(2,"div",2),C(3),l(4,"cxTranslate"),p(5,re,3,3,"ng-container",0),l(6,"async"),y(),f()),e&2){let r=c().ngIf,t=c();a(),s("type",t.iconTypes.ERROR),a(),X("id",t.getErrorMessageId(r)),a(),I(" ",z(4,4,"configurator.notificationBanner.numberOfIssues",dt(9,qt,t.getNumberOfIssues(r)))," "),a(2),s("ngIf",u(6,7,t.quantityControl$))}}function ae(e,n){if(e&1&&(d(0),p(1,oe,7,11,"ng-container",0),l(2,"async"),f()),e&2){let r=n.ngIf,t=c();a(),s("ngIf",t.hasIssues(r)&&!u(2,1,t.readonly$))}}var ce=(e,n)=>({attribute:e,value:n});function se(e,n){e&1&&(g(0,"span",3),C(1),l(2,"cxTranslate"),y()),e&2&&(a(),I(" ",u(2,1,"configurator.a11y.cartEntryInfoIntro")," "))}function le(e,n){if(e&1&&(g(0,"div",4)(1,"span",5),C(2),l(3,"cxTranslate"),y(),g(4,"div",6),C(5),y(),g(6,"div",7),C(7),y()()),e&2){let r=n.$implicit,t=n.index,i=c(4);S("aria-describedby",i.getHiddenConfigurationInfoId(t)),a(),X("id",i.getHiddenConfigurationInfoId(t)),a(),I(" ",z(3,5,"configurator.a11y.cartEntryInfo",w(8,ce,r.configurationLabel,r.configurationValue))," "),a(3),I(" ",r==null?null:r.configurationLabel,": "),a(2),I(" ",r==null?null:r.configurationValue," ")}}function ue(e,n){if(e&1&&(d(0),p(1,se,3,3,"span",1)(2,le,8,11,"div",2),f()),e&2){let r,t=c(2).ngIf;a(),s("ngIf",(r=t.configurationInfos==null?null:t.configurationInfos.length)!==null&&r!==void 0?r:!1),a(),s("ngForOf",t.configurationInfos)}}function pe(e,n){if(e&1&&(k(0,"cx-configure-cart-entry",9),l(1,"async")),e&2){let r,t=c().ngIf,i=c(2).ngIf,o=c();s("cartEntry",i)("readOnly",(r=u(1,4,o.readonly$))!==null&&r!==void 0?r:!1)("msgBanner",!1)("disabled",t.disabled)}}function de(e,n){if(e&1&&(d(0),p(1,pe,2,6,"cx-configure-cart-entry",8),l(2,"async"),f()),e&2){let r=c(2).ngIf,t=c();a(),s("ngIf",u(2,1,t.shouldShowButton$)&&(r==null||r.product==null?null:r.product.configurable))}}function fe(e,n){if(e&1&&(d(0),p(1,ue,3,2,"ng-container",0)(2,de,3,3,"ng-container",0),l(3,"async"),f()),e&2){let r=c().ngIf,t=c();a(),s("ngIf",t.hasStatus(r)),a(),s("ngIf",u(3,2,t.quantityControl$))}}function ge(e,n){if(e&1&&(d(0),p(1,fe,4,4,"ng-container",0),f()),e&2){let r=n.ngIf,t=c();a(),s("ngIf",t.isAttributeBasedConfigurator(r))}}var me=(e,n)=>({ownerType:e,entityKey:n}),ye=(e,n)=>({displayRestartDialog:e,productCode:n});function _e(e,n){if(e&1){let r=lt();d(0),g(1,"button",2),l(2,"cxTranslate"),ut("click",function(){at(r);let i=c(2).ngIf,o=c();return ct(o.navigateToConfigurator(i))}),C(3),l(4,"cxTranslate"),y(),f()}if(e&2){let r=c(2).ngIf,t=c();a(),S("aria-label",u(2,2,t.getAriaLabelTranslationKey(r.configuratorType))),a(2),I(" ",u(4,4,t.getTranslationKey(r.configuratorType))," ")}}function Ce(e,n){if(e&1&&(d(0),g(1,"a",3),l(2,"cxUrl"),l(3,"cxTranslate"),C(4),l(5,"cxTranslate"),y(),f()),e&2){let r=c(2).ngIf,t=c();a(),s("routerLink",u(2,4,w(13,Vt,"configure"+r.configuratorType,w(10,me,t.ownerTypeProduct,r.code))))("queryParams",w(16,ye,t.isDisplayRestartDialog(r.configuratorType),r.code)),S("aria-label",u(3,6,t.getAriaLabelTranslationKey(r.configuratorType))),a(3),B(u(5,8,t.getTranslationKey(r.configuratorType)))}}function Ie(e,n){e&1&&(d(0),p(1,_e,5,6,"ng-container",1)(2,Ce,6,19,"ng-container",1),f()),e&2&&(a(),s("cxFeature","a11yUseButtonsForBtnLinks"),a(),s("cxFeature","!a11yUseButtonsForBtnLinks"))}function xe(e,n){if(e&1&&(d(0),p(1,Ie,3,2,"ng-container",0),f()),e&2){let r=n.ngIf;a(),s("ngIf",r.configurable)}}function he(e,n){if(e&1&&(d(0),g(1,"span",11),C(2),l(3,"cxTranslate"),y(),g(4,"span",12),C(5),l(6,"cxNumeric"),y(),f()),e&2){let r=c().$implicit;a(2),B(u(3,2,"configurator.attribute.quantity")),a(3),B(u(6,4,r==null?null:r.formattedQuantity))}}function Ee(e,n){if(e&1&&(d(0),g(1,"span",11),C(2),l(3,"cxTranslate"),y(),g(4,"span",12),C(5),y(),f()),e&2){let r=c().$implicit;a(2),B(u(3,2,"configurator.overviewForm.itemPrice")),a(3),B(r==null?null:r.formattedPrice)}}function ve(e,n){if(e&1&&(g(0,"div",6)(1,"span",7),C(2),y(),g(3,"div",8),C(4),y(),g(5,"div",9),p(6,he,7,6,"ng-container",0),y(),g(7,"div",10),p(8,Ee,6,4,"ng-container",0),y()()),e&2){let r=n.$implicit,t=n.index,i=c(4);S("aria-describedby",i.getHiddenItemInfoId(t)),a(),X("id",i.getHiddenItemInfoId(t)),a(),I(" ",i.getHiddenItemInfo(r)," "),a(2),I(" ",r==null?null:r.name," "),a(2),s("ngIf",r==null?null:r.formattedQuantity),a(2),s("ngIf",r==null?null:r.formattedPrice)}}function Te(e,n){if(e&1){let r=lt();d(0),g(1,"div",1),C(2),l(3,"cxTranslate"),y(),g(4,"button",2),ut("click",function(){at(r);let i=c(3);return ct(i.toggleItems())}),g(5,"div",3),C(6),y()(),g(7,"div",4),p(8,ve,9,6,"div",5),l(9,"async"),y(),f()}if(e&2){let r=n.ngIf,t=c(3);a(2),I(" ",z(3,7,"configurator.header.items",dt(12,qt,r))," "),a(2),S("aria-expanded",!t.hideItems)("aria-label",t.getItemsMsg(r)),a(2),I(" ",t.getButtonText()," "),a(),ht("open",!t.hideItems),a(),s("ngForOf",u(9,10,t.lineItems$))}}function Oe(e,n){if(e&1&&(k(0,"cx-configure-cart-entry",14),l(1,"async")),e&2){let r,t=c().ngIf,i=c(2).ngIf,o=c();s("cartEntry",i)("readOnly",(r=u(1,4,o.readonly$))!==null&&r!==void 0?r:!1)("msgBanner",!1)("disabled",t.disabled)}}function Re(e,n){if(e&1&&(d(0),p(1,Oe,2,6,"cx-configure-cart-entry",13),l(2,"async"),f()),e&2){let r=c(2).ngIf,t=c();a(),s("ngIf",u(2,1,t.shouldShowButton$)&&(r==null||r.product==null?null:r.product.configurable))}}function be(e,n){if(e&1&&(d(0),p(1,Te,10,14,"ng-container",0),l(2,"async"),p(3,Re,3,3,"ng-container",0),l(4,"async"),f()),e&2){let r=c(2);a(),s("ngIf",u(2,2,r.numberOfLineItems$)),a(2),s("ngIf",u(4,4,r.quantityControl$))}}function Se(e,n){if(e&1&&(d(0),p(1,be,5,6,"ng-container",0),f()),e&2){let r=n.ngIf,t=c();a(),s("ngIf",t.isBundleBasedConfigurator(r))}}var E;(function(e){let n;(function(r){r.PRODUCT="product",r.CART_ENTRY="cartEntry",r.ORDER_ENTRY="orderEntry",r.QUOTE_ENTRY="quoteEntry",r.SAVED_CART_ENTRY="savedCartEntry"})(n=e.OwnerType||(e.OwnerType={}))})(E||(E={}));var Ct="_READ_ONLY",Kt=function(e){return e.Success="SUCCESS",e.Info="INFO",e.Warning="WARNING",e.Error="ERROR",e}(Kt||{}),U=function(e){return e.KEY="KEY",e.NAME="NAME",e.QTY="QTY",e.FORMATTED_PRICE="FORMATTED_PRICE",e.PRICE_VALUE="PRICE_VALUE",e}(U||{}),G=function(e){return e.VERSION="CI#@#VERSION",e.CURRENCY="CI#@#CURRENCY",e.LINE_ITEM="LI",e.LINE_ITEM_DELIMITER="#",e}(G||{}),tt="INITIAL",et=class e{static getOwnerKey(n,r){if(!r||!n)throw new Error("We expect an owner ID and an owner type");return n+"/"+r}static createInitialOwner(){return{key:tt,configuratorType:tt,id:tt,type:E.OwnerType.PRODUCT}}static isInitialOwner(n){return n.configuratorType===tt}static createOwner(n,r,t="CPQCONFIGURATOR"){return{type:n,id:r,configuratorType:t,key:e.getOwnerKey(n,r)}}},Y=(()=>{let n=class n{constructor(t){this.userIdService=t}setOwnerKey(t){t.key=et.getOwnerKey(t.type,t.id)}getComposedOwnerId(t,i){return t+"+"+i}decomposeOwnerId(t){let i=t.split("+");if(i.length!==2)throw new Error("We only expect 2 parts in ownerId, separated by +, but was: "+t);return{documentId:i[0],entryNumber:i[1]}}getCartId(t){let i=t?.user?.uid===Rt?t.guid:t?.code;if(!i)throw new Error("Cart ID is not defined");return i}hasIssues(t){return this.getNumberOfIssues(t)>0}getNumberOfIssues(t){let i=0;return t?.statusSummaryList?.forEach(o=>{if(o.status===Kt.Error){let _=o.numberOfIssues;i=_||0}}),i}isAttributeBasedConfigurator(t){return t?t==="CPQCONFIGURATOR"||t==="TEXTFIELD":!1}isBundleBasedConfigurator(t){return t?t==="CLOUDCPQCONFIGURATOR":!1}isActiveCartContext(t){return(t?.location$??v).pipe(R(i=>i!==_t.SaveForLater&&i!==_t.SavedCart))}getSlotsFromLayoutConfiguration(t,i,o,_){let m=t.layoutSlots;return m?m[i][o][_].slots:[]}};n.\u0275fac=function(i){return new(i||n)(H(bt))},n.\u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})(),It=(()=>{let n=class n{hasIssues(){return this.commonConfigUtilsService.hasIssues(this.cartEntry)}getOwnerType(){return this.cartEntry.orderCode!==void 0?E.OwnerType.ORDER_ENTRY:E.OwnerType.CART_ENTRY}retrieveOwnerTypeFromAbstractOrderType(t){switch(t.type){case M.ORDER:return E.OwnerType.ORDER_ENTRY;case M.QUOTE:return E.OwnerType.QUOTE_ENTRY;case M.SAVED_CART:return E.OwnerType.SAVED_CART_ENTRY;default:return E.OwnerType.CART_ENTRY}}getEntityKey(){let t=this.cartEntry.entryNumber;if(t===void 0)throw new Error("No entryNumber present in entry");return this.cartEntry.orderCode?this.commonConfigUtilsService.getComposedOwnerId(this.cartEntry.orderCode,t):t.toString()}retrieveEntityKey(t){let i=this.cartEntry.entryNumber;if(i===void 0)throw new Error("No entryNumber present in entry");return t.type!==M.CART?this.commonConfigUtilsService.getComposedOwnerId(t.id,i):i.toString()}getRoute(){let t=this.cartEntry.product?.configuratorType;return!this.readOnly||t?.endsWith(Ct)?"configure"+t:"configureOverview"+t}getDisplayOnly(){let t=this.cartEntry.product?.configuratorType;return this.readOnly||!t||t.endsWith(Ct)}isDisabled(){return this.readOnly?!1:this.disabled}getResolveIssuesA11yDescription(){let t="cx-error-msg-"+this.cartEntry.entryNumber;return!this.getDisplayOnly()&&this.msgBanner?t:void 0}getQueryParams(){return{forceReload:!0,resolveIssues:this.msgBanner&&this.hasIssues()}}isInCheckout(){return this.routingService.getRouterState().pipe(R(t=>t.state.semanticRoute==="checkoutReviewOrder"))}constructor(t){this.commonConfigUtilsService=t,this.routingService=$(j),this.abstractOrderContext=$(kt,{optional:!0}),this.abstractOrderKey$=this.abstractOrderContext?this.abstractOrderContext.key$:rt({type:M.CART}),this.queryParams$=this.isInCheckout().pipe(R(i=>({forceReload:!0,resolveIssues:this.msgBanner&&this.hasIssues(),navigateToCheckout:i,productCode:this.cartEntry.product?.code})))}};n.\u0275fac=function(i){return new(i||n)(x(Y))},n.\u0275cmp=N({type:n,selectors:[["cx-configure-cart-entry"]],inputs:{cartEntry:"cartEntry",readOnly:"readOnly",msgBanner:"msgBanner",disabled:"disabled"},decls:2,vars:3,consts:[["configureText",""],[4,"ngIf"],["class","disabled-link",4,"ngIf"],["class","link cx-action-link","cxAutoFocus","",3,"routerLink","queryParams",4,"ngIf"],[1,"disabled-link"],[4,"ngIf","ngIfThen"],["cxAutoFocus","",1,"link","cx-action-link",3,"routerLink","queryParams"]],template:function(i,o){i&1&&(p(0,ne,4,1,"ng-container",1),l(1,"async")),i&2&&s("ngIf",u(1,1,o.abstractOrderKey$))},dependencies:[D,gt,P,yt,F],encapsulation:2,changeDetection:0});let e=n;return e})(),it=(()=>{let n=class n{};n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=O({type:n}),n.\u0275inj=T({imports:[A,V,L,W,mt]});let e=n;return e})(),Ne=(()=>{let n=class n{constructor(t,i){this.commonConfigUtilsService=t,this.cartItemContext=i,this.iconTypes=At,this.orderEntry$=this.cartItemContext?.item$??v,this.quantityControl$=this.cartItemContext?.quantityControl$??v,this.readonly$=this.cartItemContext?.readonly$??v,this.shouldShowButton$=this.commonConfigUtilsService.isActiveCartContext(this.cartItemContext)}hasIssues(t){return this.commonConfigUtilsService.hasIssues(t)}getNumberOfIssues(t){return this.commonConfigUtilsService.getNumberOfIssues(t)}getErrorMessageId(t){return"cx-error-msg-"+t.entryNumber}};n.\u0275fac=function(i){return new(i||n)(x(Y),x(J,8))},n.\u0275cmp=N({type:n,selectors:[["cx-configurator-issues-notification"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"type"],[3,"id"],["class","cx-error-msg-action",3,"cartEntry","readOnly","msgBanner","disabled",4,"ngIf"],[1,"cx-error-msg-action",3,"cartEntry","readOnly","msgBanner","disabled"]],template:function(i,o){i&1&&(p(0,ae,3,3,"ng-container",0),l(1,"async")),i&2&&s("ngIf",u(1,1,o.orderEntry$))},dependencies:[D,Ft,It,P,F],encapsulation:2});let e=n;return e})(),Wt=(()=>{let n=class n{};n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=O({type:n}),n.\u0275inj=T({providers:[K({id:Z.ITEM_CONFIGURATOR_ISSUES,position:q.REPLACE,component:Ne})],imports:[A,V,L,W,it]});let e=n;return e})(),Be=(()=>{let n=class n{constructor(t,i){this.cartItemContext=t,this.commonConfigUtilsService=i,this.orderEntry$=this.cartItemContext?.item$??v,this.quantityControl$=this.cartItemContext?.quantityControl$??v,this.readonly$=this.cartItemContext?.readonly$??v,this.shouldShowButton$=this.commonConfigUtilsService.isActiveCartContext(this.cartItemContext)}hasStatus(t){let i=t.configurationInfos;return i?i.length>0&&i[0].status!=="NONE":!1}isAttributeBasedConfigurator(t){let i=t.configurationInfos;return i?this.commonConfigUtilsService.isAttributeBasedConfigurator(i[0]?.configuratorType):!1}getHiddenConfigurationInfoId(t){return"cx-configuration-hidden-info-"+t.toString()}};n.\u0275fac=function(i){return new(i||n)(x(J,8),x(Y))},n.\u0275cmp=N({type:n,selectors:[["cx-configurator-cart-entry-info"]],decls:2,vars:3,consts:[[4,"ngIf"],["class","cx-intro cx-visually-hidden",4,"ngIf"],["class","cx-configuration-info",4,"ngFor","ngForOf"],[1,"cx-intro","cx-visually-hidden"],[1,"cx-configuration-info"],[1,"cx-visually-hidden",3,"id"],["aria-hidden","true",1,"cx-label"],["aria-hidden","true",1,"cx-value"],[3,"cartEntry","readOnly","msgBanner","disabled",4,"ngIf"],[3,"cartEntry","readOnly","msgBanner","disabled"]],template:function(i,o){i&1&&(p(0,ge,2,1,"ng-container",0),l(1,"async")),i&2&&s("ngIf",u(1,1,o.orderEntry$))},dependencies:[ft,D,It,P,F],encapsulation:2});let e=n;return e})(),we=(()=>{let n=class n{};n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=O({type:n}),n.\u0275inj=T({providers:[K({id:Z.ITEM_DETAILS,position:q.AFTER,component:Be})],imports:[A,V,L,W,Wt,it]});let e=n;return e})(),xt=function(e){return e.CONFIGURATOR="configurator",e.CONFIGURATOR_PRODUCT_CARD="configuratorProductCard",e}(xt||{}),jt=(()=>{let n=class n{getAriaLabelTranslationKey(t){return this.isConfiguratorTypeReadOnly(t)?"configurator.a11y.showDetailsProduct":"configurator.a11y.configureProduct"}getTranslationKey(t){return this.isConfiguratorTypeReadOnly(t)?"configurator.header.toConfigReadOnly":"configurator.header.toconfig"}isDisplayRestartDialog(t){return this.isConfiguratorTypeReadOnly(t)?"false":"true"}navigateToConfigurator(t){this.routingService?.go({cxRoute:"configure"+t.configuratorType,params:{ownerType:this.ownerTypeProduct,entityKey:t.code}},{queryParams:{displayRestartDialog:this.isDisplayRestartDialog(t.configuratorType),productCode:t.code}})}isConfiguratorTypeReadOnly(t){return!!t&&t.trim().endsWith(Ct)}constructor(t,i){this.productListItemContext=t,this.currentProductService=i,this.nonConfigurable={configurable:!1},this.product$=(this.productListItemContext?this.productListItemContext.product$:this.currentProductService?this.currentProductService.getProduct(xt.CONFIGURATOR):rt(null)).pipe(R(o=>o||this.nonConfigurable)),this.ownerTypeProduct=E.OwnerType.PRODUCT,this.routingService=$(j,{optional:!0})}};n.\u0275fac=function(i){return new(i||n)(x($t,8),x(Mt,8))},n.\u0275cmp=N({type:n,selectors:[["cx-configure-product"]],decls:2,vars:3,consts:[[4,"ngIf"],[4,"cxFeature"],["cxAutoFocus","",1,"btn","btn-primary","btn-block",3,"click"],["cxAutoFocus","",1,"btn","btn-primary","btn-block",3,"routerLink","queryParams"]],template:function(i,o){i&1&&(p(0,xe,2,1,"ng-container",0),l(1,"async")),i&2&&s("ngIf",u(1,1,o.product$))},dependencies:[D,gt,Nt,P,yt,F],encapsulation:2,changeDetection:0});let e=n;return e})(),De=(()=>{let n=class n{};n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=O({type:n}),n.\u0275inj=T({providers:[K({id:Ut.ITEM_ACTIONS,position:q.AFTER,component:jt})],imports:[A,mt,Bt.withConfig({cmsComponents:{ConfigureProductComponent:{component:jt}}}),V,L,W,wt]});let e=n;return e})(),Pe=(()=>{let n=class n{constructor(){this.logger=$(St)}retrieveLineItems(t){let i=[];if(t.configurationInfos){let o=t.configurationInfos.filter(h=>h&&(h.configurationLabel||h.configurationValue)),_=o[0]?.configurationLabel,m=o[0]?.configurationValue;_!==G.VERSION?o.forEach(h=>i.push(this.prepareLineItem(h))):_===G.VERSION&&Number(m)>=2?i=this.processConfigurationInfos(o):this.logWarning("Wrong ConfigurationInfo version")}return i}prepareLineItem(t){let i=t.configurationValue?t.configurationValue.split("x"):[];return{name:t.configurationLabel?this.removeDelimiter(t.configurationLabel):"",formattedQuantity:i.length>=1?i[0].trim():"",formattedPrice:i.length>=2?i[1].trim():""}}removeDelimiter(t){let i=t.trim();return i.charAt(i.length-1)===":"&&(i=i.substring(0,i.length-1)),i}processConfigurationInfos(t){let i=new Map;t.forEach(m=>this.processConfigurationInfoEntry(i,m));let o=new Map(Array.from(i).sort((m,h)=>m[0]-h[0]));return Array.from(o.values())}processConfigurationInfoEntry(t,i){if(i.configurationLabel){let o=i.configurationLabel.split(G.LINE_ITEM_DELIMITER);if(o[0]===G.LINE_ITEM){let _=i.configurationValue?i.configurationValue:"";this.addLineItemData(t,o,_)}}}addLineItemData(t,i,o){if(i.length===3){let _=Number(i[1]),m;switch(i[2]){case U.NAME:m=this.getOrCreateLineItem(t,_),m.name=o;break;case U.QTY:m=this.getOrCreateLineItem(t,_),m.formattedQuantity=o;break;case U.FORMATTED_PRICE:m=this.getOrCreateLineItem(t,_),m.formattedPrice=o;break;case U.KEY:case U.PRICE_VALUE:break;default:this.logWarning("Wrong LineItem format")}}else this.logWarning("Wrong LineItem format")}getOrCreateLineItem(t,i){let o=t.get(i)??{name:"",formattedQuantity:"",formattedPrice:""};return t.get(i)||t.set(i,o),o}logWarning(t){Tt()&&this.logger.warn(t)}};n.\u0275fac=function(i){return new(i||n)},n.\u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})(),Ae=(()=>{let n=class n{constructor(t,i,o,_,m){this.commonConfigUtilsService=t,this.configCartEntryBundleInfoService=i,this.breakpointService=o,this.translation=_,this.cartItemContext=m,this.orderEntry$=this.cartItemContext?.item$??v,this.quantityControl$=this.cartItemContext?.quantityControl$??v,this.readonly$=this.cartItemContext?.readonly$??v,this.hideItems=!0,this.lineItems$=this.orderEntry$.pipe(R(h=>this.configCartEntryBundleInfoService.retrieveLineItems(h))),this.numberOfLineItems$=this.lineItems$.pipe(R(h=>h.length)),this.shouldShowButton$=this.commonConfigUtilsService.isActiveCartContext(this.cartItemContext)}toggleItems(){this.hideItems=!this.hideItems}isBundleBasedConfigurator(t){let i=t.configurationInfos;return i?this.commonConfigUtilsService.isBundleBasedConfigurator(i[0]?.configuratorType):!1}getButtonText(t){return t||(t=""),this.hideItems?this.translation.translate("configurator.header.show").pipe(b(1)).subscribe(i=>t+=i):this.translation.translate("configurator.header.hide").pipe(b(1)).subscribe(i=>t+=i),t}getItemsMsg(t){let i="";return this.translation.translate("configurator.a11y.cartEntryBundleInfo",{items:t}).pipe(b(1)).subscribe(o=>i=o),this.getButtonText(i)}getHiddenItemInfo(t){let i="";return t.name&&t.formattedPrice&&t.formattedQuantity?this.translation.translate("configurator.a11y.cartEntryBundle",{name:t.name,price:t.formattedPrice,quantity:t.formattedQuantity}).pipe(b(1)).subscribe(o=>i=o):t.name&&t.formattedPrice?this.translation.translate("configurator.a11y.cartEntryBundleNameWithPrice",{name:t.name,price:t.formattedPrice}).pipe(b(1)).subscribe(o=>i=o):t.name&&t.formattedQuantity?this.translation.translate("configurator.a11y.cartEntryBundleNameWithQuantity",{name:t.name,quantity:t.formattedQuantity}).pipe(b(1)).subscribe(o=>i=o):this.translation.translate("configurator.a11y.cartEntryBundleName",{name:t.name}).pipe(b(1)).subscribe(o=>i=o),i}getHiddenItemInfoId(t){return"cx-item-hidden-info-"+t.toString()}};n.\u0275fac=function(i){return new(i||n)(x(Y),x(Pe),x(Lt),x(Dt),x(J,8))},n.\u0275cmp=N({type:n,selectors:[["cx-configurator-cart-entry-bundle-info"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"cx-number-items"],[3,"click"],[1,"cx-toggle-hide-items"],[1,"cx-item-infos"],["class","cx-item-info",4,"ngFor","ngForOf"],[1,"cx-item-info"],[1,"cx-visually-hidden",3,"id"],["aria-hidden","true",1,"cx-item-name"],["aria-hidden","true",1,"cx-item-quantity"],["aria-hidden","true",1,"cx-item-price"],[1,"cx-identifier"],[1,"cx-item"],[3,"cartEntry","readOnly","msgBanner","disabled",4,"ngIf"],[3,"cartEntry","readOnly","msgBanner","disabled"]],template:function(i,o){i&1&&(p(0,Se,2,1,"ng-container",0),l(1,"async")),i&2&&s("ngIf",u(1,1,o.orderEntry$))},dependencies:[ft,D,It,P,F,Pt],encapsulation:2});let e=n;return e})(),Fe=(()=>{let n=class n{};n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=O({type:n}),n.\u0275inj=T({providers:[K({id:Z.ITEM_BUNDLE_DETAILS,position:q.AFTER,component:Ae})],imports:[A,L,it]});let e=n;return e})(),Le=(()=>{let n=class n{};n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=O({type:n}),n.\u0275inj=T({imports:[Wt,we,Fe,it,De]});let e=n;return e})(),Me={backend:{occ:{endpoints:{product:{configurator:"products/${productCode}?fields=code,configurable,configuratorType",configuratorProductCard:"products/${productCode}?fields=code,description,images(DEFAULT)"}}},loadingScopes:{product:{list:{include:[xt.CONFIGURATOR]}}}}},Ue=(()=>{let n=class n{};n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=O({type:n}),n.\u0275inj=T({providers:[Ot(Me)]});let e=n;return e})(),ln=(()=>{let n=class n{};n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=O({type:n}),n.\u0275inj=T({imports:[Ue,Le]});let e=n;return e})(),nt;(function(e){let n;(function(r){r.CONFIGURATION="configuration",r.OVERVIEW="overview"})(n=e.PageType||(e.PageType={}))})(nt||(nt={}));var un=(()=>{let n=class n{constructor(t,i){this.configUtilsService=t,this.routingService=i,this.ROUTE_FRAGMENT_CONFIGURE="configure",this.ROUTE_FRAGMENT_OVERVIEW="configureOverview"}extractRouterData(){return this.routingService.getRouterState().pipe(ot(t=>t.state.params.entityKey),ot(t=>t.nextState===void 0),R(t=>{let i=this.createOwnerFromRouterState(t),o=t.state.semanticRoute;return{owner:i,isOwnerCartEntry:i.type===E.OwnerType.CART_ENTRY,displayOnly:t.state.params.displayOnly,resolveIssues:t.state.queryParams?.resolveIssues==="true",skipConflicts:t.state.queryParams?.skipConflicts==="true",forceReload:t.state.queryParams?.forceReload==="true",expMode:t.state.queryParams?.expMode==="true",displayRestartDialog:t.state.queryParams?.displayRestartDialog==="true",configIdTemplate:t.state.queryParams?.configIdTemplate,navigationId:t.navigationId,pageType:o&&o.includes(this.ROUTE_FRAGMENT_OVERVIEW)?nt.PageType.OVERVIEW:nt.PageType.CONFIGURATION,navigateToCheckout:t.state.queryParams?.navigateToCheckout==="true",productCode:t.state.queryParams?.productCode}}))}createOwnerFromRouterState(t){let i=et.createInitialOwner(),o=t.state.params;if(o.ownerType){let m=o.entityKey;i.type=o.ownerType,i.id=m}else i.type=E.OwnerType.PRODUCT,i.id=o.rootProduct;let _=t.state.semanticRoute;if(_){let m=this.getConfiguratorTypeFromSemanticRoute(_);i.configuratorType=m}return this.configUtilsService.setOwnerKey(i),i}getConfiguratorTypeFromSemanticRoute(t){if(t.startsWith(this.ROUTE_FRAGMENT_OVERVIEW))return t.split(this.ROUTE_FRAGMENT_OVERVIEW)[1];if(t.startsWith(this.ROUTE_FRAGMENT_CONFIGURE))return t.split(this.ROUTE_FRAGMENT_CONFIGURE)[1];throw new Error("Not able to determine configurator type")}};n.\u0275fac=function(i){return new(i||n)(H(Y),H(j))},n.\u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();export{E as a,et as b,Y as c,xt as d,ln as e,nt as f,un as g};
