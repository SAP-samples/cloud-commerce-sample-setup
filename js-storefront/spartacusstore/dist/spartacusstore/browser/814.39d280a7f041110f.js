"use strict";(self.webpackChunkstorefrontapp=self.webpackChunkstorefrontapp||[]).push([[814,716],{2716:(de,D,l)=>{l.r(D),l.d(D,{AddToCartComponent:()=>C,AddToCartModule:()=>A});var e=l(4650),g=l(4006),x=l(6789),u=l(1742),p=l(4850),P=l(2198),R=l(2986),T=l(9764),V=l(6895);function B(h,m){if(1&h&&e._UZ(0,"cx-item-counter",9),2&h){const d=e.oxw(3);e.Q6J("max",d.maxQuantity)("control",d.addToCartForm.get("quantity"))}}function Q(h,m){if(1&h&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&h){const d=e.oxw(3);e.xp6(1),e.Oqu(d.getInventory())}}function G(h,m){if(1&h&&(e.TgZ(0,"div",4)(1,"label"),e._uU(2),e.ALo(3,"cxTranslate"),e.qZA(),e.TgZ(4,"div",5),e.YNc(5,B,1,2,"cx-item-counter",6),e.TgZ(6,"span",7),e.YNc(7,Q,2,1,"span",8),e.ALo(8,"async"),e._uU(9),e.ALo(10,"cxTranslate"),e.ALo(11,"cxTranslate"),e.qZA()()()),2&h){const d=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,4,"addToCart.quantity")),e.xp6(3),e.Q6J("ngIf",d.hasStock),e.xp6(2),e.Q6J("ngIf",e.lcZ(8,6,d.showInventory$)),e.xp6(2),e.hij(" ",d.hasStock?e.lcZ(10,8,"addToCart.inStock"):e.lcZ(11,10,"addToCart.outOfStock"),"")}}function M(h,m){if(1&h&&(e.TgZ(0,"button",10),e._uU(1),e.ALo(2,"cxTranslate"),e.qZA()),2&h){const d=e.oxw(2);let w;e.Q6J("ngClass",null!=d.options&&d.options.displayAddToCart?"link cx-action-link":"btn btn-primary btn-block")("disabled",d.quantity<=0||d.quantity>d.maxQuantity),e.xp6(1),e.hij(" ",null!==(w=null==d.options?null:d.options.addToCartString)&&void 0!==w?w:e.lcZ(2,3,"addToCart.addToCart")," ")}}function N(h,m){if(1&h){const d=e.EpF();e.TgZ(0,"form",1),e.NdJ("submit",function(){e.CHM(d);const E=e.oxw();return e.KtG(E.addToCart())}),e.YNc(1,G,12,12,"div",2),e.YNc(2,M,3,5,"button",3),e.qZA()}if(2&h){const d=e.oxw();e.Q6J("formGroup",d.addToCartForm),e.xp6(1),e.Q6J("ngIf",d.showQuantity),e.xp6(1),e.Q6J("ngIf",d.hasStock)}}let C=(()=>{class h{constructor(d,w,E,I,q,Z){this.currentProductService=d,this.cd=w,this.activeCartService=E,this.component=I,this.eventService=q,this.productListItemContext=Z,this.showQuantity=!0,this.hasStock=!1,this.inventoryThreshold=!1,this.showInventory$=this.component?.data$.pipe((0,p.U)(H=>H.inventoryDisplay)),this.quantity=1,this.addToCartForm=new g.nJ({quantity:new g.p4(1,{updateOn:"blur"})})}ngOnInit(){this.product?(this.productCode=this.product.code??"",this.setStockInfo(this.product),this.cd.markForCheck()):this.productCode?(this.quantity=1,this.hasStock=!0,this.cd.markForCheck()):this.subscription=(this.productListItemContext?this.productListItemContext.product$:this.currentProductService.getProduct()).pipe((0,P.h)(u.jWE)).subscribe(d=>{this.productCode=d.code??"",this.setStockInfo(d),this.cd.markForCheck()})}setStockInfo(d){this.quantity=1,this.hasStock=Boolean("outOfStock"!==d.stock?.stockLevelStatus),this.inventoryThreshold=d.stock?.isValueRounded??!1,this.hasStock&&d.stock?.stockLevel&&(this.maxQuantity=d.stock.stockLevel),this.productListItemContext&&(this.showQuantity=!1)}getInventory(){if(this.hasStock){const d=this.maxQuantity?this.maxQuantity.toString():"";return this.inventoryThreshold?d+"+":d}return""}updateCount(d){this.quantity=d}addToCart(){const d=this.addToCartForm.get("quantity")?.value;!this.productCode||d<=0||this.activeCartService.getEntries().pipe((0,R.q)(1)).subscribe(w=>{this.activeCartService.addEntry(this.productCode,d),this.eventService.dispatch(this.createCartUiEventAddToCart(this.productCode,d,w.length))})}createCartUiEventAddToCart(d,w,E){const I=new x.wj;return I.productCode=d,I.quantity=w,I.numberOfEntriesBeforeAdd=E,I}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return h.\u0275fac=function(d){return new(d||h)(e.Y36(T.pHG),e.Y36(e.sBO),e.Y36(x.bu),e.Y36(T.exf),e.Y36(u.POd),e.Y36(T.Z6X,8))},h.\u0275cmp=e.Xpm({type:h,selectors:[["cx-add-to-cart"]],inputs:{productCode:"productCode",showQuantity:"showQuantity",options:"options",product:"product"},decls:1,vars:1,consts:[[3,"formGroup","submit",4,"ngIf"],[3,"formGroup","submit"],["class","quantity",4,"ngIf"],["type","submit",3,"ngClass","disabled",4,"ngIf"],[1,"quantity"],[1,"cx-counter-stock"],[3,"max","control",4,"ngIf"],[1,"info"],[4,"ngIf"],[3,"max","control"],["type","submit",3,"ngClass","disabled"]],template:function(d,w){1&d&&e.YNc(0,N,3,3,"form",0),2&d&&e.Q6J("ngIf",w.productCode)},dependencies:[V.mk,V.O5,g._Y,g.JL,g.sg,T.odZ,V.Ov,u.X$D],encapsulation:2,changeDetection:0}),h})(),A=(()=>{class h{}return h.\u0275fac=function(d){return new(d||h)},h.\u0275mod=e.oAB({type:h}),h.\u0275inj=e.cJS({providers:[(0,u.i51)({cmsComponents:{ProductAddToCartComponent:{component:C,data:{inventoryDisplay:!1}}}})],imports:[V.ez,g.UX,u.LUR,T.Td$]}),h})()},8814:(de,D,l)=>{l.r(D),l.d(D,{EpdVisualizationModule:()=>st});var e=l(4650),g=l(6895),x=l(610),u=l(1742),p=l(9764),P=l(7745),R=l(591),T=l(1086),V=l(6498),B=l(6053),Q=l(1221),G=l(8929),M=l(1709),N=l(5154),C=l(7224),A=l(2198),h=l(7221),m=l(4850),d=l(5778),w=l(2994),E=l(7545);const I=new e.OlP("NodesResponseNormalizer");class Z{}let H=(()=>{class i{constructor(t){this.sceneAdapter=t}getNodes(t,n,o,s,r){return this.sceneAdapter.getNodes(t,n,o,s,r)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(Z))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const ce=new e.OlP("LookupVisualizationsResponseNormalizer");class j{}let K=(()=>{class i{constructor(t){this.visualizationAdapter=t}lookupVisualization(t,n){return this.visualizationAdapter.lookupVisualization(t,n)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(j))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),X=(()=>{class i{constructor(t,n){this.epdVisualizationConfig=t,this.sceneConnector=n,this.productCodesByNodeIdMap$=new R.X(new Map),this.nodeIdsByProductCodeMap$=new R.X(new Map),this.usageId=this.epdVisualizationConfig.epdVisualization.usageIds.productUsageId}populateMapsForScene(t){this.getNodeIdProductCodesForScene(t).pipe((0,C.P)()).subscribe(n=>{this.productCodesByNodeIdMap$.next(this.getProductCodesByNodeIdMap(n)),this.nodeIdsByProductCodeMap$.next(this.getNodeIdsByProductCodeMap(n))})}getNodeIdProductCodesForScene(t){return this.sceneConnector.getNodes(t,void 0,["hotspot",`metadata[${this.usageId.source}].${this.usageId.category}.${this.usageId.keyName}`],[`metadata[${this.usageId.source}].${this.usageId.category}.${this.usageId.keyName}`],"*").pipe((0,m.U)(n=>n.nodes.filter(o=>o.metadata&&o.metadata.length).map(o=>({nodeId:o.sid,productCodes:o.metadata.map(s=>s.value)}))))}getProductCodesByNodeIdMap(t){return t.reduce((n,o)=>(n.set(o.nodeId,o.productCodes),n),new Map)}getNodeIdsByProductCodeMap(t){return t.reduce((n,o)=>(o.productCodes.forEach(s=>{const r=n.get(s);void 0!==r?r.push(o.nodeId):n.set(s,[o.nodeId])}),n),new Map)}distinct(t){const n=[],o=new Set;return t.forEach(s=>{o.has(s)||(o.add(s),n.push(s))}),n}_lookupProductCodes(t,n){return this.distinct(n.flatMap(o=>t.get(o)||[]))}lookupProductCodes(t){return this.productCodesByNodeIdMap$.pipe((0,C.P)(),(0,m.U)(n=>this._lookupProductCodes(n,t)))}syncLookupProductCodes(t){return this._lookupProductCodes(this.productCodesByNodeIdMap$.getValue(),t)}_lookupNodeIds(t,n){return this.distinct(n.flatMap(o=>t.get(o)||[]))}lookupNodeIds(t){return this.nodeIdsByProductCodeMap$.pipe((0,m.U)(n=>this._lookupNodeIds(n,t)))}syncLookupNodeIds(t){return this._lookupNodeIds(this.nodeIdsByProductCodeMap$.getValue(),t)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(P._v),e.LFG(H))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),ee=(()=>{class i{constructor(t,n){this.epdVisualizationConfig=t,this.visualizationConnector=n}findMatchingVisualizations(t){const o=this.epdVisualizationConfig.epdVisualization.usageIds,s=o.productUsageId;return this.visualizationConnector.lookupVisualization({name:s.name,keys:[{name:s.keyName,value:t}]},o.folderUsageId).pipe((0,m.U)(v=>v.visualizations.filter(f=>f.contentType===P.zc.Model3D||f.contentType===P.zc.Drawing2D)))}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(P._v),e.LFG(K))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),le=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[H,K,X,ee]}),i})();var k=l(4006),ue=l(2716);const he=["bar"],pe=["handle"];function ge(i,a){if(1&i){const t=e.EpF();e.ynx(0),e._UZ(1,"div",2),e.ALo(2,"cxTranslate"),e.TgZ(3,"div",3)(4,"span",4),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"cx-epd-visualization-viewer-toolbar-button",9),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.activateHomeView())}),e.ALo(12,"cxTranslate"),e.qZA(),e.TgZ(13,"cx-epd-visualization-viewer-toolbar-button",10),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.navigationMode=o.NavigationMode.Turntable)}),e.ALo(14,"cxTranslate"),e.qZA(),e.TgZ(15,"cx-epd-visualization-viewer-toolbar-button",11),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.navigationMode=o.NavigationMode.Pan)}),e.ALo(16,"cxTranslate"),e.qZA(),e.TgZ(17,"cx-epd-visualization-viewer-toolbar-button",12),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.navigationMode=o.NavigationMode.Zoom)}),e.ALo(18,"cxTranslate"),e.qZA(),e.TgZ(19,"cx-epd-visualization-viewer-toolbar-button",13),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.isolateModeEnabled=!o.isolateModeEnabled)}),e.ALo(20,"cxTranslate"),e.qZA(),e.TgZ(21,"cx-epd-visualization-viewer-toolbar-button",14),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.animationPlaying?o.pauseAnimation():o.playAnimation())}),e.ALo(22,"cxTranslate"),e.qZA(),e.TgZ(23,"cx-epd-visualization-viewer-toolbar-button",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.showAllHotspotsEnabled=!o.showAllHotspotsEnabled)}),e.ALo(24,"cxTranslate"),e.qZA()(),e.TgZ(25,"div",16)(26,"cx-epd-visualization-animation-slider",17),e.NdJ("valueChange",function(o){e.CHM(t);const s=e.oxw();return e.KtG(s.animationPosition=o)})("keydown.enter",function(o){e.CHM(t);const s=e.oxw();return s.animationPlaying?s.pauseAnimation():s.playAnimation(),e.KtG(o.preventDefault())})("keydown.space",function(o){e.CHM(t);const s=e.oxw();return s.animationPlaying?s.pauseAnimation():s.playAnimation(),e.KtG(o.preventDefault())}),e.qZA()()()()(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(1),e.uIk("aria-label",e.lcZ(2,26,"common.loaded")),e.xp6(2),e.Q6J("hidden",!t.viewportReady),e.xp6(2),e.Oqu(e.lcZ(6,28,t.is2D?"epdVisualization.visualViewer.contentType.drawing2D":"epdVisualization.visualViewer.contentType.model3D")),e.xp6(3),e.Q6J("hidden",!t.viewportReady),e.xp6(3),e.s9C("text",e.lcZ(12,30,"epdVisualization.visualViewer.toolbar.homeButton.label")),e.xp6(2),e.s9C("text",e.lcZ(14,32,"epdVisualization.visualViewer.toolbar.rotateButton.label")),e.Q6J("hidden",t.is2D)("checked",t.navigationMode===t.NavigationMode.Turntable),e.xp6(2),e.s9C("text",e.lcZ(16,34,"epdVisualization.visualViewer.toolbar.panButton.label")),e.Q6J("checked",t.navigationMode===t.NavigationMode.Pan),e.xp6(2),e.s9C("text",e.lcZ(18,36,"epdVisualization.visualViewer.toolbar.zoomButton.label")),e.Q6J("checked",t.navigationMode===t.NavigationMode.Zoom),e.xp6(2),e.s9C("text",e.lcZ(20,38,"epdVisualization.visualViewer.toolbar.isolateButton.label")),e.Q6J("hidden",t.is2D)("disabled",!t.isolateModeEnabled&&0===(null==t.selectedProductCodes?null:t.selectedProductCodes.length))("checked",t.isolateModeEnabled),e.xp6(2),e.s9C("iconClass",t.animationPlaying?"fa-pause":"fa-play"),e.s9C("text",e.lcZ(22,40,t.animationPlaying?"epdVisualization.visualViewer.toolbar.pauseButton.label":"epdVisualization.visualViewer.toolbar.playButton.label")),e.Q6J("hidden",t.is2D||t.animationTotalDuration<=0)("disabled",t.isolateModeEnabled),e.xp6(2),e.s9C("text",e.lcZ(24,42,t.showAllHotspotsEnabled?"epdVisualization.visualViewer.toolbar.hotspotsButton.hide":"epdVisualization.visualViewer.toolbar.hotspotsButton.show")),e.Q6J("checked",t.showAllHotspotsEnabled)("hidden",!t.is2D),e.xp6(2),e.Q6J("hidden",t.is2D||t.animationTotalDuration<=0),e.xp6(1),e.Q6J("disabled",t.isolateModeEnabled)("value",t.animationPosition)}}function ve(i,a){1&i&&(e.TgZ(0,"div",18),e._UZ(1,"cx-spinner"),e.qZA())}function fe(i,a){if(1&i&&(e.TgZ(0,"button",3),e._UZ(1,"cx-icon",4),e.qZA()),2&i){const t=e.oxw(2);e.Q6J("disabled",t.quantity<=0||t.quantity>t.maxQuantity)}}function me(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"form",1),e.NdJ("submit",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.addToCart())}),e.YNc(1,fe,2,1,"button",2),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("formGroup",t.addToCartForm),e.xp6(1),e.Q6J("ngIf",t.hasStock)}}function _e(i,a){if(1&i&&(e.TgZ(0,"h3"),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.title)}}function Ce(i,a){1&i&&e.GkF(0)}function we(i,a){1&i&&e.GkF(0)}const Se=function(i,a){return{item:i,active:a}};function Pe(i,a){if(1&i&&(e.TgZ(0,"div",9),e.YNc(1,we,1,0,"ng-container",10),e.qZA()),2&i){const t=a.ngIf,n=e.oxw(3).index,o=e.oxw(2);e.ekj("active",n===o.activeSlideStartIndex),e.xp6(1),e.Q6J("ngTemplateOutlet",o.template)("ngTemplateOutletContext",e.WLB(4,Se,t,n===o.activeSlideStartIndex))}}function Te(i,a){if(1&i&&(e.ynx(0),e.YNc(1,Pe,2,7,"div",8),e.BQk()),2&i){const t=a.$implicit;e.xp6(1),e.Q6J("ngIf",t)}}function ye(i,a){if(1&i&&(e.TgZ(0,"div",7),e.YNc(1,Te,2,1,"ng-container",4),e.ALo(2,"slice"),e.qZA()),2&i){const t=e.oxw().index,n=e.oxw(2);e.ekj("active",t===n.activeSlideStartIndex),e.xp6(1),e.Q6J("ngForOf",e.Dn7(2,3,n.items,t,t+n.itemsPerSlide))}}function be(i,a){if(1&i&&(e.ynx(0),e.YNc(1,ye,3,7,"div",6),e.BQk()),2&i){const t=a.index,n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t%n.itemsPerSlide==0)}}function xe(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.setActiveSlideStartIndex(o.activeSlideStartIndex-o.itemsPerSlide))}),e._UZ(1,"cx-icon",15),e.qZA()}if(2&i){const t=e.oxw(3);e.Q6J("disabled",0===t.activeSlideStartIndex),e.xp6(1),e.Q6J("type",t.previousIcon)}}function Ve(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().index,s=e.oxw(3);return e.KtG(s.setActiveSlideStartIndex(o))}),e._UZ(1,"cx-icon",15),e.qZA()}if(2&i){const t=e.oxw().index,n=e.oxw(3);e.Q6J("disabled",t===n.activeSlideStartIndex),e.xp6(1),e.Q6J("type",n.indicatorIcon)}}function Le(i,a){if(1&i&&(e.ynx(0),e.YNc(1,Ve,2,2,"button",16),e.BQk()),2&i){const t=a.index,n=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t%n.itemsPerSlide==0)}}function Me(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(3);return e.KtG(o.setActiveSlideStartIndex(o.activeSlideStartIndex+o.itemsPerSlide))}),e._UZ(1,"cx-icon",15),e.qZA()}if(2&i){const t=e.oxw(3);e.Q6J("disabled",t.activeSlideStartIndex>t.items.length-t.itemsPerSlide-1),e.xp6(1),e.Q6J("type",t.nextIcon)}}function Ie(i,a){if(1&i&&(e.TgZ(0,"div",11),e.YNc(1,xe,2,2,"button",12),e.YNc(2,Le,2,1,"ng-container",4),e.YNc(3,Me,2,2,"button",13),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.itemsPerSlide<t.items.length),e.xp6(1),e.Q6J("ngForOf",t.items),e.xp6(1),e.Q6J("ngIf",t.itemsPerSlide<t.items.length)}}function ke(i,a){if(1&i&&(e.ynx(0),e.YNc(1,_e,2,1,"h3",0),e.YNc(2,Ce,1,0,"ng-container",1),e.TgZ(3,"div",2)(4,"div",3),e.YNc(5,be,2,1,"ng-container",4),e.qZA()(),e.YNc(6,Ie,4,3,"div",5),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.title),e.xp6(1),e.Q6J("ngTemplateOutlet",t.headerTemplate),e.xp6(3),e.Q6J("ngForOf",t.items),e.xp6(1),e.Q6J("ngIf",!t.hideIndicators&&t.itemsPerSlide<t.items.length)}}function Ae(i,a){1&i&&(e.TgZ(0,"div",3)(1,"div",4),e._uU(2),e.ALo(3,"cxTranslate"),e.qZA(),e.TgZ(4,"div",5),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e._UZ(7,"div",6),e.qZA()),2&i&&(e.xp6(2),e.hij(" ",e.lcZ(3,2,"epdVisualization.visualPicking.visualPickingProductList.description")," "),e.xp6(3),e.hij(" ",e.lcZ(6,4,"epdVisualization.visualPicking.visualPickingProductList.itemPrice")," "))}const Ee=function(i){return{cxRoute:"product",params:i}};function ze(i,a){if(1&i&&(e.TgZ(0,"div",20)(1,"a",21),e.NdJ("keydown.enter",function(n){return n.currentTarget.click()}),e.ALo(2,"cxUrl"),e._uU(3),e.qZA()()),2&i){const t=e.oxw(2).item;e.xp6(1),e.Q6J("routerLink",e.lcZ(2,2,e.VKq(4,Ee,t.product))),e.xp6(2),e.Oqu(t.product.name)}}function Re(i,a){if(1&i&&(e.TgZ(0,"div",22),e._uU(1),e.ALo(2,"cxTranslate"),e.qZA()),2&i){const t=e.oxw(2).item;e.xp6(1),e.AsE(" ",e.lcZ(2,2,"epdVisualization.visualPicking.visualPickingProductList.id")," ",t.product.code," ")}}function De(i,a){if(1&i&&(e.TgZ(0,"div",23),e._uU(1),e.qZA()),2&i){const t=e.oxw(2).item;e.xp6(1),e.hij(" ",null==t.product.price?null:t.product.price.formattedValue," ")}}function Ne(i,a){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",24),e.NdJ("click",function(o){return e.CHM(t),e.MAs(3).addToCart(),e.KtG(o.preventDefault())})("keydown.enter",function(o){return e.CHM(t),e.MAs(3).addToCart(),e.KtG(o.preventDefault())})("keydown.space",function(o){return e.CHM(t),e.MAs(3).addToCart(),e.KtG(o.preventDefault())}),e._UZ(2,"cx-epd-visualization-compact-add-to-cart",25,26),e.qZA(),e.BQk()}if(2&i){const t=e.oxw(2).item;e.xp6(2),e.Q6J("showQuantity",!1)("product",t.product)}}function Oe(i,a){1&i&&e.GkF(0,null,27)}function Fe(i,a){1&i&&(e.ynx(0),e.TgZ(1,"div",28),e._uU(2),e.ALo(3,"cxTranslate"),e.qZA(),e.BQk()),2&i&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"epdVisualization.visualPicking.visualPickingProductList.outOfStock")," "))}function Ue(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",8),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().item,s=e.oxw();return e.KtG(s.selectedProductCodes=[o.product.code])})("keydown.enter",function(){e.CHM(t);const o=e.oxw().item,s=e.oxw();return e.KtG(s.selectedProductCodes=[o.product.code])})("keydown.space",function(){e.CHM(t);const o=e.oxw().item,s=e.oxw();return e.KtG(s.selectedProductCodes=[o.product.code])}),e.TgZ(1,"div",9)(2,"div",10)(3,"div",11),e._UZ(4,"cx-media",12),e.qZA()(),e.TgZ(5,"div",13),e.YNc(6,ze,4,6,"div",14),e.YNc(7,Re,3,4,"div",15),e.qZA()(),e.TgZ(8,"div",16),e.YNc(9,De,2,1,"div",17),e.qZA(),e.TgZ(10,"div",18),e.YNc(11,Ne,4,2,"ng-container",19),e.YNc(12,Oe,2,0,"ng-container",19),e.YNc(13,Fe,4,3,"ng-container",19),e.qZA()()}if(2&i){const t=e.oxw().item;e.ekj("selected",t.selected),e.xp6(3),e.ekj("selected",t.selected),e.xp6(1),e.Q6J("container",null==t.product.images?null:t.product.images.PRIMARY),e.xp6(2),e.Q6J("ngIf",t.product.name),e.xp6(1),e.Q6J("ngIf",t.product.code),e.xp6(2),e.Q6J("ngIf",t.product.price),e.xp6(2),e.Q6J("ngIf",void 0!==t.product.price&&"outOfStock"!==t.product.stock.stockLevelStatus),e.xp6(1),e.Q6J("ngIf",void 0===t.product.price),e.xp6(1),e.Q6J("ngIf",void 0!==t.product.price&&"outOfStock"===t.product.stock.stockLevelStatus)}}function Be(i,a){1&i&&e.YNc(0,Ue,14,11,"div",7),2&i&&e.Q6J("ngIf",a.active)}let te=(()=>{class i{constructor(t,n,o,s){this.elementRef=t,this.windowRef=n,this.renderer=o,this.changeDetectorRef=s,this._initialized=!1,this.initializedChange=new e.vpe,this._value=0,this.valueChange=new e.vpe,this._disabled=!1,this._resizeObserver=void 0,this.eventListenerUtils=new P.qN,this._touchIdentifier=void 0,this.sizeChange=new e.vpe,this.stepDelta=.02,this.pageDelta=.1,this.eventListenerUtils.initialize(this.renderer)}initialize(){this.updateEventBindings(),this.setupResizeObserver(),this.setInitialized()}setInitialized(){this._initialized=!0,this.initializedChange.emit(!0),this.initializedChange.complete()}get initialized(){return this._initialized}set value(t){t=this.clampToRange(t),this._value!==t&&(this._value=t,this.valueChange.emit(this.value))}get value(){return this._value}set disabled(t){this._disabled!==t&&(this._disabled=t,this.updateEventBindings())}get disabled(){return this._disabled}set hidden(t){this._hidden!==t&&(this._hidden=t,this.changeDetectorRef.detectChanges())}get hidden(){return this._hidden}get position(){return this.valueToPosition(this.value)}get rightToLeft(){return"rtl"===this.windowRef.document.documentElement.dir}set barElement(t){this._barElement=t}get barElement(){return this._barElement}set handleElement(t){this._handleElement=t}get handleElement(){return this._handleElement}set resizeObserver(t){this._resizeObserver=t}get resizeObserver(){return this._resizeObserver}set touchIdentifier(t){this._touchIdentifier=t}get touchIdentifier(){return this._touchIdentifier}getClientWidth(t){if(!t||!t.nativeElement)return;const n=this.getClientRect(t);return n.right-n.left}getClientRect(t){return t.nativeElement.getBoundingClientRect()}resizeObserverSupported(){return void 0!==window.ResizeObserver}setupResizeObserver(){this.resizeObserverSupported()&&(this.resizeObserver=new ResizeObserver(this.onResize.bind(this)),this.resizeObserver.observe(this.elementRef.nativeElement))}onResize(){this.changeDetectorRef.detectChanges()}updateEventBindings(){this.disabled?(this.eventListenerUtils.detachAllEventListeners(document),this.eventListenerUtils.detachAllEventListeners(this.barElement.nativeElement),this.eventListenerUtils.detachAllEventListeners(this.handleElement.nativeElement)):(this.eventListenerUtils.attachEventListener(this.handleElement.nativeElement,"mousedown",this.onMouseDown.bind(this)),this.eventListenerUtils.attachEventListener(this.barElement.nativeElement,"mousedown",this.onMouseDownOnBar.bind(this)),this.eventListenerUtils.attachEventListener(this.handleElement.nativeElement,"touchstart",this.onTouchStart.bind(this)),this.eventListenerUtils.attachEventListener(this.barElement.nativeElement,"touchstart",this.onTouchStartOnBar.bind(this)),this.eventListenerUtils.attachEventListener(this.handleElement.nativeElement,"focus",this.onHandleFocus.bind(this)))}get handleWidth(){return this.getClientWidth(this.handleElement)??0}get barWidth(){return this.getClientWidth(this.barElement)??0}get handleMaxPosition(){return this.barWidth-this.handleWidth}valueToPosition(t){let n=this.clampToRange(t);return this.rightToLeft&&(n=1-n),n*this.handleMaxPosition}positionToValue(t){let n=t/this.handleMaxPosition;return this.rightToLeft&&(n=1-n),n}findTouch(t,n){for(let o=0;o<t.length;o++){const s=t.item(o);if(s.identifier===n)return s}}get sliderClientPosition(){return this.getClientRect(this.elementRef).left}onTouchStart(t){t.stopPropagation(),t.preventDefault(),void 0===this.touchIdentifier&&(this.eventListenerUtils.detachEventListeners(document,"touchmove"),this.eventListenerUtils.attachEventListener(document,"touchmove",this.onTouchMove.bind(this)),this.eventListenerUtils.detachEventListeners(document,"touchend"),this.eventListenerUtils.attachEventListener(document,"touchend",this.onTouchEnd.bind(this)),this.touchIdentifier=t.changedTouches[0].identifier)}onTouchStartOnBar(t){this.onTouchStart(t),this.onTouchMove(t)}onMouseDown(t){t.stopPropagation(),t.preventDefault(),this.eventListenerUtils.detachEventListeners(document,"mousemove"),this.eventListenerUtils.attachEventListener(document,"mousemove",this.onMouseMove.bind(this)),this.eventListenerUtils.detachEventListeners(document,"mouseup"),this.eventListenerUtils.attachEventListener(document,"mouseup",this.onMouseUp.bind(this))}onMouseDownOnBar(t){this.onMouseDown(t),this.onMouseMove(t)}onMouseMove(t){this.applyValue(this.positionToValue(t.clientX-this.sliderClientPosition-this.handleWidth/2))}onMouseUp(t){this.eventListenerUtils.detachEventListeners(document,"mousemove"),this.eventListenerUtils.detachEventListeners(document,"mouseup")}onTouchMove(t){if(void 0===this.findTouch(t.changedTouches,this.touchIdentifier))return;const s=this.findTouch(t.touches,this.touchIdentifier).clientX-this.sliderClientPosition-this.handleWidth/2;this.applyValue(this.positionToValue(s))}onTouchEnd(t){void 0!==this.findTouch(t.changedTouches,this.touchIdentifier)&&(this.touchIdentifier=void 0,this.eventListenerUtils.detachEventListeners(document,"touchmove"),this.eventListenerUtils.detachEventListeners(document,"touchend"))}onHandleFocus(){const t=this.handleElement.nativeElement;this.eventListenerUtils.attachEventListener(t,"blur",this.onHandleBlur.bind(this)),this.eventListenerUtils.attachEventListener(t,"keydown",this.onKeyboardEvent.bind(this))}onHandleBlur(){const t=this.handleElement.nativeElement;this.eventListenerUtils.detachEventListeners(t,"blur"),this.eventListenerUtils.detachEventListeners(t,"keydown"),this.eventListenerUtils.detachEventListeners(t,"keyup")}onKeyboardEvent(t){const n=this.getKeyHandler(t.code,this.rightToLeft);void 0!==n&&(t.preventDefault(),this.applyValue(n(this.value)))}getKeyHandler(t,n){const o=b=>b+this.stepDelta,s=b=>b-this.stepDelta,r=b=>b+this.pageDelta,c=b=>b-this.pageDelta,v=n?o:s,f=n?s:o,L=()=>0,J=()=>1;switch(t){case"ArrowUp":return o;case"ArrowDown":return s;case"ArrowLeft":return v;case"ArrowRight":return f;case"PageUp":return r;case"PageDown":return c;case"Home":return L;case"End":return J;default:return}}applyValue(t){t=this.clampToRange(t),this.value!==t&&(this.value=t,this.valueChange.emit(this.value))}clampToRange(t){return Math.min(Math.max(t,0),1)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(e.SBq),e.LFG(u.X9E),e.LFG(e.Qsj),e.LFG(e.sBO))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"}),i})(),Ze=(()=>{class i{constructor(t){this.visualViewerAnimationSliderService=t,this.valueChange=this.visualViewerAnimationSliderService.valueChange,this.initializedChange=this.visualViewerAnimationSliderService.initializedChange}ngAfterViewInit(){this.visualViewerAnimationSliderService.initialize()}set hidden(t){this.visualViewerAnimationSliderService.hidden=t}get hidden(){return this.visualViewerAnimationSliderService.hidden}set value(t){this.visualViewerAnimationSliderService.value=t}get value(){return this.visualViewerAnimationSliderService.value}get position(){return this.visualViewerAnimationSliderService.position}set disabled(t){this.visualViewerAnimationSliderService.disabled=t}get disabled(){return this.visualViewerAnimationSliderService.disabled}get initialized(){return this.visualViewerAnimationSliderService.initialized}set barElement(t){this.visualViewerAnimationSliderService.barElement=t}set handleElement(t){this.visualViewerAnimationSliderService.handleElement=t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(te))},i.\u0275cmp=e.Xpm({type:i,selectors:[["cx-epd-visualization-animation-slider"]],viewQuery:function(t,n){if(1&t&&(e.Gf(he,5),e.Gf(pe,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.barElement=o.first),e.iGM(o=e.CRH())&&(n.handleElement=o.first)}},inputs:{hidden:"hidden",value:"value",disabled:"disabled"},outputs:{valueChange:"valueChange",initializedChange:"initializedChange"},features:[e._Bn([te])],decls:11,vars:20,consts:[[1,"cx-epd-visualization-animation-slider"],[1,"cx-epd-visualization-animation-slider-wrapper"],["cxVisualViewerAnimationSliderElement","",1,"cx-epd-visualization-animation-slider-span","cx-epd-visualization-animation-slider-bar-wrapper"],["bar",""],[1,"cx-epd-visualization-animation-slider-span","cx-epd-visualization-animation-slider-bar"],["cxVisualViewerAnimationSliderHandle","",1,"cx-epd-visualization-animation-slider-span","cx-epd-visualization-animation-slider-pointer"],["handle",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"span",2,3),e._UZ(4,"span",4),e.qZA(),e._UZ(5,"span",5,6),e.ALo(7,"cxNumeric"),e.ALo(8,"cxTranslate"),e.ALo(9,"cxTranslate"),e.ALo(10,"cxNumeric"),e.qZA()()),2&t&&(e.ekj("disabled",!!n.disabled||void 0),e.xp6(5),e.Udp("left",e.xi3(7,10,n.position,"1.0-0")+"px"),e.uIk("role",e.lcZ(8,13,"epdVisualization.visualViewer.toolbar.visualViewerAnimationSlider.role"))("aria-label",e.lcZ(9,15,"epdVisualization.visualViewer.toolbar.visualViewerAnimationSlider.label"))("aria-valuenow",e.xi3(10,17,100*n.value,"1.0-0"))("aria-valuemin","0")("aria-valuemax","100")("tabindex",n.disabled?null:0))},dependencies:[u.X$D,u.bOD],encapsulation:2,changeDetection:0}),i})(),He=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[g.ez,u.LUR]}),i})(),Je=(()=>{class i{constructor(){this.text="",this.disabled=!1,this.checked=!1}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["cx-epd-visualization-viewer-toolbar-button"]],inputs:{text:"text",iconLibraryClass:"iconLibraryClass",iconClass:"iconClass",disabled:"disabled",checked:"checked"},decls:5,vars:9,consts:[["type","submit",1,"btn","btn-link",3,"disabled"],[1,"buttonVBox"],[1,"buttonText"]],template:function(t,n){1&t&&(e.TgZ(0,"button",0)(1,"div",1),e._UZ(2,"cx-icon"),e.TgZ(3,"span",2),e._uU(4),e.qZA()()()),2&t&&(e.ekj("checked",n.checked),e.Q6J("disabled",n.disabled),e.uIk("aria-checked",n.checked),e.xp6(2),e.MT6("",n.iconLibraryClass," ",n.iconClass,""),e.xp6(2),e.Oqu(n.text))},dependencies:[p.oJW],encapsulation:2,changeDetection:0}),i})(),Qe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[g.ez,p.QX1]}),i})();var z=(()=>{return(i=z||(z={}))[i.Turntable=0]="Turntable",i[i.Pan=2]="Pan",i[i.Zoom=3]="Zoom",z;var i})(),O=(()=>{return(i=O||(O={})).Exclusive="exclusive",i.None="none",i.Sticky="sticky",O;var i})(),F=(()=>{return(i=F||(F={})).Annotation="Annotation",i.Background="Background",i.Hotspot="Hotspot",i.Reference="Reference",i.Regular="Regular",i.Symbol="Symbol",F;var i})(),y=(()=>{return(i=y||(y={}))[i.NotStarted=0]="NotStarted",i[i.Loading=1]="Loading",i[i.Loaded=2]="Loaded",i[i.Failed=3]="Failed",y;var i})(),S=(()=>{return(i=S||(S={})).UniqueMatchFound="UniqueMatchFound",i.NoMatchFound="NoMatchFound",i.MultipleMatchesFound="MultipleMatchesFound",i.UnexpectedError="UnexpectedError",S;var i})(),_=(()=>{return(i=_||(_={})).NotStarted="NotStarted",i.Loading="Loading",i.Loaded="Loaded",i.UnexpectedError="UnexpectedError",_;var i})(),U=(()=>{return(i=U||(U={})).All="all",i.Node="node",i.Selected="selected",i.ViewBack="view_back",i.ViewBottom="view_bottom",i.ViewFront="view_front",i.ViewLeft="view_left",i.ViewRight="view_right",i.ViewTop="view_top",i.Visible="visible",U;var i})();let $=(()=>{class i{constructor(t,n,o,s,r,c){if(this.epdVisualizationConfig=t,this._sceneNodeToProductLookupService=n,this.visualizationLookupService=o,this.elementRef=s,this.changeDetectorRef=r,this.windowRef=c,this._selectedNodeIds$=new R.X([]),this._sceneLoadInfo$=new R.X({sceneLoadState:y.NotStarted}),this.DEFAULT_BACKGROUND_TOP_COLOR="--cx-color-inverse",this.DEFAULT_BACKGROUND_BOTTOM_COLOR="--cx-color-inverse",this.DEFAULT_HOTSPOT_SELECTION_HIGHLIGHT_COLOR="rgba(255, 0, 0, 0.6)",this.DEFAULT_SHOW_ALL_HOTSPOTS_COLOR="rgba(255, 255, 0, 0.3)",this.DEFAULT_OUTLINE_COLOR="red",this.DEFAULT_OUTLINE_WIDTH=5,this.DEFAULT_SELECTION_MODE=O.Exclusive,this.DEFAULT_SHOW_ALL_HOTSPOTS_ENABLED=!1,this.DEFAULT_EXCLUDED_OPACITY=.2,this.DEFAULT_ZOOM_TO_MARGIN=.2,this.DEFAULT_FLY_TO_DURATION=1,this._flyToDurationInSeconds=this.DEFAULT_FLY_TO_DURATION,this._zoomToMargin=this.DEFAULT_ZOOM_TO_MARGIN,this.selectedProductCodesChange=new e.vpe,this._excludedOpacity=this.DEFAULT_EXCLUDED_OPACITY,this.animationTimeChange=new e.vpe,this._animationPosition=0,this.animationPositionChange=new e.vpe,this._animationPlaying=!1,this.animationPlayingChange=new e.vpe,this._isolateModeEnabled=!1,this.isolateModeEnabledChange=new e.vpe,this._viewportReady=!1,this.viewportReadyChange=new e.vpe,this.contentChangesFinished=new e.vpe,this.contentLoadFinished=new e.vpe,this.visualizationLoadInfoChange=new e.vpe,!this.windowRef.isBrowser())return;const f=this.bootstrapUi5("ui5bootstrap").pipe((0,M.zg)(this.initializeUi5.bind(this)));this.viewportAdded$=f.pipe((0,M.zg)(this.addViewport.bind(this)),(0,N.d)()),this.executeWhenSceneLoaded(this.setInitialPropertyValues.bind(this))}ngOnDestroy(){this.selectedNodeIdsSubscription?.unsubscribe()}get sceneNodeToProductLookupService(){return this._sceneNodeToProductLookupService}set sceneNodeToProductLookupService(t){this._sceneNodeToProductLookupService=t}get scene(){return this._scene}set scene(t){this._scene=t}get nodeHierarchy(){return this._nodeHierarchy}set nodeHierarchy(t){this._nodeHierarchy=t}get contentConnector(){return this._contentConnector}set contentConnector(t){this._contentConnector=t}get viewport(){return this._viewport}set viewport(t){this._viewport=t}get viewStateManager(){return this._viewStateManager}set viewStateManager(t){this._viewStateManager=t}get animationPlayer(){return this._animationPlayer}set animationPlayer(t){this._animationPlayer=t}get viewManager(){return this._viewManager}set viewManager(t){this._viewManager=t}get drawerToolbar(){return this._drawerToolbar}set drawerToolbar(t){this._drawerToolbar=t}get sceneId(){return this._sceneId}set sceneId(t){this._sceneId=t}get contentType(){return this._contentType}set contentType(t){this._contentType=t}get initialViewInfo(){return this._initialViewInfo}set initialViewInfo(t){this._initialViewInfo=t}get leafNodeRefs(){return this._leafNodeRefs}set leafNodeRefs(t){this._leafNodeRefs=t}get viewPriorToIsolateViewInfo(){return this._viewPriorToIsolateViewInfo}set viewPriorToIsolateViewInfo(t){this._viewPriorToIsolateViewInfo=t}get viewportAdded$(){return this._viewportAdded$}set viewportAdded$(t){this._viewportAdded$=t}get selectedNodeIds$(){return this._selectedNodeIds$}set selectedNodeIds$(t){this._selectedNodeIds$=t}get sceneLoadInfo$(){return this._sceneLoadInfo$}get flyToDurationInSeconds(){return this._flyToDurationInSeconds}set flyToDurationInSeconds(t){this._flyToDurationInSeconds=t}get zoomToMargin(){return this._zoomToMargin}set zoomToMargin(t){this._zoomToMargin=t}set backgroundTopColor(t){!this.windowRef.isBrowser()||this._backgroundTopColor!==t&&(this._backgroundTopColor=t,this.executeWhenSceneLoaded(()=>{this.viewport.setBackgroundColorTop(this.getCSSColor(t))}))}get backgroundTopColor(){return this._backgroundTopColor}set backgroundBottomColor(t){!this.windowRef.isBrowser()||this._backgroundBottomColor!==t&&(this._backgroundBottomColor=t,this.executeWhenSceneLoaded(()=>{this.viewport.setBackgroundColorBottom(this.getCSSColor(t))}))}get backgroundBottomColor(){return this._backgroundBottomColor}set hotspotSelectionColor(t){!this.windowRef.isBrowser()||this._hotspotSelectionColor!==t&&(this._hotspotSelectionColor=t,this.executeWhenSceneLoaded(()=>{this.viewStateManager.setHighlightColor(this.getCSSColor(t))}))}get hotspotSelectionColor(){return this._hotspotSelectionColor}set showAllHotspotsEnabled(t){!this.windowRef.isBrowser()||this._showAllHotspotsEnabled!==t&&(this._showAllHotspotsEnabled=t,this.executeWhenSceneLoaded(()=>{this.applyInclusionStyle(this._includedProductCodes)}))}get showAllHotspotsEnabled(){return this._showAllHotspotsEnabled}set showAllHotspotsColor(t){!this.windowRef.isBrowser()||this._showAllHotspotsColor!==t&&(this._showAllHotspotsColor=t,this.executeWhenSceneLoaded(()=>{const n=this.getCSSColor(t);this.viewport.setShowAllHotspotsTintColor(n)}))}get showAllHotspotsColor(){return this._showAllHotspotsColor}set outlineColor(t){!this.windowRef.isBrowser()||this._outlineColor!==t&&(this._outlineColor=t,this.executeWhenSceneLoaded(()=>{this.viewStateManager.setOutlineColor(this.getCSSColor(t))}))}get outlineColor(){return this._outlineColor}set outlineWidth(t){!this.windowRef.isBrowser()||this._outlineWidth!==t&&(this._outlineWidth=t,this.executeWhenSceneLoaded(()=>{this.viewStateManager.setOutlineWidth(t)}))}get outlineWidth(){return this._outlineWidth}set selectionMode(t){!this.windowRef.isBrowser()||this._selectionMode!==t&&(this._selectionMode=t,this.executeWhenSceneLoaded(()=>{this.viewport.setSelectionMode(t)}))}get selectionMode(){return this._selectionMode}set selectedProductCodes(t){!this.windowRef.isBrowser()||(this._selectedProductCodes=t,this.sceneNodeToProductLookupService.lookupNodeIds(t).pipe((0,C.P)()).subscribe(n=>{this.selectedNodeIds$.next(n)}))}get selectedProductCodes(){return this._selectedProductCodes}set includedProductCodes(t){!this.windowRef.isBrowser()||(this._includedProductCodes=t,this.executeWhenSceneLoaded(()=>{this.applyInclusionStyle(t)}))}get includedProductCodes(){return this._includedProductCodes}set excludedOpacity(t){!this.windowRef.isBrowser()||(this._excludedOpacity=t)}get excludedOpacity(){return this._excludedOpacity}set animationTime(t){!this.windowRef.isBrowser()||(this._animationTime=t)}get animationTime(){return this._animationTime}get animationTotalDuration(){return this.animationPlayer?this.animationPlayer.getTotalDuration():0}set animationPosition(t){!this.windowRef.isBrowser()||this._animationPosition!==t&&(this._animationPosition=t,this.executeWhenSceneLoaded(()=>{const n=t*this.animationPlayer.getTotalDuration();this.animationPlayerSetTime(n,!1)}))}get animationPosition(){return this._animationPosition}set animationPlaying(t){!this.windowRef.isBrowser()||this._animationPlaying!==t&&(this._animationPlaying=t,this.executeWhenSceneLoaded(()=>{t?(this.animationPosition>=1&&this.animationPlayerSetTime(0,!1),this.animationPlayer.play()):this.animationPlayer.stop(),this.animationPlayingChange.emit(t)}))}get animationPlaying(){return this._animationPlaying}set navigationMode(t){!this.windowRef.isBrowser()||this._navigationMode!==t&&(this._navigationMode=t,this.executeWhenSceneLoaded(()=>{this.drawerToolbar&&this.viewport&&this.drawerToolbar._activateGesture(this.viewport.getImplementation(),t)}))}get navigationMode(){return this._navigationMode}set isolateModeEnabled(t){!this.windowRef.isBrowser()||this._isolateModeEnabled!==t&&this.executeWhenSceneLoaded(()=>{if(this._isolateModeEnabled=t,t){this.viewPriorToIsolateViewInfo=this.viewport.getViewInfo({camera:!0,visibility:!0});const n=[];this.is2D?this.viewStateManager.enumerateSelection(o=>n.push(o)):this.viewStateManager.enumerateOutlinedNodes(o=>n.push(o)),this.isolateNodes(n)}else this.viewport.setViewInfo(this.viewPriorToIsolateViewInfo,this.flyToDurationInSeconds);this.isolateModeEnabledChange.emit(this.isolateModeEnabled)})}get isolateModeEnabled(){return this._isolateModeEnabled}get is2D(){return this._is2D}setIs2D(t){this._is2D=t}get viewportReady(){return this._viewportReady}setViewportReady(t){this._viewportReady!==t&&(this._viewportReady=t,this.viewportReadyChange.emit(t))}activateHomeView(){!this.windowRef.isBrowser()||(this.is2D?this.viewport.zoomTo(U.All,null,this.flyToDurationInSeconds,this.zoomToMargin):this.viewport.setViewInfo(this.initialViewInfo,this.flyToDurationInSeconds),this.isolateModeEnabled&&(this._isolateModeEnabled=!1,this.isolateModeEnabledChange.emit(!1)))}playAnimation(){!this.windowRef.isBrowser()||(this.animationPlaying=!0)}pauseAnimation(){!this.windowRef.isBrowser()||(this.animationPlaying=!1)}setInitialPropertyValues(){void 0===this.backgroundTopColor&&(this.backgroundTopColor=this.DEFAULT_BACKGROUND_TOP_COLOR),void 0===this.backgroundBottomColor&&(this.backgroundBottomColor=this.DEFAULT_BACKGROUND_BOTTOM_COLOR),void 0===this.hotspotSelectionColor&&(this.hotspotSelectionColor=this.DEFAULT_HOTSPOT_SELECTION_HIGHLIGHT_COLOR),void 0===this.showAllHotspotsColor&&(this.showAllHotspotsColor=this.DEFAULT_SHOW_ALL_HOTSPOTS_COLOR),void 0===this.outlineColor&&(this.outlineColor=this.DEFAULT_OUTLINE_COLOR),void 0===this.outlineWidth&&(this.outlineWidth=this.DEFAULT_OUTLINE_WIDTH),void 0===this.selectionMode&&(this.selectionMode=this.DEFAULT_SELECTION_MODE),void 0===this.showAllHotspotsEnabled&&(this.showAllHotspotsEnabled=this.DEFAULT_SHOW_ALL_HOTSPOTS_ENABLED),this.is2D?(void 0===this.navigationMode||this.navigationMode===z.Turntable)&&(this.navigationMode=z.Pan):void 0===this.navigationMode&&(this.navigationMode=z.Turntable),void 0===this.selectedProductCodes&&(this.selectedProductCodes=this.selectedNodeIds$.getValue())}executeWhenSceneLoaded(t){this.sceneLoadInfo$.pipe((0,A.h)(n=>n.sceneLoadState===y.Loaded||n.sceneLoadState===y.Failed),(0,C.P)()).subscribe(n=>{n.sceneLoadState===y.Loaded&&t(n.loadedSceneInfo)})}applyInclusionStyle(t){void 0!==t&&this.sceneNodeToProductLookupService.lookupNodeIds(t).pipe((0,C.P)()).subscribe(n=>{this.is2D?this.applyInclusionStyle2D(n):this.applyInclusionStyle3D(n)})}applyInclusionStyle2D(t){const n=this.persistentIdToNodeRef(t,!0),o=this.nodeHierarchy.getHotspotNodeIds(),s=new Set(o),r=o.filter(c=>this.isTopLevelHotspotNode(c,s));if(this._showAllHotspotsEnabled){const c=new Set(n),v=r.filter(f=>!c.has(f));this.viewport.showHotspots(v,!1,null),this.viewport.showHotspots(n,!0,this.getCSSColor(this._showAllHotspotsColor))}else this.viewport.showHotspots(r,!1,null)}applyInclusionStyle3D(t){const n=this.persistentIdToNodeRef(t,!0);this.leafNodeRefs||(this.leafNodeRefs=this.getAllLeafNodeRefs());const o=n.flatMap(c=>this.getLeafDescendants(c,[])),s=new Set(o),r=this.leafNodeRefs.filter(c=>!s.has(c));this.viewStateManager.setOpacity(r,this.excludedOpacity),o.forEach(c=>this.viewStateManager.setOpacity(c,this.viewStateManager.getRestOpacity(c)))}isTopLevelHotspotNode(t,n){return!this.nodeHierarchy.getAncestors(t).some(o=>n.has(o))}isReferenceNode(t){return this.nodeHierarchy.getNodeContentType(t)===F.Reference}getLeafDescendants(t,n){if(!this.isReferenceNode(t)){const o=this.nodeHierarchy.getChildren(t,!1).filter(s=>!this.isReferenceNode(s));0===o.length?n.push(t):o.forEach(s=>this.getLeafDescendants(s,n))}return n}getAllLeafNodeRefs(){return this.nodeHierarchy.getChildren(void 0).flatMap(t=>this.getLeafDescendants(t,[]))}isolateNodes(t){t=t.slice(0,1),this.viewport.zoomTo(U.Node,t,this.flyToDurationInSeconds,this.zoomToMargin);const o=this.persistentIdToNodeRef(this.viewPriorToIsolateViewInfo.visibility.visible||[],!0);this.viewStateManager.setVisibilityState(o,!1,!0,!1),this.viewStateManager.setVisibilityState(t,!0,!0,!0)}animationPlayerSetTime(t,n){this.animationPlayer.setTime(t,void 0,n)}onViewActivated(){this.initialViewInfo=this.viewport.getViewInfo({camera:!0,visibility:!0})}onTimeChanged(t){let n=!1;const o=t.getParameters().time;this.animationTime!==o&&(this.animationTime=o,this.animationTimeChange.emit(o),n=!0);const s=this.animationTotalDuration?this.animationTime/this.animationTotalDuration:0;this.animationPosition!==s&&(this.animationPosition=s,this.animationPositionChange.emit(s),n=!0),this.animationPlaying&&this.animationPosition>=1&&(this._animationPlaying=!1,this.animationPlayingChange.emit(this._animationPlaying)),n&&this.changeDetectorRef.detectChanges()}setVisualizationLoadInfo(t){this._visualizationLoadInfo=t,this.visualizationLoadInfoChange.emit(t),this.changeDetectorRef.detectChanges()}get visualizationLoadInfo(){return this._visualizationLoadInfo}loadVisualization(t){return this.windowRef.isBrowser()?(this.selectedNodeIdsSubscription?.unsubscribe(),this.viewportAdded$.pipe((0,M.zg)(()=>this.resolveVisualization(t).pipe((0,M.zg)(n=>{if(n.lookupResult===S.UniqueMatchFound){this.sceneNodeToProductLookupService.populateMapsForScene(this.sceneId);let o={...n,loadStatus:_.Loading};return this.setVisualizationLoadInfo(o),this.loadScene(this.sceneId,this.contentType).pipe((0,M.zg)(s=>(s.sceneLoadState===y.Failed?o={...n,loadStatus:_.UnexpectedError,errorMessage:s.errorMessage}:(this.selectedNodeIdsSubscription=this.selectedNodeIds$.subscribe(this.handleSelectedNodeIds.bind(this)),o={...n,loadStatus:_.Loaded}),this.setVisualizationLoadInfo(o),(0,T.of)(o))))}return(0,T.of)(n)}))))):(0,T.of)({lookupResult:S.UnexpectedError,loadStatus:_.UnexpectedError,errorMessage:"Should not call loadVisualization in server side code"})}isUi5BootStrapped(){return!!this.windowRef.nativeWindow&&!!this.windowRef.nativeWindow.sap}getCore(){return sap.ui.getCore()}bootstrapUi5(t){const o=this.epdVisualizationConfig.epdVisualization.ui5;return new V.y(s=>{if(this.isUi5BootStrapped())return s.next(),void s.complete();const r=this.windowRef.document.createElement("script");r.setAttribute("id",t),this.windowRef.document.getElementsByTagName("head")[0].appendChild(r),r.onload=()=>{s.next(),s.complete()},r.onerror=c=>{s.error(c),s.complete()},r.id="sap-ui-bootstrap",r.type="text/javascript",r.setAttribute("data-sap-ui-compatVersion","edge"),r.src=o.bootstrapUrl})}initializeUi5(){return new V.y(t=>{const n=this.getCore();n.attachInit(()=>{const o={async:!0};Promise.all([n.loadLibrary("sap.m",o),n.loadLibrary("sap.ui.layout",o),n.loadLibrary("sap.ui.vk",o),n.loadLibrary("sap.ui.richtexteditor",o)]).then(()=>{t.next(),t.complete()})})})}destroyViewportAssociations(t){const n=this.getCore();if(!n)return;const o=t.getContentConnector();if(o){const r=n.byId(o);r&&r.destroy()}const s=t.getViewStateManager();if(s&&n.byId(s)){const r=n.byId(s);if(r){const c=r.getAnimationPlayer();c&&c.destroy();const v=r.getViewManager();if(v){const f=n.byId(v);f&&f.destroy()}r.destroy()}}}onContentChangesStarted(){this.viewport.detachNodesPicked(this.onNodesPicked)}onContentChangesFinished(t){const n=t.getParameter("content"),o=t.getParameter("failureReason");!!n&&!o&&(this.scene=n,this.nodeHierarchy=this.scene.getDefaultNodeHierarchy(),this.viewport.attachNodesPicked(this.onNodesPicked,this),n.loaders&&n.loaders.forEach(s=>{s&&void 0!==s.attachLoadingFinished&&s.attachLoadingFinished(this.onContentLoadingFinished,this)})),this.contentChangesFinished.emit({content:n,failureReason:o})}onContentLoadingFinished(t){this.contentLoadFinished.emit({})}onNodesPicked(t){this.is2D?this.onNodesPicked2D(t):this.onNodesPicked3D(t)}isNodeIncluded(t){const n=this.nodeRefToPersistentId([t],!0),o=this.sceneNodeToProductLookupService.syncLookupProductCodes(n);return!!o&&o.some(s=>this.includedProductCodes.includes(s))}onNodesPicked2D(t){const n=t.getParameter("picked");if(0===n.length)return;const o=n.filter(r=>r.nodeContentType&&r.nodeContentType===F.Hotspot);if(0===o.length)return;const s=o.filter(r=>this.isNodeIncluded(r));n.splice(0),s.forEach(r=>n.push(r))}onNodesPicked3D(t){const n=t.getParameter("picked");n.splice(0,n.length).forEach(s=>{for(;!this.isNodeIncluded(s)&&(s=s.parent););s&&n.push(s)})}addViewport(){return new V.y(t=>{sap.ui.require(["sap/ui/vk/ViewManager","sap/ui/vk/Viewport","sap/ui/vk/ViewStateManager","sap/ui/vk/AnimationPlayer","sap/ui/vk/ContentConnector","sap/ui/vk/DrawerToolbar"],(n,o,s,r,c,v)=>{const L=this.getCore().getUIArea(this.elementRef.nativeElement);if(L){const J=L.getContent()[0];this.destroyViewportAssociations(J),L.destroyContent()}this.viewport=new o({visible:!1}),this.viewport.placeAt(this.elementRef.nativeElement),this.contentConnector=new c,this.contentConnector.attachContentChangesStarted(this.onContentChangesStarted,this),this.contentConnector.attachContentChangesFinished(this.onContentChangesFinished,this),this.contentConnector.attachContentLoadingFinished(this.onContentLoadingFinished,this),this.viewStateManager=new s({contentConnector:this.contentConnector}),this.viewport.setContentConnector(this.contentConnector),this.viewport.setViewStateManager(this.viewStateManager),this.animationPlayer=new r,this.animationPlayer.setViewStateManager(this.viewStateManager),this.animationPlayer.attachViewActivated(this.onViewActivated,this),this.animationPlayer.attachTimeChanged(this.onTimeChanged,this),this.viewManager=new n({contentConnector:this.contentConnector,animationPlayer:this.animationPlayer}),this.viewStateManager.setViewManager(this.viewManager),this.viewStateManager.attachSelectionChanged(this.onSelectionChanged,this),this.viewStateManager.attachOutliningChanged(this.onOutliningChanged,this),this.drawerToolbar=new v({viewport:this.viewport,visible:!1}),this.viewport.addDependent(this.drawerToolbar),t.next(),t.complete()})})}getCSSPropertyValue(t){const n=document.getElementsByTagName("cx-storefront")[0];return getComputedStyle(n).getPropertyValue(t)}getCSSColor(t){return(this.getCSSPropertyValue(t)||t).trim()}resolveVisualization(t){return this.visualizationLookupService.findMatchingVisualizations(t).pipe((0,M.zg)(n=>{let o;switch(n.length){case 0:o={lookupResult:S.NoMatchFound,loadStatus:_.NotStarted,matches:n};break;case 1:const s=n[0];this.sceneId=s.sceneId,this.contentType=s.contentType,o={lookupResult:S.UniqueMatchFound,loadStatus:_.NotStarted,matches:n,visualization:s};break;default:o={lookupResult:S.MultipleMatchesFound,loadStatus:_.NotStarted,matches:n}}return this.setVisualizationLoadInfo(o),(0,T.of)(o)}),(0,h.K)(()=>{const n={lookupResult:S.UnexpectedError,loadStatus:_.NotStarted};return this.setVisualizationLoadInfo(n),(0,T.of)(n)}))}persistentIdToNodeRef(t,n){const o=this.scene.persistentIdToNodeRef(t);return n?o.filter(s=>!!s):o}nodeRefToPersistentId(t,n){const o=this.scene.nodeRefToPersistentId(t);return n?o.filter(s=>!!s):o}getViewStateManagerImplementation(){return this.viewStateManager.getImplementation()}handleSelectedNodeIds(t){const n=this.persistentIdToNodeRef(t,!0);this.is2D?this.handleSelectedNodes2D(n):this.handleSelectedNodes3D(n),this.isolateModeEnabled&&n.length>0&&this.isolateNodes(n),this.setShouldRenderFrame()}handleSelectedNodes2D(t){const n=[];this.viewStateManager.enumerateSelection(o=>n.push(o)),this.viewStateManager.setSelectionStates([],n,!1,!0),this.viewStateManager.setSelectionStates(t,[],!1,!0)}handleSelectedNodes3D(t){const n=[];this.viewStateManager.enumerateOutlinedNodes(o=>n.push(o)),this.getViewStateManagerImplementation().setOutliningStates([],n,!1,!0),this.getViewStateManagerImplementation().setOutliningStates(t,[],!1,!0)}setShouldRenderFrame(){this.viewport.setShouldRenderFrame()}is2DContentType(t){return t===P.zc.Drawing2D}loadScene(t,n){const s=this.epdVisualizationConfig.epdVisualization.apis;return this.viewportReady&&this.setViewportReady(!1),this.setIs2D(this.is2DContentType(n)),new V.y(r=>{sap.ui.require(["sap/ui/vk/ContentResource"],c=>{this.sceneLoadInfo$.next({sceneLoadState:y.Loading}),this.viewport.setSelectionDisplayMode(this.is2D?"Highlight":"Outline");const f=new c({useSecureConnection:!1,sourceType:this.is2D?"stream2d":"stream",source:`${s.baseUrl}/vis/public/storage/v1`,veid:t});this.contentChangesFinished.pipe((0,C.P)()).subscribe(L=>{const b=L.content?{sceneLoadState:y.Loaded,loadedSceneInfo:{sceneId:t,contentType:n}}:{sceneLoadState:y.Failed,errorMessage:L.failureReason};this.sceneLoadInfo$.next(b),r.next(b),r.complete()}),this.contentLoadFinished.pipe((0,C.P)()).subscribe(()=>{this.sceneLoadInfo$.value.sceneLoadState===y.Loaded&&(this.setViewportReady(!0),this.changeDetectorRef.detectChanges(),this.viewport.setVisible(!0))}),this.contentConnector.addContentResource(f)})})}onSelectionChanged(){const t=[];this.viewStateManager.enumerateSelection(o=>t.push(o));const n=this.nodeRefToPersistentId(t,!0);this.sceneNodeToProductLookupService.lookupProductCodes(n).pipe((0,C.P)()).subscribe(o=>{this.selectedProductCodesChange.emit(o)})}onOutliningChanged(){const t=[];this.viewStateManager.enumerateOutlinedNodes(o=>t.push(o));const n=this.nodeRefToPersistentId(t,!0);this.sceneNodeToProductLookupService.lookupProductCodes(n).pipe((0,C.P)()).subscribe(o=>{this.selectedProductCodesChange.emit(o)})}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(P._v),e.LFG(X),e.LFG(ee),e.LFG(e.SBq),e.LFG(e.sBO),e.LFG(u.X9E))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"}),i})(),ie=(()=>{class i{constructor(t){this.visualViewerService=t,this.selectedProductCodesChange=this.visualViewerService.selectedProductCodesChange,this.animationTimeChange=this.visualViewerService.animationTimeChange,this.animationPositionChange=this.visualViewerService.animationPositionChange,this.animationPlayingChange=this.visualViewerService.animationPlayingChange,this.isolateModeEnabledChange=this.visualViewerService.isolateModeEnabledChange,this.viewportReadyChange=this.visualViewerService.viewportReadyChange,this.SelectionMode=O,this.NavigationMode=z}set backgroundTopColor(t){this.visualViewerService.backgroundTopColor=t}get backgroundTopColor(){return this.visualViewerService.backgroundTopColor}set backgroundBottomColor(t){this.visualViewerService.backgroundBottomColor=t}get backgroundBottomColor(){return this.visualViewerService.backgroundBottomColor}set hotspotSelectionColor(t){this.visualViewerService.hotspotSelectionColor=t}get hotspotSelectionColor(){return this.visualViewerService.hotspotSelectionColor}set showAllHotspotsEnabled(t){this.visualViewerService.showAllHotspotsEnabled=t}get showAllHotspotsEnabled(){return this.visualViewerService.showAllHotspotsEnabled}set showAllHotspotsColor(t){this.visualViewerService.showAllHotspotsColor=t}get showAllHotspotsColor(){return this.visualViewerService.showAllHotspotsColor}set outlineColor(t){this.visualViewerService.outlineColor=t}get outlineColor(){return this.visualViewerService.outlineColor}set outlineWidth(t){this.visualViewerService.outlineWidth=t}get outlineWidth(){return this.visualViewerService.outlineWidth}set selectionMode(t){this.visualViewerService.selectionMode=t}get selectionMode(){return this.visualViewerService.selectionMode}set selectedProductCodes(t){this.visualViewerService.selectedProductCodes=t}get selectedProductCodes(){return this.visualViewerService.selectedProductCodes}set includedProductCodes(t){this.visualViewerService.includedProductCodes=t}get includedProductCodes(){return this.visualViewerService.includedProductCodes}set excludedOpacity(t){this.visualViewerService.excludedOpacity=t}get excludedOpacity(){return this.visualViewerService.excludedOpacity}set animationTime(t){this.visualViewerService.animationTime=t}get animationTime(){return this.visualViewerService.animationTime}get animationTotalDuration(){return this.visualViewerService.animationTotalDuration}set animationPosition(t){this.visualViewerService.animationPosition=t}get animationPosition(){return this.visualViewerService.animationPosition}set animationPlaying(t){this.visualViewerService.animationPlaying=t}get animationPlaying(){return this.visualViewerService.animationPlaying}set navigationMode(t){this.visualViewerService.navigationMode=t}get navigationMode(){return this.visualViewerService.navigationMode}set isolateModeEnabled(t){this.visualViewerService.isolateModeEnabled=t}get isolateModeEnabled(){return this.visualViewerService.isolateModeEnabled}get is2D(){return this.visualViewerService.is2D}get viewportReady(){return this.visualViewerService.viewportReady}activateHomeView(){this.visualViewerService.activateHomeView()}playAnimation(){this.visualViewerService.playAnimation()}pauseAnimation(){this.visualViewerService.pauseAnimation()}loadVisualization(t){return this.visualViewerService.loadVisualization(t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36($))},i.\u0275cmp=e.Xpm({type:i,selectors:[["cx-epd-visualization-viewer"]],inputs:{backgroundTopColor:"backgroundTopColor",backgroundBottomColor:"backgroundBottomColor",hotspotSelectionColor:"hotspotSelectionColor",showAllHotspotsEnabled:"showAllHotspotsEnabled",showAllHotspotsColor:"showAllHotspotsColor",outlineColor:"outlineColor",outlineWidth:"outlineWidth",selectionMode:"selectionMode",selectedProductCodes:"selectedProductCodes",includedProductCodes:"includedProductCodes",excludedOpacity:"excludedOpacity",animationTime:"animationTime",animationPosition:"animationPosition",animationPlaying:"animationPlaying",navigationMode:"navigationMode",isolateModeEnabled:"isolateModeEnabled"},outputs:{selectedProductCodesChange:"selectedProductCodesChange",animationTimeChange:"animationTimeChange",animationPositionChange:"animationPositionChange",animationPlayingChange:"animationPlayingChange",isolateModeEnabledChange:"isolateModeEnabledChange",viewportReadyChange:"viewportReadyChange"},features:[e._Bn([$])],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loading",""],["role","status"],[1,"content-type-symbol",3,"hidden"],[1,"content-type-text"],[1,"bottom","overlay"],[1,"toolbar",3,"hidden"],[1,"toolbarHBox"],[1,"toolbarButtonsHBox"],["iconLibraryClass","fas","iconClass","fa-home",1,"homeButton",3,"text","click"],["iconLibraryClass","fas","iconClass","fa-sync-alt",1,"turntableButton","toolbarItem",3,"text","hidden","checked","click"],["iconLibraryClass","fas","iconClass","fa-arrows-alt",1,"panButton","toolbarItem",3,"text","checked","click"],["iconLibraryClass","fas","iconClass","fa-search",1,"zoomButton","toolbarItem",3,"text","checked","click"],["iconLibraryClass","fas","iconClass","fa-compress",1,"isolateButton","toolbarItem",3,"hidden","disabled","text","checked","click"],["iconLibraryClass","fas",1,"playPauseButton","toolbarItem",3,"iconClass","text","hidden","disabled","click"],["iconLibraryClass","fas","iconClass","fa-highlighter",1,"showAllHotpotsButton","toolbarItem",3,"text","checked","hidden","click"],[3,"hidden"],[3,"disabled","value","valueChange","keydown.enter","keydown.space"],[1,"cx-spinner"]],template:function(t,n){if(1&t&&(e.YNc(0,ge,27,44,"ng-container",0),e.YNc(1,ve,2,0,"ng-template",null,1,e.W1O)),2&t){const o=e.MAs(2);e.Q6J("ngIf",n.viewportReady)("ngIfElse",o)}},dependencies:[g.O5,Je,Ze,p.ORR,u.X$D],encapsulation:2,changeDetection:0}),i})(),ne=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[g.ez,x.Bz,u.LUR,Qe,He,p.Fme]}),i})(),W=(()=>{class i{constructor(){this._filter="",this.filter$=new e.vpe,this.fieldsToMatch=["code","name"]}set filter(t){this._filter!==t&&(this._filter=t,this.filter$.emit(t))}get filter(){return this._filter}applyFilter(t,n){return t=t.toLowerCase(),n.filter(s=>{const r=s.target;return this.fieldsToMatch.some(c=>{const v=r[c];return void 0!==v&&-1!==v.toLowerCase().indexOf(t)})})}getFilteredProducts(t){return(0,B.aj)([(0,Q.z)((0,T.of)(""),this.filter$),t]).pipe((0,A.h)(([n,o])=>void 0!==n&&void 0!==o),(0,m.U)(([n,o])=>this.applyFilter(n,o)))}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Ge=(()=>{class i{constructor(t){this.visualPickingProductFilterService=t,this.iconTypes=p.e1G}set filter(t){this.visualPickingProductFilterService.filter=t}get filter(){return this.visualPickingProductFilterService.filter}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(W))},i.\u0275cmp=e.Xpm({type:i,selectors:[["cx-epd-visualization-product-filter"]],inputs:{filter:"filter"},decls:7,vars:14,consts:[[1,"form-group","search-wrapper"],["type","text",1,"form-control",3,"ngModel","placeholder","ngModelChange"],[1,"search",3,"type","hidden"],["tabindex","0",1,"reset",3,"type","hidden","mousedown","keydown.enter"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"input",1),e.NdJ("ngModelChange",function(s){return n.filter=s}),e.ALo(2,"cxTranslate"),e.qZA(),e._UZ(3,"cx-icon",2),e.ALo(4,"cxTranslate"),e.TgZ(5,"cx-icon",3),e.NdJ("mousedown",function(){return n.filter=""})("keydown.enter",function(){return n.filter=""}),e.ALo(6,"cxTranslate"),e.qZA()()),2&t&&(e.xp6(1),e.s9C("placeholder",e.lcZ(2,8,"epdVisualization.visualPicking.visualPickingProductFilter.input.placeholder")),e.Q6J("ngModel",n.filter),e.xp6(2),e.Q6J("type",n.iconTypes.SEARCH)("hidden",n.filter.length>0),e.uIk("aria-label",e.lcZ(4,10,"epdVisualization.visualPicking.visualPickingProductFilter.searchButton.label")),e.xp6(2),e.Q6J("type",n.iconTypes.RESET)("hidden",0===n.filter.length),e.uIk("aria-label",e.lcZ(6,12,"epdVisualization.visualPicking.visualPickingProductFilter.resetButton.label")))},dependencies:[k.Fj,k.JJ,k.On,p.oJW,u.X$D],encapsulation:2,changeDetection:0}),i})(),$e=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[W],imports:[g.ez,k.u5,p.QX1,u.bhT,u.LUR]}),i})(),We=(()=>{class i extends ue.AddToCartComponent{}return i.\u0275fac=function(){let a;return function(n){return(a||(a=e.n5z(i)))(n||i)}}(),i.\u0275cmp=e.Xpm({type:i,selectors:[["cx-epd-visualization-compact-add-to-cart"]],features:[e.qOj],decls:1,vars:1,consts:[[3,"formGroup","submit",4,"ngIf"],[3,"formGroup","submit"],["class","btn btn-sm btn-primary btn-block","type","submit",3,"disabled",4,"ngIf"],["type","submit",1,"btn","btn-sm","btn-primary","btn-block",3,"disabled"],[1,"fa","fa-cart-plus"]],template:function(t,n){1&t&&e.YNc(0,me,2,2,"form",0),2&t&&e.Q6J("ngIf",n.productCode)},dependencies:[g.O5,k._Y,k.JL,k.sg,p.oJW],encapsulation:2,changeDetection:0}),i})(),Ye=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[g.ez,k.UX,x.Bz,p.Fme,p.k$G,u.GSh,u.bhT,p.QX1,u.LUR,p.Td$]}),i})(),qe=(()=>{class i{constructor(t){this.el=t,this.itemsPerSlide=10,this.hideIndicators=!1,this.indicatorIcon=p.e1G.CIRCLE,this.previousIcon=p.e1G.CARET_LEFT,this.nextIcon=p.e1G.CARET_RIGHT,this.activeSlideStartIndex=0,this.activeSlideStartIndexChange=new e.vpe}setActiveSlideStartIndex(t){this.activeSlideStartIndex=t,this.activeSlideStartIndexChange.emit(t)}ngOnInit(){this.headerTemplate?this.template||console.error("No template reference provided to render the items for the `cx-epd-visualization-paged-list`"):console.error("No template reference provided to render the header for the `cx-epd-visualization-paged-list`")}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.SBq))},i.\u0275cmp=e.Xpm({type:i,selectors:[["cx-epd-visualization-paged-list"]],inputs:{title:"title",items:"items",headerTemplate:"headerTemplate",template:"template",itemsPerSlide:"itemsPerSlide",hideIndicators:"hideIndicators",indicatorIcon:"indicatorIcon",previousIcon:"previousIcon",nextIcon:"nextIcon",activeSlideStartIndex:"activeSlideStartIndex"},outputs:{activeSlideStartIndexChange:"activeSlideStartIndexChange"},decls:1,vars:1,consts:[[4,"ngIf"],[4,"ngTemplateOutlet"],[1,"list-panel"],[1,"slides"],[4,"ngFor","ngForOf"],["class","indicators",4,"ngIf"],["class","slide",3,"active",4,"ngIf"],[1,"slide"],["class","item",3,"active",4,"ngIf"],[1,"item"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"indicators"],["class","previous",3,"disabled","click",4,"ngIf"],["class","next",3,"disabled","click",4,"ngIf"],[1,"previous",3,"disabled","click"],[3,"type"],["class","slide-indicator",3,"disabled","click",4,"ngIf"],[1,"slide-indicator",3,"disabled","click"],[1,"next",3,"disabled","click"]],template:function(t,n){1&t&&e.YNc(0,ke,7,4,"ng-container",0),2&t&&e.Q6J("ngIf",(null==n.items?null:n.items.length)>0&&n.itemsPerSlide)},dependencies:[g.sg,g.O5,g.tP,p.oJW,g.OU],encapsulation:2,changeDetection:0}),i})(),je=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[g.ez,x.Bz,p.QX1,p.cOq,u.bhT]}),i})(),Y=(()=>{class i{constructor(t,n,o,s){this.currentProductService=t,this.productReferenceService=n,this.visualPickingProductFilterService=o,this.epdVisualizationConfig=s,this.DEFAULT_ITEMS_PER_SLIDE=7,this.currentProduct$=this.currentProductService.getProduct().pipe((0,A.h)(r=>!!r&&!!r.code),(0,m.U)(r=>r),(0,d.x)((r,c)=>r.code===c.code)),this.productReferences$=new G.xQ,this.activeSlideStartIndex=0,this.itemsPerSlide=this.DEFAULT_ITEMS_PER_SLIDE,this.selectedProductCodesChange=new e.vpe,this.filteredItems$=this.getVisualPickingProductListItems(this.getFilteredProductReferences(),this.selectedProductCodesChange).pipe((0,N.d)())}initialize(){this.getFilteredProductReferencesSubscription=this.getFilteredProductReferences().subscribe(()=>{this.activeSlideStartIndex=0}),this.filteredItemsSubscription=this.filteredItems$.subscribe(t=>{const n=t.findIndex(o=>o.selected);-1!==n&&(this.activeSlideStartIndex=n-n%this.itemsPerSlide)}),this.selectedProductCodes=[],this.productReferencesSubscription=this._getProductReferences().subscribe(this.productReferences$)}ngOnDestroy(){this.getFilteredProductReferencesSubscription?.unsubscribe(),this.filteredItemsSubscription?.unsubscribe(),this.productReferencesSubscription?.unsubscribe()}get productReferenceType(){return this.epdVisualizationConfig.epdVisualization.visualPicking.productReferenceType}getProductReferences(){return this.productReferences$}_getProductReferences(){return this.currentProduct$.pipe((0,w.b)(t=>this.productReferenceService.loadProductReferences(t.code,this.productReferenceType)),(0,E.w)(t=>this.productReferenceService.getProductReferences(t.code,this.productReferenceType)),(0,A.h)(t=>void 0!==t),(0,d.x)((t,n)=>JSON.stringify(t)===JSON.stringify(n)))}getFilteredProductReferences(){return this.visualPickingProductFilterService.getFilteredProducts(this.getProductReferences()).pipe((0,N.d)())}set selectedProductCodes(t){this._selectedProductCodes=t,this.selectedProductCodesChange.next(t)}get selectedProductCodes(){return this._selectedProductCodes}getVisualPickingProductListItems(t,n){return(0,B.aj)([t,n]).pipe((0,A.h)(([o,s])=>!!o&&!!s),(0,m.U)(([o,s])=>o.filter(r=>!!r.target&&!!r.target.code).map(r=>{const c=r.target;return{product:c,selected:-1!==s.indexOf(c.code)}})))}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(p.pHG),e.LFG(u.FxR),e.LFG(W),e.LFG(P._v))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"}),i})(),oe=(()=>{class i{constructor(t){this.visualPickingProductListService=t,this.singleSelection=!0,this.selectedProductCodesChange=this.visualPickingProductListService.selectedProductCodesChange}set selectedProductCodes(t){this.visualPickingProductListService.selectedProductCodes=t}get selectedProductCodes(){return this.visualPickingProductListService.selectedProductCodes}get itemsPerSlide(){return this.visualPickingProductListService.itemsPerSlide}set itemsPerSlide(t){this.visualPickingProductListService.itemsPerSlide=t}get activeSlideStartIndex(){return this.visualPickingProductListService.activeSlideStartIndex}set activeSlideStartIndex(t){this.visualPickingProductListService.activeSlideStartIndex=t}get filteredItems$(){return this.visualPickingProductListService.filteredItems$}ngOnInit(){this.visualPickingProductListService.initialize()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Y))},i.\u0275cmp=e.Xpm({type:i,selectors:[["cx-epd-visualization-product-list"]],inputs:{title:"title",singleSelection:"singleSelection",selectedProductCodes:"selectedProductCodes"},outputs:{selectedProductCodesChange:"selectedProductCodesChange"},features:[e._Bn([Y])],decls:6,vars:8,consts:[[3,"items","title","headerTemplate","template","itemsPerSlide","activeSlideStartIndex","activeSlideStartIndexChange"],["headerTemplate",""],["itemTemplate",""],[1,"cx-item-list-header","row"],[1,"cx-item-list-desc","col-6"],[1,"cx-item-list-price","col-4"],[1,"cx-item-list-total","col-2"],["class","row no-gutters list-item","tabindex","0",3,"selected","click","keydown.enter","keydown.space",4,"ngIf"],["tabindex","0",1,"row","no-gutters","list-item",3,"click","keydown.enter","keydown.space"],[1,"col-6","flex-row"],[1,"thumbnail-container"],[1,"thumbnail"],["format","thumbnail",3,"container"],[1,"flex-column"],["class","cx-name",4,"ngIf"],["class","cx-code",4,"ngIf"],[1,"col-4","flex-column"],["class","cx-price",4,"ngIf"],[1,"cx-add-to-cart","col-2","flex-column"],[4,"ngIf"],[1,"cx-name"],[1,"cx-link",3,"routerLink","keydown.enter"],[1,"cx-code"],[1,"cx-price"],[3,"click","keydown.enter","keydown.space"],[3,"showQuantity","product"],["addToCartComponent",""],["noPrice",""],[1,"cx-out-of-stock"]],template:function(t,n){if(1&t&&(e.TgZ(0,"cx-epd-visualization-paged-list",0),e.NdJ("activeSlideStartIndexChange",function(s){return n.activeSlideStartIndex=s}),e.ALo(1,"async"),e.qZA(),e.YNc(2,Ae,8,6,"ng-template",null,1,e.W1O),e.YNc(4,Be,1,1,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(3),s=e.MAs(5);e.Q6J("items",e.lcZ(1,6,n.filteredItems$))("title",n.title)("headerTemplate",o)("template",s)("itemsPerSlide",n.itemsPerSlide)("activeSlideStartIndex",n.activeSlideStartIndex)}},dependencies:[g.O5,x.yS,p.R7z,qe,We,g.Ov,u.l2T,u.X$D],encapsulation:2,changeDetection:0}),i})(),Ke=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[g.ez,x.Bz,p.Sk1,p.cOq,p.QX1,p.bBg,je,u.bhT,u.LUR,Ye]}),i})(),se=(()=>{class i{constructor(t,n,o,s){this.currentProductService=t,this.globalMessageService=n,this.changeDetectorRef=o,this.windowRef=s,this.showErrorMessages=!0}initialize(t,n){!this.windowRef.isBrowser()||(this.visualViewerService=t,this.visualPickingProductListService=n,this.visualizationLoadInfoChangeSubscription=this.visualViewerService.visualizationLoadInfoChange.subscribe(this.handleLoadVisualizationInfoChange.bind(this)),this.getFilteredProductReferencesSubscription=this.visualPickingProductListService.getFilteredProductReferences().subscribe(o=>{const s=o.map(r=>r.target.code);this.visualViewerService.includedProductCodes=s}),this.getProductReferencesSubscription=this.visualPickingProductListService.getProductReferences().subscribe(o=>{this.setProductReferences(o),o.length>0&&this.visualPickingProductListService.currentProduct$.pipe((0,C.P)()).subscribe(s=>{this.visualViewerService.loadVisualization(s.code).pipe((0,C.P)()).subscribe()})}))}ngOnDestroy(){!this.windowRef.isBrowser()||(this.visualizationLoadInfoChangeSubscription?.unsubscribe(),this.getProductReferencesSubscription?.unsubscribe(),this.getFilteredProductReferencesSubscription?.unsubscribe())}get productReferences(){return this._productReferences}setProductReferences(t){this._productReferences=t,this.changeDetectorRef.markForCheck()}get visualizationLoadStatus(){return this.visualViewerService.visualizationLoadInfo?.loadStatus??_.NotStarted}get hideNoProductReferencesText(){return!this.windowRef.isBrowser()||void 0===this.productReferences||this.productReferences.length>0}get hideProductList(){return!this.windowRef.isBrowser()||void 0===this.productReferences||0===this.productReferences.length}get hideViewport(){return!this.windowRef.isBrowser()||void 0===this.productReferences||0===this.productReferences.length||!(this.visualizationLoadStatus===_.Loading||this.visualizationLoadStatus===_.Loaded)}showErrorMessage(t){this.showErrorMessages&&this.globalMessageService.add(t,u.xUg.MSG_TYPE_ERROR)}handleLoadVisualizationInfoChange(t){switch(t.lookupResult){case S.UniqueMatchFound:switch(t.loadStatus){case _.Loading:break;case _.UnexpectedError:this.showErrorMessage({key:"epdVisualization.errors.visualLoad.unexpectedLoadError"})}break;case S.NoMatchFound:break;case S.MultipleMatchesFound:this.showErrorMessage({key:"epdVisualization.errors.visualLoad.multipleMatchingVisualsFound"});break;case S.UnexpectedError:this.showErrorMessage({key:"epdVisualization.errors.visualLoad.unexpectedLoadError"})}this.changeDetectorRef.detectChanges()}get visualViewerService(){return this._visualViewerService}set visualViewerService(t){!this.windowRef.isBrowser()||(this._visualViewerService=t)}get visualPickingProductListService(){return this._visualPickingProductListService}set visualPickingProductListService(t){!this.windowRef.isBrowser()||(this._visualPickingProductListService=t)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(p.pHG),e.LFG(u.IWp),e.LFG(e.sBO),e.LFG(u.X9E))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"}),i})(),Xe=(()=>{class i{constructor(t){this.visualPickingTabService=t,this.selectedProductCodes=[]}ngAfterViewInit(){this.visualPickingTabService.initialize(this.visualViewerService,this.visualPickingProductListService)}get hideNoProductReferencesIndicator(){return this.visualPickingTabService.hideNoProductReferencesText}get hideProductList(){return this.visualPickingTabService.hideProductList}get hideViewport(){return this.visualPickingTabService.hideViewport}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(se))},i.\u0275cmp=e.Xpm({type:i,selectors:[["cx-epd-visualization-visual-picking-tab"]],viewQuery:function(t,n){if(1&t&&(e.Gf(ie,5,$),e.Gf(oe,5,Y)),2&t){let o;e.iGM(o=e.CRH())&&(n.visualViewerService=o.first),e.iGM(o=e.CRH())&&(n.visualPickingProductListService=o.first)}},features:[e._Bn([se])],decls:9,vars:14,consts:[[1,"no-product-references",3,"hidden"],[3,"selectedProductCodes","hidden","selectedProductCodesChange"],[1,"visual-picking-product-list-container",3,"hidden"],[3,"selectedProductCodes","selectedProductCodesChange"]],template:function(t,n){1&t&&(e.TgZ(0,"div")(1,"div",0)(2,"span"),e._uU(3),e.ALo(4,"cxTranslate"),e.qZA()(),e.TgZ(5,"cx-epd-visualization-viewer",1),e.NdJ("selectedProductCodesChange",function(s){return n.selectedProductCodes=s}),e.qZA(),e.TgZ(6,"div",2),e._UZ(7,"cx-epd-visualization-product-filter"),e.TgZ(8,"cx-epd-visualization-product-list",3),e.NdJ("selectedProductCodesChange",function(s){return n.selectedProductCodes=s}),e.qZA()()()),2&t&&(e.ekj("container-fluid",!n.hideViewport)("container",n.hideViewport),e.xp6(1),e.Q6J("hidden",n.hideNoProductReferencesIndicator),e.xp6(2),e.Oqu(e.lcZ(4,12,"epdVisualization.visualPicking.visualPickingTab.noProductReferences")),e.xp6(2),e.Q6J("selectedProductCodes",n.selectedProductCodes)("hidden",n.hideViewport),e.xp6(1),e.ekj("viewportHidden",n.hideViewport),e.Q6J("hidden",n.hideProductList),e.xp6(2),e.Q6J("selectedProductCodes",n.selectedProductCodes))},dependencies:[ie,oe,Ge,u.X$D],encapsulation:2,changeDetection:0}),i})(),et=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[(0,u.i51)({cmsComponents:{VisualPickingTabComponent:{component:Xe}}})],imports:[g.ez,x.Bz,u.LUR,ne,Ke,$e]}),i})(),tt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[et,ne]}),i})();var ae=l(1737),re=l(529);let it=(()=>{class i{constructor(t,n,o){this.http=t,this.epdVisualizationConfig=n,this.converter=o,this.baseUrl=this.getBaseUrl()}getBaseUrl(){return`${this.epdVisualizationConfig.epdVisualization.apis.baseUrl}/vis/public/storage`}getUrl(t,n,o,s,r){const c=[];n&&n.forEach(f=>c.push(`id=${f}`)),o&&c.push(`$expand=${o.join(",")}`),s&&c.push(`$filter=${s.join(",")}`),r&&c.push(`contentType=${r}`);const v=c.length?`?${c.join("&")}`:"";return`${this.baseUrl}/v1/scenes/${t}/nodes${v}`}getNodes(t,n,o,s,r){return this.http.get(this.getUrl(t,n,o,s,r)).pipe((0,h.K)(c=>(0,ae._)((0,u.cxH)(c))),this.converter.pipeable(I))}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(re.eN),e.LFG(P._v),e.LFG(u.IXI))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})(),nt=(()=>{class i{constructor(t,n,o){this.http=t,this.epdVisualizationConfig=n,this.converter=o,this.baseUrl=this.getBaseUrl()}getBaseUrl(){return`${this.epdVisualizationConfig.epdVisualization.apis.baseUrl}/vis/public/visualization`}getUrl(t,n){const o=[`usage=${encodeURIComponent(JSON.stringify(t))}`,`folderUsageId=${encodeURIComponent(JSON.stringify(n))}`];return`${this.baseUrl}/v1/lookup/visualization?${o.join("&")}`}lookupVisualization(t,n){return this.http.get(this.getUrl(t,n)).pipe((0,h.K)(o=>(0,ae._)((0,u.cxH)(o))),this.converter.pipeable(ce))}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(re.eN),e.LFG(P._v),e.LFG(u.IXI))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})(),ot=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[{provide:Z,useClass:it},{provide:j,useClass:nt}]}),i})(),st=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[tt,le,ot]}),i})()}}]);