"use strict";(self.webpackChunkstorefrontapp=self.webpackChunkstorefrontapp||[]).push([[166],{166:(ne,x,m)=>{m.r(x),m.d(x,{ProductImageZoomModule:()=>te});var e=m(4650),u=m(6895),T=m(610),d=m(1742),s=m(9764),p=m(591),f=m(2654),v=m(6787),C=m(6053),Z=m(3753),M=m(1086),l=m(2198),_=m(4850),y=m(7545),h=m(2994),w=m(5778),b=m(5154),P=m(2313);function A(o,c){if(1&o&&e._UZ(0,"cx-carousel",3),2&o){const t=e.oxw().ngIf;e.oxw();const n=e.MAs(3);e.Q6J("items",t)("hideIndicators",!1)("template",n)}}function z(o,c){if(1&o&&(e.ynx(0),e.YNc(1,A,1,3,"cx-carousel",2),e.BQk()),2&o){const t=c.ngIf;e.xp6(1),e.Q6J("ngIf",t.length)}}function D(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"cx-media",4),e.NdJ("focus",function(){const a=e.CHM(t).item,r=e.oxw();return e.KtG(r.openImage(a.container))}),e.ALo(1,"async"),e.qZA()}if(2&o){const t=c.item,n=e.oxw();e.ekj("is-active",e.lcZ(1,3,n.isActive(t.container))),e.Q6J("container",t.container)}}const J=["defaultImage"],R=["zoomContainer"],O=["zoomedImage"];function Q(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){const a=e.CHM(t).ngIf,r=e.oxw(3);return e.KtG(r.openImage(a.container))}),e._UZ(1,"cx-icon",9),e.qZA()}if(2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("type",t.iconType.CARET_LEFT)}}function k(o,c){if(1&o&&e._UZ(0,"cx-media",10,11),2&o){const t=e.oxw(2).ngIf;e.Q6J("container",t)}}function Y(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",12,13)(2,"cx-media",14,15),e.NdJ("mousemove",function(i){e.CHM(t);const a=e.oxw(3);return e.KtG(a.pointerMove(i))})("touchmove",function(i){e.CHM(t);const a=e.oxw(3);return e.KtG(a.touchMove(i))})("touchend",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.clearTouch())}),e.qZA()()}if(2&o){const t=e.oxw(2).ngIf;e.xp6(2),e.Q6J("container",t)}}function B(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){const a=e.CHM(t).ngIf,r=e.oxw(3);return e.KtG(r.openImage(a.container))}),e._UZ(1,"cx-icon",9),e.qZA()}if(2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("type",t.iconType.CARET_RIGHT)}}function G(o,c){if(1&o&&(e.TgZ(0,"div",3)(1,"div",4),e.YNc(2,Q,2,1,"button",5),e.ALo(3,"async"),e.qZA(),e.YNc(4,k,2,1,"cx-media",6),e.YNc(5,Y,4,1,"div",7),e.TgZ(6,"div",4),e.YNc(7,B,2,1,"button",5),e.ALo(8,"async"),e.qZA()()),2&o){const t=c.ngIf,n=e.oxw(2);e.xp6(2),e.Q6J("ngIf",e.lcZ(3,4,n.getPreviousProduct(t))),e.xp6(2),e.Q6J("ngIf",!n.isZoomed),e.xp6(1),e.Q6J("ngIf",n.isZoomed),e.xp6(2),e.Q6J("ngIf",e.lcZ(8,6,n.getNextProduct(t)))}}function $(o,c){if(1&o&&(e.ynx(0),e.YNc(1,G,9,8,"div",2),e.ALo(2,"async"),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,t.thumbnails$))}}const L=["expandButton"];function N(o,c){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"cx-media",2),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.triggerZoom(!0))}),e.qZA(),e.TgZ(2,"cx-product-image-zoom-trigger",3),e.NdJ("dialogClose",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.triggerZoom(!1))}),e.qZA(),e.BQk()}if(2&o){const t=c.ngIf,n=e.oxw();e.xp6(1),e.Q6J("container",t),e.xp6(1),e.Q6J("expandImage",n.expandImage.value)("galleryIndex",n.selectedIndex)}}const E=function(o){return{product:o}};function H(o,c){if(1&o&&(e._UZ(0,"cx-carousel",5),e.ALo(1,"cxTranslate")),2&o){const t=e.oxw().ngIf,n=e.oxw().ngIf;e.oxw();const i=e.MAs(5);e.Q6J("items",n)("hideIndicators",!1)("template",i),e.uIk("aria-label",e.xi3(1,4,"carousel.carouselForProduct",e.VKq(7,E,t.name)))}}function S(o,c){if(1&o&&(e.ynx(0),e.YNc(1,H,2,9,"cx-carousel",4),e.BQk()),2&o){const t=e.oxw().ngIf;e.xp6(1),e.Q6J("ngIf",t.length)}}function X(o,c){if(1&o&&(e.ynx(0),e.YNc(1,S,2,1,"ng-container",0),e.ALo(2,"async"),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,t.product$))}}function F(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"cx-media",6),e.NdJ("focus",function(){const a=e.CHM(t).item,r=e.oxw();return e.KtG(r.openImage(a.container))}),e.ALo(1,"async"),e.qZA()}if(2&o){const t=c.item,n=e.oxw();e.ekj("is-active",e.lcZ(1,3,n.isActive(t.container))),e.Q6J("container",t.container)}}let U=(()=>{class o{constructor(){this.mainMediaContainer=new p.X({}),this.productImage=new e.vpe,this.subscription=new f.w}ngOnInit(){this.subscription.add(this.activeThumb.subscribe(t=>{this.mainMediaContainer.next(t)}))}openImage(t){this.mainMediaContainer.next(t),"number"==typeof t.zoom?.galleryIndex&&this.productImage.emit({image:t,index:t.zoom.galleryIndex})}isActive(t){return this.mainMediaContainer.asObservable().pipe((0,l.h)(d.jWE),(0,_.U)(n=>n.zoom?.url&&t.zoom?.url&&n.zoom.url===t.zoom.url))}ngOnDestroy(){this.subscription.unsubscribe()}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["cx-product-image-zoom-thumbnails"]],inputs:{thumbs$:"thumbs$",activeThumb:"activeThumb"},outputs:{productImage:"productImage"},decls:4,vars:3,consts:[[4,"ngIf"],["thumb",""],["class","thumbs","itemWidth","70px",3,"items","hideIndicators","template",4,"ngIf"],["itemWidth","70px",1,"thumbs",3,"items","hideIndicators","template"],["tabindex","0",3,"container","focus"]],template:function(t,n){1&t&&(e.YNc(0,z,2,1,"ng-container",0),e.ALo(1,"async"),e.YNc(2,D,2,5,"ng-template",null,1,e.W1O)),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.thumbs$))},dependencies:[s.Fy4,u.O5,s.R7z,u.Ov],encapsulation:2,changeDetection:0}),o})(),V=(()=>{class o{constructor(t,n,i,a){this.currentProductService=t,this.renderer=n,this.cdRef=i,this.breakpointService=a,this.iconType=s.e1G,this.mainMediaContainer=new p.X(null),this.defaultImageReady=new p.X(!1),this.zoomReady=new p.X(!1),this.subscription=new f.w,this.mainMediaContainer$=this.mainMediaContainer.asObservable(),this.defaultImageReady$=this.defaultImageReady.asObservable(),this.zoomReady$=this.zoomReady.asObservable(),this.activeThumb=new e.vpe,this.defaultImageClickHandler$=this.defaultImageReady$.pipe((0,l.h)(Boolean),(0,y.w)(r=>(0,v.T)(...this.clickOrDoubleClick(this.defaultImage)).pipe((0,h.b)(()=>this.zoom())))),this.zoomImageClickHandler$=this.zoomReady$.pipe((0,l.h)(Boolean),(0,y.w)(r=>(0,v.T)(...this.clickOrDoubleClick(this.zoomImage)).pipe((0,h.b)(()=>this.zoom())))),this.startCoords=null,this.left=0,this.top=0,this.isZoomed=!1,this.product$=this.currentProductService.getProduct().pipe((0,l.h)(d.jWE),(0,w.x)(),(0,h.b)(r=>{if(this.galleryIndex){const g=Array.isArray(r.images?.GALLERY)?r.images?.GALLERY.find(I=>I.zoom?.galleryIndex===this.galleryIndex):r.images?.GALLERY;this.mainMediaContainer.next(g||null)}else this.mainMediaContainer.next(r.images?.PRIMARY?r.images.PRIMARY:{})}),(0,b.d)(1)),this.thumbnails$=this.product$.pipe((0,_.U)(r=>this.createThumbs(r)),(0,b.d)(1)),this.mainImage$=(0,C.aj)([this.product$,this.mainMediaContainer$]).pipe((0,_.U)(([,r])=>r))}get defaultImage(){return this._defaultImage}set defaultImage(t){t&&(this._defaultImage=t,this.defaultImageReady.next(!0))}get zoomImage(){return this._zoomImage}set zoomImage(t){t&&(this._zoomImage=t,this.zoomReady.next(!0))}ngOnInit(){this.subscription.add(this.defaultImageClickHandler$.subscribe()),this.subscription.add(this.zoomImageClickHandler$.subscribe())}openImage(t){this.mainMediaContainer.next(t),this.activeThumb.emit(t)}getActive(){return Array.isArray(this.mainMediaContainer.value)?this.mainMediaContainer.value[0].thumbnail?.galleryIndex||0:this.mainMediaContainer?.value?.thumbnail?.galleryIndex||0}getPreviousProduct(t){const n=this.getActive();return 0===n?t[n]:t[n-1]}getNextProduct(t){const n=this.getActive();return n===t.length-1?t[n]:t[n+1]}zoom(){this.isZoomed=!this.isZoomed,this.startCoords=null,this.left=0,this.top=0,this.cdRef.markForCheck()}touchMove(t){const n=t.touches[0]||t.changedTouches[0],i=this.zoomedImage?.nativeElement?.getBoundingClientRect(),a=this.zoomedImage?.nativeElement?.firstChild;this.startCoords||(this.startCoords={x:n.clientX,y:n.clientY}),this.left+=n.clientX-this.startCoords.x,this.top+=n.clientY-this.startCoords.y,this.moveImage(this.left,this.top,i,a),this.startCoords={x:n.clientX,y:n.clientY}}clearTouch(){this.startCoords=null}pointerMove(t){const n=this.zoomedImage.nativeElement.getBoundingClientRect(),i=this.zoomedImage.nativeElement.firstChild,{positionX:a,positionY:r}=this.calculatePointerMovePosition(this.zoomedImage,t.clientX,t.clientY);this.moveImage(a,r,n,i)}changeImage(t){this.mainMediaContainer.next(t.image)}moveImage(t,n,i,a){const{x:r,y:g}=this.handleOutOfBounds(t,n,a,i);a&&(this.renderer.setStyle(a,"left",r+"px"),this.renderer.setStyle(a,"top",g+"px"))}ngOnDestroy(){this.subscription.unsubscribe()}clickOrDoubleClick(t){return[(0,Z.R)(t.nativeElement,"click").pipe((0,P.c)(this.breakpointService.isUp(s.Bst.md)),(0,l.h)(Boolean)),(0,Z.R)(t.nativeElement,"dblclick").pipe((0,P.c)(this.breakpointService.isDown(s.Bst.lg)),(0,l.h)(Boolean))]}createThumbs(t){return!t.images||!t.images.GALLERY||t.images.GALLERY.length<2?[]:t.images.GALLERY.map(i=>(0,M.of)({container:i}))}handleOutOfBounds(t,n,i,a){return n<=60-i?.height&&(n=60-i?.height),n>=a?.height-60&&(n=a?.height-60),t<=-i?.width-a?.width/2+60&&(t=-i?.width-a?.width/2+60),t>=i?.width+a?.width/2-60&&(t=i?.width+a?.width/2-60),{x:t,y:n}}calculatePointerMovePosition(t,n,i){const a=t.nativeElement.getBoundingClientRect();return{positionX:t.nativeElement.clientWidth/2-(n-a.left),positionY:t.nativeElement.clientHeight/2-(i-a.top)}}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(s.pHG),e.Y36(e.Qsj),e.Y36(e.sBO),e.Y36(s.r))},o.\u0275cmp=e.Xpm({type:o,selectors:[["cx-product-image-zoom-view"]],viewQuery:function(t,n){if(1&t&&(e.Gf(J,5,e.SBq),e.Gf(R,5,e.SBq),e.Gf(O,5,e.SBq)),2&t){let i;e.iGM(i=e.CRH())&&(n.defaultImage=i.first),e.iGM(i=e.CRH())&&(n.zoomImage=i.first),e.iGM(i=e.CRH())&&(n.zoomedImage=i.first)}},inputs:{galleryIndex:"galleryIndex"},decls:3,vars:5,consts:[[4,"ngIf"],[3,"thumbs$","activeThumb","productImage"],["class","cx-main-image-group",4,"ngIf"],[1,"cx-main-image-group"],[1,"cx-navigate-image"],["class","btn btn-link",3,"click",4,"ngIf"],["class","cx-default-image-zoom",3,"container",4,"ngIf"],["class","cx-zoom-container",4,"ngIf"],[1,"btn","btn-link",3,"click"],[3,"type"],[1,"cx-default-image-zoom",3,"container"],["defaultImage",""],[1,"cx-zoom-container"],["zoomContainer",""],[1,"cx-image-zoomed",3,"container","mousemove","touchmove","touchend"],["zoomedImage",""]],template:function(t,n){1&t&&(e.YNc(0,$,3,3,"ng-container",0),e.ALo(1,"async"),e.TgZ(2,"cx-product-image-zoom-thumbnails",1),e.NdJ("productImage",function(a){return n.changeImage(a)}),e.qZA()),2&t&&(e.Q6J("ngIf",e.lcZ(1,3,n.mainImage$)),e.xp6(2),e.Q6J("thumbs$",n.thumbnails$)("activeThumb",n.activeThumb))},dependencies:[u.O5,s.oJW,s.R7z,U,u.Ov],encapsulation:2,changeDetection:0}),o})();const W={launch:{PRODUCT_IMAGE_ZOOM:{inline:!0,component:(()=>{class o{constructor(t,n){this.launchDialogService=t,this.el=n,this.iconType=s.e1G,this.focusConfig={trap:!0,block:!0,autofocus:"button",focusOnEscape:!0}}handleClick(t){t.target.tagName===this.el.nativeElement.tagName&&this.close("Cross click")}close(t=""){this.launchDialogService.closeDialog(t)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(s.Q3W),e.Y36(e.SBq))},o.\u0275cmp=e.Xpm({type:o,selectors:[["cx-product-image-zoom-dialog"]],hostBindings:function(t,n){1&t&&e.NdJ("click",function(a){return n.handleClick(a)})},inputs:{galleryIndex:"galleryIndex"},decls:9,vars:6,consts:[[1,"cx-image-zoom-dialog",3,"cxFocus"],[1,"cx-dialog-content"],[1,"cx-dialog-header"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[3,"type"],[1,"cx-dialog-body"],[3,"galleryIndex"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),e.NdJ("click",function(){return n.close("cross click")}),e.ALo(4,"cxTranslate"),e.TgZ(5,"span",4),e._UZ(6,"cx-icon",5),e.qZA()()(),e.TgZ(7,"div",6),e._UZ(8,"cx-product-image-zoom-view",7),e.qZA()()()),2&t&&(e.Q6J("cxFocus",n.focusConfig),e.xp6(3),e.uIk("aria-label",e.lcZ(4,4,"productImageZoomDialog.close")),e.xp6(3),e.Q6J("type",n.iconType.CLOSE),e.xp6(2),e.Q6J("galleryIndex",n.galleryIndex))},dependencies:[s.oJW,s.RRe,V,d.X$D],encapsulation:2,changeDetection:0}),o})(),dialogType:s.Myk.DIALOG}}};let j=(()=>{class o{constructor(t,n){this.launchDialogService=t,this.vcr=n,this.iconType=s.e1G,this.subscriptions=new f.w,this.dialogClose=new e.vpe}set expandImage(t){t&&this.triggerZoom()}triggerZoom(){const t=this.launchDialogService.launch("PRODUCT_IMAGE_ZOOM",this.vcr);t&&this.subscriptions.add((0,C.aj)([t,this.launchDialogService.dialogClose]).pipe((0,h.b)(([n])=>{this.galleryIndex&&(n.instance.galleryIndex=this.galleryIndex)}),(0,l.h)(([,n])=>Boolean(n)),(0,h.b)(([n])=>{this.launchDialogService.clear("PRODUCT_IMAGE_ZOOM"),n?.destroy(),this.dialogClose.emit(),this.expandButton.nativeElement.focus()})).subscribe())}ngOnDestroy(){this.subscriptions.unsubscribe()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(s.Q3W),e.Y36(e.s_b))},o.\u0275cmp=e.Xpm({type:o,selectors:[["cx-product-image-zoom-trigger"]],viewQuery:function(t,n){if(1&t&&e.Gf(L,5),2&t){let i;e.iGM(i=e.CRH())&&(n.expandButton=i.first)}},inputs:{galleryIndex:"galleryIndex",expandImage:"expandImage"},outputs:{dialogClose:"dialogClose"},decls:6,vars:4,consts:[[1,"btn","btn-link","cx-action-link",3,"click"],["expandButton",""],[3,"type"]],template:function(t,n){1&t&&(e.TgZ(0,"button",0,1),e.NdJ("click",function(){return n.triggerZoom()}),e.TgZ(2,"span"),e._uU(3),e.ALo(4,"cxTranslate"),e._UZ(5,"cx-icon",2),e.qZA()()),2&t&&(e.xp6(3),e.hij(" ",e.lcZ(4,2,"productImageZoomTrigger.expand")," "),e.xp6(2),e.Q6J("type",n.iconType.EXPAND_ARROWS))},dependencies:[s.oJW,d.X$D],encapsulation:2,changeDetection:0}),o})(),K=(()=>{class o extends s.xZn{constructor(t){super(t),this.currentProductService=t,this.expandImage=new p.X(!1),this.product$=this.product$}openImage(t){this.mainMediaContainer.next(t),this.selectedIndex=this.mainMediaContainer.value?.zoom?.galleryIndex}triggerZoom(t){this.expandImage.next(t)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(s.pHG))},o.\u0275cmp=e.Xpm({type:o,selectors:[["cx-product-images"]],features:[e.qOj],decls:6,vars:6,consts:[[4,"ngIf"],["thumb",""],[3,"container","click"],[3,"expandImage","galleryIndex","dialogClose"],["role","region","tabindex","-1","class","thumbs","itemWidth","120px",3,"items","hideIndicators","template",4,"ngIf"],["role","region","tabindex","-1","itemWidth","120px",1,"thumbs",3,"items","hideIndicators","template"],["tabindex","0","format","product",3,"container","focus"]],template:function(t,n){1&t&&(e.YNc(0,N,3,3,"ng-container",0),e.ALo(1,"async"),e.YNc(2,X,3,3,"ng-container",0),e.ALo(3,"async"),e.YNc(4,F,2,5,"ng-template",null,1,e.W1O)),2&t&&(e.Q6J("ngIf",e.lcZ(1,2,n.mainImage$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,4,n.thumbs$)))},dependencies:[s.Fy4,u.O5,s.R7z,j,u.Ov,d.X$D],encapsulation:2,changeDetection:0}),o})(),q=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[(0,d.i51)(W),(0,d.i51)({cmsComponents:{ProductImagesComponent:{component:K}}})],imports:[s.bBg,u.ez,d.LUR,s.QX1,s.oPH,s.cOq,s.f5$,T.Bz]}),o})(),ee=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[q]}),o})(),te=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[ee]}),o})()}}]);