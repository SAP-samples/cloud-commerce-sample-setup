"use strict";(self.webpackChunkstorefrontapp=self.webpackChunkstorefrontapp||[]).push([[506],{3506:(ze,k,u)=>{u.r(k),u.d(k,{UserProfileWrapperModule:()=>Qe});var e=u(4650),Z=u(2700),s=u(1742),p=u(6895),g=u(610),l=u(9764),y=u(591),J=u(2654),H=u(6053),O=u(7224),N=u(2986),v=u(2994),A=u(4850),L=u(2198),U=u(7545),f=u(2274),i=u(4006),P=u(7039);function K(t,n){1&t&&(e.TgZ(0,"div")(1,"div",10),e._UZ(2,"cx-spinner"),e.qZA()())}function ee(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"div",11)(1,"p",12),e._uU(2),e.ALo(3,"cxTranslate"),e.qZA()(),e.TgZ(4,"div",13)(5,"button",14),e.NdJ("click",function(){e.CHM(o);const a=e.oxw(2);return e.KtG(a.closeAccount())}),e._uU(6),e.ALo(7,"cxTranslate"),e.qZA(),e.TgZ(8,"button",15),e.NdJ("click",function(){e.CHM(o);const a=e.oxw(2);return e.KtG(a.dismissModal("Cancel"))}),e._uU(9),e.ALo(10,"cxTranslate"),e.qZA()()}2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,3,"closeAccount.confirmAccountClosureMessage")," "),e.xp6(4),e.hij(" ",e.lcZ(7,5,"closeAccount.closeMyAccount")," "),e.xp6(3),e.hij(" ",e.lcZ(10,7,"common.cancel")," "))}function oe(t,n){if(1&t){const o=e.EpF();e.ynx(0),e.TgZ(1,"div",1),e.NdJ("esc",function(){e.CHM(o);const a=e.oxw();return e.KtG(a.dismissModal("Escape click"))}),e.TgZ(2,"div",2)(3,"div",3)(4,"h3",4),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e.TgZ(7,"button",5),e.NdJ("click",function(){e.CHM(o);const a=e.oxw();return e.KtG(a.dismissModal("Cross click"))}),e.ALo(8,"cxTranslate"),e.TgZ(9,"span",6),e._UZ(10,"cx-icon",7),e.qZA()()(),e.YNc(11,K,3,0,"div",8),e.ALo(12,"async"),e.YNc(13,ee,11,9,"ng-template",null,9,e.W1O),e.qZA()(),e.BQk()}if(2&t){const o=e.MAs(14),r=e.oxw();e.xp6(1),e.Q6J("cxFocus",r.focusConfig),e.xp6(4),e.hij(" ",e.lcZ(6,6,"closeAccount.confirmAccountClosure")," "),e.xp6(2),e.uIk("aria-label",e.lcZ(8,8,"common.close")),e.xp6(3),e.Q6J("type",r.iconTypes.CLOSE),e.xp6(1),e.Q6J("ngIf",e.lcZ(12,10,r.isLoading$))("ngIfElse",o)}}const te=["element"],F=function(){return{cxRoute:"home"}};function re(t,n){1&t&&e._UZ(0,"cx-spinner",7)}const G=function(){return{cxRoute:"login"}};function se(t,n){if(1&t&&(e.TgZ(0,"label"),e._UZ(1,"input",24),e.TgZ(2,"span",20),e._uU(3),e.qZA()()),2&t){const o=n.ngIf,r=e.oxw(2);e.xp6(1),e.Q6J("checked",r.isConsentGiven(o.consent)),e.xp6(2),e.hij(" ",o.template," ")}}const $=function(t){return{ariaLabel:t}},ne=function(){return{cxRoute:"termsAndConditions"}};function ie(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"section",2),e._UZ(1,"div",3),e.ALo(2,"cxTranslate"),e.TgZ(3,"div",4)(4,"div",5)(5,"div",6)(6,"form",7),e.NdJ("ngSubmit",function(){e.CHM(o);const a=e.oxw();return e.KtG(a.submitForm())}),e.TgZ(7,"div",8)(8,"label")(9,"span",9),e._uU(10),e.ALo(11,"cxTranslate"),e.qZA(),e._UZ(12,"ng-select",10),e.ALo(13,"async"),e.ALo(14,"cxTranslate"),e.ALo(15,"cxTranslate"),e.qZA()(),e.TgZ(16,"div",8)(17,"label")(18,"span",9),e._uU(19),e.ALo(20,"cxTranslate"),e.qZA(),e._UZ(21,"input",11),e.ALo(22,"cxTranslate"),e._UZ(23,"cx-form-errors",12),e.qZA()(),e.TgZ(24,"div",8)(25,"label")(26,"span",9),e._uU(27),e.ALo(28,"cxTranslate"),e.qZA(),e._UZ(29,"input",13),e.ALo(30,"cxTranslate"),e._UZ(31,"cx-form-errors",12),e.qZA()(),e.TgZ(32,"div",8)(33,"label")(34,"span",9),e._uU(35),e.ALo(36,"cxTranslate"),e.qZA(),e._UZ(37,"input",14),e.ALo(38,"cxTranslate"),e._UZ(39,"cx-form-errors",12),e.qZA()(),e.TgZ(40,"div",8)(41,"label")(42,"span",9),e._uU(43),e.ALo(44,"cxTranslate"),e.qZA(),e._UZ(45,"input",15),e.ALo(46,"cxTranslate"),e.ALo(47,"cxTranslate"),e._UZ(48,"cx-form-errors",12),e.qZA()(),e.TgZ(49,"div",8)(50,"label")(51,"span",9),e._uU(52),e.ALo(53,"cxTranslate"),e.qZA(),e._UZ(54,"input",16),e.ALo(55,"cxTranslate"),e.ALo(56,"cxTranslate"),e._UZ(57,"cx-form-errors",12),e.qZA()(),e.TgZ(58,"div",8)(59,"div",17),e.YNc(60,se,4,2,"label",18),e.ALo(61,"async"),e.qZA()(),e.TgZ(62,"div",8)(63,"div",17)(64,"label"),e._UZ(65,"input",19),e.TgZ(66,"span",20),e._uU(67),e.ALo(68,"cxTranslate"),e.TgZ(69,"a",21),e.ALo(70,"cxUrl"),e._uU(71),e.ALo(72,"cxTranslate"),e.qZA()(),e._UZ(73,"cx-form-errors",12),e.qZA()()(),e.TgZ(74,"button",22),e._uU(75),e.ALo(76,"cxTranslate"),e.qZA(),e.TgZ(77,"a",23),e.ALo(78,"cxUrl"),e._uU(79),e.ALo(80,"cxTranslate"),e.qZA()()()()()()}if(2&t){const o=e.oxw();e.xp6(1),e.uIk("aria-label",e.lcZ(2,33,"common.loaded")),e.xp6(5),e.Q6J("formGroup",o.registerForm),e.xp6(4),e.Oqu(e.lcZ(11,35,"register.title")),e.xp6(2),e.Q6J("clearable",!1)("items",e.lcZ(13,37,o.titles$))("placeholder",e.lcZ(14,39,"register.selectTitle"))("searchable",!1)("cxNgSelectA11y",e.VKq(81,$,e.lcZ(15,41,"register.title"))),e.xp6(7),e.Oqu(e.lcZ(20,43,"register.firstName.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(22,45,"register.firstName.placeholder")),e.xp6(2),e.Q6J("control",o.registerForm.get("firstName")),e.xp6(4),e.Oqu(e.lcZ(28,47,"register.lastName.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(30,49,"register.lastName.placeholder")),e.xp6(2),e.Q6J("control",o.registerForm.get("lastName")),e.xp6(4),e.Oqu(e.lcZ(36,51,"register.emailAddress.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(38,53,"register.emailAddress.placeholder")),e.xp6(2),e.Q6J("control",o.registerForm.get("email")),e.xp6(4),e.Oqu(e.lcZ(44,55,"register.password.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(46,57,"register.password.placeholder")),e.uIk("aria-label",e.lcZ(47,59,"register.password.placeholder")),e.xp6(3),e.Q6J("control",o.registerForm.get("password")),e.xp6(4),e.Oqu(e.lcZ(53,61,"register.confirmPassword.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(55,63,"register.confirmPassword.placeholder")),e.uIk("aria-label",e.lcZ(56,65,"register.confirmPassword.placeholder")),e.xp6(3),e.Q6J("control",o.registerForm.get("passwordconf")),e.xp6(3),e.Q6J("ngIf",e.lcZ(61,67,o.anonymousConsent$)),e.xp6(7),e.hij(" ",e.lcZ(68,69,"register.confirmThatRead")," "),e.xp6(2),e.Q6J("routerLink",e.lcZ(70,71,e.DdM(83,ne))),e.xp6(2),e.hij(" ",e.lcZ(72,73,"register.termsAndConditions")," "),e.xp6(2),e.Q6J("control",o.registerForm.get("termsandconditions")),e.xp6(2),e.hij(" ",e.lcZ(76,75,"register.register")," "),e.xp6(2),e.Q6J("routerLink",e.lcZ(78,77,e.DdM(84,G))),e.xp6(2),e.Oqu(e.lcZ(80,79,"register.signIn"))}}function ae(t,n){1&t&&(e.TgZ(0,"div",25),e._UZ(1,"cx-spinner"),e.qZA())}function ce(t,n){1&t&&e._UZ(0,"cx-spinner",2)}function le(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"form",3),e.NdJ("ngSubmit",function(){const c=e.CHM(o).ngIf,d=e.oxw();return e.KtG(d.onSubmit(c))}),e.TgZ(1,"label")(2,"span",4),e._uU(3),e.ALo(4,"cxTranslate"),e.qZA(),e._UZ(5,"input",5),e.ALo(6,"cxTranslate"),e.ALo(7,"cxTranslate"),e._UZ(8,"cx-form-errors",6),e.qZA(),e.TgZ(9,"label")(10,"span",4),e._uU(11),e.ALo(12,"cxTranslate"),e.qZA(),e._UZ(13,"input",7),e.ALo(14,"cxTranslate"),e.ALo(15,"cxTranslate"),e._UZ(16,"cx-form-errors",6),e.qZA(),e.TgZ(17,"button",8),e._uU(18),e.ALo(19,"cxTranslate"),e.qZA()()}if(2&t){const o=e.oxw();e.Q6J("formGroup",o.form),e.xp6(3),e.Oqu(e.lcZ(4,11,"register.newPassword")),e.xp6(2),e.s9C("placeholder",e.lcZ(6,13,"register.password.placeholder")),e.uIk("aria-label",e.lcZ(7,15,"register.password.placeholder")),e.xp6(3),e.Q6J("control",o.form.get("password")),e.xp6(3),e.Oqu(e.lcZ(12,17,"register.passwordMinRequirements")),e.xp6(2),e.s9C("placeholder",e.lcZ(14,19,"register.confirmPassword.placeholder")),e.uIk("aria-label",e.lcZ(15,21,"register.confirmPassword.placeholder")),e.xp6(3),e.Q6J("control",o.form.get("passwordConfirm")),e.xp6(1),e.Q6J("disabled",o.form.disabled),e.xp6(1),e.hij(" ",e.lcZ(19,23,"register.resetPassword")," ")}}function de(t,n){1&t&&e._UZ(0,"cx-spinner",9)}function ue(t,n){1&t&&e._UZ(0,"cx-spinner",9)}function pe(t,n){1&t&&e._UZ(0,"cx-spinner",12)}function me(t,n){if(1&t&&(e.TgZ(0,"ng-option",4),e._uU(1),e.qZA()),2&t){const o=n.$implicit;e.Q6J("value",o.code),e.xp6(1),e.Oqu(o.name)}}const fe={launch:{CLOSE_ACCOUNT:{inline:!0,component:(()=>{class t{constructor(o,r,a,c,d,m,h){this.authService=o,this.globalMessageService=r,this.routingService=a,this.translationService=c,this.userProfile=d,this.launchDialogService=m,this.el=h,this.iconTypes=l.e1G,this.focusConfig={trap:!0,block:!0,autofocus:"button",focusOnEscape:!0},this.loading$=new y.X(!1)}handleClick(o){o.target.tagName===this.el.nativeElement.tagName&&this.dismissModal("Cross click")}get isLoading$(){return this.loading$.asObservable()}ngOnInit(){this.isLoggedIn$=this.authService.isUserLoggedIn()}onSuccess(){this.dismissModal("Success"),this.translationService.translate("closeAccount.accountClosedSuccessfully").pipe((0,O.P)()).subscribe(o=>{this.globalMessageService.add(o,s.xUg.MSG_TYPE_CONFIRMATION)}),this.routingService.go({cxRoute:"home"})}onError(){this.dismissModal("Error"),this.translationService.translate("closeAccount.accountClosedFailure").pipe((0,O.P)()).subscribe(o=>{this.globalMessageService.add(o,s.xUg.MSG_TYPE_ERROR)})}dismissModal(o){this.launchDialogService.closeDialog(o)}closeAccount(){this.loading$.next(!0),this.userProfile.close().subscribe({next:()=>{this.onSuccess(),this.loading$.next(!1)},error:()=>{this.onError(),this.loading$.next(!1)}})}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(s.e80),e.Y36(s.IWp),e.Y36(s.Znh),e.Y36(s.D7D),e.Y36(f.aT),e.Y36(l.Q3W),e.Y36(e.SBq))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cx-close-account-modal"]],hostBindings:function(o,r){1&o&&e.NdJ("click",function(c){return r.handleClick(c)})},decls:2,vars:3,consts:[[4,"ngIf"],[1,"cx-close-account-modal",3,"cxFocus","esc"],[1,"cx-close-account-modal-container"],[1,"cx-close-account-modal-header","cx-modal-header"],[1,"cx-close-account-modal-title"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[3,"type"],[4,"ngIf","ngIfElse"],["loaded",""],[1,"cx-spinner"],[1,"cx-close-account-modal-body","modal-body"],[1,"cx-confirmation"],[1,"cx-close-account-modal-footer","cx-modal-footer"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-block","btn-secondary",3,"click"]],template:function(o,r){1&o&&(e.YNc(0,oe,15,12,"ng-container",0),e.ALo(1,"async")),2&o&&e.Q6J("ngIf",e.lcZ(1,1,r.isLoggedIn$))},dependencies:[p.O5,l.oJW,l.ORR,l.RRe,p.Ov,s.X$D],encapsulation:2,changeDetection:0}),t})(),dialogType:l.Myk.DIALOG}}};let ge=(()=>{class t{constructor(o,r){this.launchDialogService=o,this.vcr=r}openModal(){this.launchDialogService.openDialog("CLOSE_ACCOUNT",this.element,this.vcr)?.pipe((0,N.q)(1)).subscribe()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(l.Q3W),e.Y36(e.s_b))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cx-close-account"]],viewQuery:function(o,r){if(1&o&&e.Gf(te,5),2&o){let a;e.iGM(a=e.CRH())&&(r.element=a.first)}},decls:12,vars:10,consts:[[1,"col-lg-8","col-md-9"],[1,"row","cx-btn-group"],[1,"col-sm-6"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"click"],["element",""]],template:function(o,r){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),e.ALo(4,"cxUrl"),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA()(),e.TgZ(7,"div",2)(8,"button",4,5),e.NdJ("click",function(){return r.openModal()}),e._uU(10),e.ALo(11,"cxTranslate"),e.qZA()()()()),2&o&&(e.xp6(3),e.Q6J("routerLink",e.lcZ(4,3,e.DdM(9,F))),e.xp6(2),e.Oqu(e.lcZ(6,5,"common.cancel")),e.xp6(5),e.hij(" ",e.lcZ(11,7,"closeAccount.closeMyAccount")," "))},dependencies:[g.yS,s.l2T,s.X$D],encapsulation:2,changeDetection:0}),t})(),he=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{CloseAccountComponent:{component:ge,guards:[s.a1M]}}}),(0,s.i51)(fe)],imports:[p.ez,g.Bz,s.bhT,s.LUR,l.QX1,l.Fme,l.oPH]}),t})(),S=(()=>{class t{constructor(o,r,a,c){this.userPasswordService=o,this.routingService=r,this.authConfigService=a,this.globalMessage=c,this.busy$=new y.X(!1),this.isUpdating$=this.busy$.pipe((0,v.b)(d=>!0===d?this.form.disable():this.form.enable())),this.form=new i.nJ({userEmail:new i.p4("",[i.kI.required,l.kal.emailValidator])})}requestEmail(){this.form.valid?(this.busy$.next(!0),this.userPasswordService.requestForgotPasswordEmail(this.form.value.userEmail).subscribe({next:()=>this.onSuccess(),error:o=>this.onError(o)})):this.form.markAllAsTouched()}onSuccess(){this.globalMessage.add({key:"forgottenPassword.passwordResetEmailSent"},s.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset(),this.redirect()}onError(o){this.busy$.next(!1)}redirect(){this.authConfigService.getOAuthFlow()===s.C8C.ResourceOwnerPasswordFlow&&this.routingService.go({cxRoute:"login"})}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(f.LL),e.LFG(s.Znh),e.LFG(s.dSP),e.LFG(s.IWp))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),Y=(()=>{class t{constructor(o){this.service=o,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$}onSubmit(){this.service.requestEmail()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(S))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cx-forgot-password"]],decls:17,vars:22,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["required","true","type","email","formControlName","userEmail",1,"form-control",3,"placeholder"],[3,"control"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"]],template:function(o,r){1&o&&(e.YNc(0,re,1,0,"cx-spinner",0),e.ALo(1,"async"),e.TgZ(2,"form",1),e.NdJ("ngSubmit",function(){return r.onSubmit()}),e.TgZ(3,"label")(4,"span",2),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e._UZ(7,"input",3),e.ALo(8,"cxTranslate"),e._UZ(9,"cx-form-errors",4),e.qZA(),e.TgZ(10,"a",5),e.ALo(11,"cxUrl"),e._uU(12),e.ALo(13,"cxTranslate"),e.qZA(),e.TgZ(14,"button",6),e._uU(15),e.ALo(16,"cxTranslate"),e.qZA()()),2&o&&(e.Q6J("ngIf",e.lcZ(1,9,r.isUpdating$)),e.xp6(2),e.Q6J("formGroup",r.form),e.xp6(3),e.Oqu(e.lcZ(6,11,"forgottenPassword.emailAddress.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(8,13,"forgottenPassword.emailAddress.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("userEmail")),e.xp6(1),e.Q6J("routerLink",e.lcZ(11,15,e.DdM(21,G))),e.xp6(2),e.Oqu(e.lcZ(13,17,"common.cancel")),e.xp6(2),e.Q6J("disabled",r.form.disabled),e.xp6(1),e.hij(" ",e.lcZ(16,19,"common.submit")," "))},dependencies:[p.O5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.sg,i.u,g.yS,l.Ahv,l.ORR,p.Ov,s.l2T,s.X$D],encapsulation:2,changeDetection:0}),t})(),ve=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{ForgotPasswordComponent:{component:Y,guards:[s.aOY],providers:[{provide:S,useClass:S,deps:[f.LL,s.Znh,s.dSP,s.IWp]}]}}})],imports:[p.ez,i.UX,g.Bz,s.bhT,s.LUR,l.Fym,l.Fme]}),t})(),_=(()=>{class t{constructor(o,r){this.userRegisterFacade=o,this.globalMessageService=r}register(o){return this.userRegisterFacade.register(o)}getTitles(){return this.userRegisterFacade.getTitles()}postRegisterMessage(){this.globalMessageService.add({key:"register.postRegisterMessage"},s.xUg.MSG_TYPE_CONFIRMATION)}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(f.zm),e.LFG(s.IWp))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),Ce=(()=>{class t{constructor(o,r,a,c,d,m,h){this.globalMessageService=o,this.fb=r,this.router=a,this.anonymousConsentsService=c,this.anonymousConsentsConfig=d,this.authConfigService=m,this.registerComponentService=h,this.isLoading$=new y.X(!1),this.subscription=new J.w,this.registerForm=this.fb.group({titleCode:[null],firstName:["",i.kI.required],lastName:["",i.kI.required],email:["",[i.kI.required,l.kal.emailValidator]],password:["",[i.kI.required,l.kal.passwordValidator]],passwordconf:["",i.kI.required],newsletter:new i.p4({value:!1,disabled:this.isConsentRequired()}),termsandconditions:[!1,i.kI.requiredTrue]},{validators:l.kal.passwordsMustMatch("password","passwordconf")})}ngOnInit(){this.titles$=this.registerComponentService.getTitles().pipe((0,A.U)(r=>r.sort(l.ke7))),this.subscription.add(this.globalMessageService.get().pipe((0,L.h)(r=>!!Object.keys(r).length)).subscribe(r=>{const a=r&&r[s.xUg.MSG_TYPE_ERROR];a&&a.some(c=>"This field is required."===c)&&(this.globalMessageService.remove(s.xUg.MSG_TYPE_ERROR),this.globalMessageService.add({key:"register.titleRequired"},s.xUg.MSG_TYPE_ERROR))}));const o=this.anonymousConsentsConfig?.anonymousConsents?.registerConsent??"";this.anonymousConsent$=(0,H.aj)([this.anonymousConsentsService.getConsent(o),this.anonymousConsentsService.getTemplate(o)]).pipe((0,A.U)(([r,a])=>({consent:r,template:a?.description?a.description:""}))),this.subscription.add(this.registerForm.get("newsletter").valueChanges.subscribe(()=>{this.toggleAnonymousConsent()}))}submitForm(){this.registerForm.valid?this.registerUser():this.registerForm.markAllAsTouched()}registerUser(){this.isLoading$.next(!0),this.registerComponentService.register(this.collectDataFromRegisterForm(this.registerForm.value)).subscribe({next:()=>this.onRegisterUserSuccess(),complete:()=>this.isLoading$.next(!1),error:()=>this.isLoading$.next(!1)})}titleSelected(o){this.registerForm.controls.titleCode.setValue(o.code)}collectDataFromRegisterForm(o){const{firstName:r,lastName:a,email:c,password:d,titleCode:m}=o;return{firstName:r,lastName:a,uid:c.toLowerCase(),password:d,titleCode:m}}isConsentGiven(o){return this.anonymousConsentsService.isConsentGiven(o)}isConsentRequired(){const o=this.anonymousConsentsConfig?.anonymousConsents?.requiredConsents,r=this.anonymousConsentsConfig?.anonymousConsents?.registerConsent;return!(!o||!r)&&o.includes(r)}onRegisterUserSuccess(){this.authConfigService.getOAuthFlow()===s.C8C.ResourceOwnerPasswordFlow&&this.router.go("login"),this.registerComponentService.postRegisterMessage()}toggleAnonymousConsent(){const o=this.anonymousConsentsConfig?.anonymousConsents?.registerConsent;o&&(Boolean(this.registerForm.get("newsletter").value)?this.anonymousConsentsService.giveConsent(o):this.anonymousConsentsService.withdrawConsent(o))}ngOnDestroy(){this.subscription.unsubscribe()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(s.IWp),e.Y36(i.QS),e.Y36(s.Znh),e.Y36(s.NpW),e.Y36(s.k0m),e.Y36(s.dSP),e.Y36(_))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cx-register"]],decls:4,vars:4,consts:[["class","cx-page-section container",4,"ngIf","ngIfElse"],["loading",""],[1,"cx-page-section","container"],["role","status"],[1,"row","justify-content-center"],[1,"col-md-6"],[1,"cx-section"],[3,"formGroup","ngSubmit"],[1,"form-group"],[1,"label-content"],["bindLabel","name","bindValue","code","formControlName","titleCode","id","title-select",3,"clearable","items","placeholder","searchable","cxNgSelectA11y"],["required","true","type","text","name","firstname","formControlName","firstName",1,"form-control",3,"placeholder"],[3,"control"],["required","true","type","text","name","lastname","formControlName","lastName",1,"form-control",3,"placeholder"],["required","true","type","email","name","email","formControlName","email",1,"form-control",3,"placeholder"],["required","true","type","password","name","password","formControlName","password","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],["required","true","type","password","name","confirmpassword","formControlName","passwordconf","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[1,"form-check"],[4,"ngIf"],["required","true","type","checkbox","name","termsandconditions","formControlName","termsandconditions"],[1,"form-check-label"],["target","_blank","rel","noopener noreferrer",3,"routerLink"],["type","submit",1,"btn","btn-block","btn-primary"],[1,"cx-login-link","btn-link",3,"routerLink"],["type","checkbox","name","newsletter","formControlName","newsletter",1,"form-check-input",3,"checked"],[1,"cx-spinner"]],template:function(o,r){if(1&o&&(e.YNc(0,ie,81,85,"section",0),e.ALo(1,"async"),e.YNc(2,ae,2,0,"ng-template",null,1,e.W1O)),2&o){const a=e.MAs(3);e.Q6J("ngIf",!e.lcZ(1,2,r.isLoading$))("ngIfElse",a)}},dependencies:[p.O5,i._Y,i.Fj,i.Wl,i.JJ,i.JL,i.Q7,i.Zs,i.sg,i.u,g.yS,l.ORR,l.Ahv,P.w9,l.VnX,l.X84,p.Ov,s.l2T,s.X$D],encapsulation:2}),t})(),xe=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{RegisterCustomerComponent:{component:Ce,guards:[s.aOY],providers:[{provide:_,useClass:_,deps:[f.zm,s.IWp]}]}}})],imports:[p.ez,i.UX,g.Bz,s.bhT,s.LUR,l.Fme,l.Fym,P.A0,l.LcC,l.Ird]}),t})(),M=(()=>{class t{constructor(o,r,a){this.userPasswordService=o,this.routingService=r,this.globalMessage=a,this.busy$=new y.X(!1),this.isUpdating$=this.busy$.pipe((0,v.b)(c=>!0===c?this.form.disable():this.form.enable())),this.resetToken$=this.routingService.getRouterState().pipe((0,A.U)(c=>c.state.queryParams.token)),this.form=new i.nJ({password:new i.p4("",[i.kI.required,l.kal.passwordValidator]),passwordConfirm:new i.p4("",i.kI.required)},{validators:l.kal.passwordsMustMatch("password","passwordConfirm")})}resetPassword(o){if(!this.form.valid)return void this.form.markAllAsTouched();this.busy$.next(!0);const r=this.form.get("password").value;this.userPasswordService.reset(o,r).subscribe({next:()=>this.onSuccess(),error:a=>this.onError(a)})}onSuccess(){this.globalMessage.add({key:"forgottenPassword.passwordResetSuccess"},s.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset(),this.redirect()}onError(o){this.busy$.next(!1),o instanceof s.YPQ&&(o.details??[]).forEach(r=>{r.message&&this.globalMessage.add({raw:r.message},s.xUg.MSG_TYPE_ERROR)})}redirect(){this.routingService.go({cxRoute:"login"})}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(f.LL),e.LFG(s.Znh),e.LFG(s.IWp))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),we=(()=>{class t{constructor(o){this.service=o,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$,this.token$=this.service.resetToken$}onSubmit(o){this.service.resetPassword(o)}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(M))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cx-reset-password"]],hostAttrs:[1,"user-form"],decls:4,vars:6,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"overlay"],[3,"formGroup","ngSubmit"],[1,"label-content"],["required","true","type","password","formControlName","password","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[3,"control"],["required","true","type","password","formControlName","passwordConfirm","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[1,"btn","btn-block","btn-primary",3,"disabled"]],template:function(o,r){1&o&&(e.YNc(0,ce,1,0,"cx-spinner",0),e.ALo(1,"async"),e.YNc(2,le,20,25,"form",1),e.ALo(3,"async")),2&o&&(e.Q6J("ngIf",e.lcZ(1,2,r.isUpdating$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,4,r.token$)))},dependencies:[p.O5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.sg,i.u,l.Ahv,l.ORR,l.X84,p.Ov,s.X$D],encapsulation:2,changeDetection:0}),t})(),be=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{ResetPasswordComponent:{component:we,guards:[s.aOY],providers:[{provide:M,useClass:M,deps:[f.LL,s.Znh,s.IWp]}]}}})],imports:[p.ez,i.u5,i.UX,g.Bz,s.LUR,l.Fym,l.Fme,l.Ird]}),t})(),R=(()=>{class t{constructor(o,r,a,c,d){this.userEmail=o,this.routingService=r,this.globalMessageService=a,this.authService=c,this.authRedirectService=d,this.busy$=new y.X(!1),this.isUpdating$=this.busy$.pipe((0,v.b)(m=>!0===m?this.form.disable():this.form.enable())),this.form=new i.nJ({email:new i.p4("",[i.kI.required,l.kal.emailValidator]),confirmEmail:new i.p4("",[i.kI.required]),password:new i.p4("",[i.kI.required])},{validators:l.kal.emailsMustMatch("email","confirmEmail")})}save(){if(!this.form.valid)return void this.form.markAllAsTouched();this.busy$.next(!0);const o=this.form.get("confirmEmail")?.value,r=this.form.get("password")?.value;this.userEmail.update(r,o).subscribe({next:()=>this.onSuccess(o),error:a=>this.onError(a)})}onSuccess(o){this.globalMessageService.add({key:"updateEmailForm.emailUpdateSuccess",params:{newUid:o}},s.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset(),this.authRedirectService.setRedirectUrl(this.routingService.getUrl({cxRoute:"home"})),this.authService.coreLogout().then(()=>{this.routingService.go({cxRoute:"login"},{state:{newUid:o}})})}onError(o){this.busy$.next(!1)}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(f.PF),e.LFG(s.Znh),e.LFG(s.IWp),e.LFG(s.e80),e.LFG(s.FUY))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),ye=(()=>{class t{constructor(o){this.service=o,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$}onSubmit(){this.service.save()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(R))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cx-update-email"]],hostAttrs:[1,"user-form"],decls:32,vars:39,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["required","true","type","email","name","email","formControlName","email",1,"form-control",3,"placeholder"],[3,"control"],["required","true","type","email","name","confirmEmail","formControlName","confirmEmail",1,"form-control",3,"placeholder"],["required","true","type","password","name","password","formControlName","password","autocomplete","new-password","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"]],template:function(o,r){1&o&&(e.YNc(0,de,1,0,"cx-spinner",0),e.ALo(1,"async"),e.TgZ(2,"form",1),e.NdJ("ngSubmit",function(){return r.onSubmit()}),e.TgZ(3,"label")(4,"span",2),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e._UZ(7,"input",3),e.ALo(8,"cxTranslate"),e._UZ(9,"cx-form-errors",4),e.qZA(),e.TgZ(10,"label")(11,"span",2),e._uU(12),e.ALo(13,"cxTranslate"),e.qZA(),e._UZ(14,"input",5),e.ALo(15,"cxTranslate"),e._UZ(16,"cx-form-errors",4),e.qZA(),e.TgZ(17,"label")(18,"span",2),e._uU(19),e.ALo(20,"cxTranslate"),e.qZA(),e._UZ(21,"input",6),e.ALo(22,"cxTranslate"),e.ALo(23,"cxTranslate"),e._UZ(24,"cx-form-errors",4),e.qZA(),e.TgZ(25,"a",7),e.ALo(26,"cxUrl"),e._uU(27),e.ALo(28,"cxTranslate"),e.qZA(),e.TgZ(29,"button",8),e._uU(30),e.ALo(31,"cxTranslate"),e.qZA()()),2&o&&(e.Q6J("ngIf",e.lcZ(1,16,r.isUpdating$)),e.xp6(2),e.Q6J("formGroup",r.form),e.xp6(3),e.Oqu(e.lcZ(6,18,"updateEmailForm.newEmailAddress.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(8,20,"updateEmailForm.newEmailAddress.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("email")),e.xp6(3),e.Oqu(e.lcZ(13,22,"updateEmailForm.confirmNewEmailAddress.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(15,24,"updateEmailForm.confirmNewEmailAddress.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("confirmEmail")),e.xp6(3),e.Oqu(e.lcZ(20,26,"updateEmailForm.password.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(22,28,"updateEmailForm.password.placeholder")),e.uIk("aria-label",e.lcZ(23,30,"updateEmailForm.password.placeholder")),e.xp6(3),e.Q6J("control",r.form.get("password")),e.xp6(1),e.Q6J("routerLink",e.lcZ(26,32,e.DdM(38,F))),e.xp6(2),e.hij(" ",e.lcZ(28,34,"common.cancel")," "),e.xp6(2),e.Q6J("disabled",r.form.disabled),e.xp6(1),e.hij(" ",e.lcZ(31,36,"common.save")," "))},dependencies:[p.O5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.sg,i.u,l.ORR,g.yS,l.Ahv,l.X84,p.Ov,s.l2T,s.X$D],encapsulation:2,changeDetection:0}),t})(),Ae=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{UpdateEmailComponent:{component:ye,guards:[s.a1M],providers:[{provide:R,useClass:R,deps:[f.PF,s.Znh,s.IWp,s.e80,s.FUY]}]}}})],imports:[p.ez,i.u5,i.UX,l.Fme,s.bhT,g.Bz,s.LUR,l.Fym,l.Ird]}),t})(),E=(()=>{class t{constructor(o,r,a){this.userPasswordService=o,this.routingService=r,this.globalMessageService=a,this.busy$=new y.X(!1),this.isUpdating$=this.busy$.pipe((0,v.b)(c=>!0===c?this.form.disable():this.form.enable())),this.form=new i.nJ({oldPassword:new i.p4("",i.kI.required),newPassword:new i.p4("",[i.kI.required,l.kal.passwordValidator]),newPasswordConfirm:new i.p4("",i.kI.required)},{validators:l.kal.passwordsMustMatch("newPassword","newPasswordConfirm")})}updatePassword(){if(!this.form.valid)return void this.form.markAllAsTouched();this.busy$.next(!0);const o=this.form.get("oldPassword")?.value,r=this.form.get("newPassword")?.value;this.userPasswordService.update(o,r).subscribe({next:()=>this.onSuccess(),error:a=>this.onError(a)})}onSuccess(){this.globalMessageService.add({key:"updatePasswordForm.passwordUpdateSuccess"},s.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset(),this.routingService.go({cxRoute:"home"})}onError(o){this.busy$.next(!1),this.form.reset()}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(f.LL),e.LFG(s.Znh),e.LFG(s.IWp))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),Ue=(()=>{class t{constructor(o){this.service=o,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$}onSubmit(){this.service.updatePassword()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(E))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cx-update-password"]],hostAttrs:[1,"user-form"],decls:34,vars:45,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["required","true","type","password","name","oldPassword","formControlName","oldPassword","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[3,"control"],["required","true","type","password","name","newPassword","formControlName","newPassword","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],["required","true","type","password","name","newPasswordConfirm","formControlName","newPasswordConfirm","cxPasswordVisibilitySwitch","",1,"form-control",3,"placeholder"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"]],template:function(o,r){1&o&&(e.YNc(0,ue,1,0,"cx-spinner",0),e.ALo(1,"async"),e.TgZ(2,"form",1),e.NdJ("ngSubmit",function(){return r.onSubmit()}),e.TgZ(3,"label")(4,"span",2),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e._UZ(7,"input",3),e.ALo(8,"cxTranslate"),e.ALo(9,"cxTranslate"),e._UZ(10,"cx-form-errors",4),e.qZA(),e.TgZ(11,"label")(12,"span",2),e._uU(13),e.ALo(14,"cxTranslate"),e.qZA(),e._UZ(15,"input",5),e.ALo(16,"cxTranslate"),e.ALo(17,"cxTranslate"),e._UZ(18,"cx-form-errors",4),e.qZA(),e.TgZ(19,"label")(20,"span",2),e._uU(21),e.ALo(22,"cxTranslate"),e.qZA(),e._UZ(23,"input",6),e.ALo(24,"cxTranslate"),e.ALo(25,"cxTranslate"),e._UZ(26,"cx-form-errors",4),e.qZA(),e.TgZ(27,"a",7),e.ALo(28,"cxUrl"),e._uU(29),e.ALo(30,"cxTranslate"),e.qZA(),e.TgZ(31,"button",8),e._uU(32),e.ALo(33,"cxTranslate"),e.qZA()()),2&o&&(e.Q6J("ngIf",e.lcZ(1,18,r.isUpdating$)),e.xp6(2),e.Q6J("formGroup",r.form),e.xp6(3),e.Oqu(e.lcZ(6,20,"updatePasswordForm.oldPassword.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(8,22,"updatePasswordForm.oldPassword.placeholder")),e.uIk("aria-label",e.lcZ(9,24,"updatePasswordForm.oldPassword.placeholder")),e.xp6(3),e.Q6J("control",r.form.get("oldPassword")),e.xp6(3),e.Oqu(e.lcZ(14,26,"updatePasswordForm.newPassword.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(16,28,"updatePasswordForm.newPassword.placeholder")),e.uIk("aria-label",e.lcZ(17,30,"updatePasswordForm.newPassword.placeholder")),e.xp6(3),e.Q6J("control",r.form.get("newPassword")),e.xp6(3),e.Oqu(e.lcZ(22,32,"updatePasswordForm.confirmPassword.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(24,34,"updatePasswordForm.confirmPassword.placeholder")),e.uIk("aria-label",e.lcZ(25,36,"updatePasswordForm.confirmPassword.placeholder")),e.xp6(3),e.Q6J("control",r.form.get("newPasswordConfirm")),e.xp6(1),e.Q6J("routerLink",e.lcZ(28,38,e.DdM(44,F))),e.xp6(2),e.hij(" ",e.lcZ(30,40,"common.cancel")," "),e.xp6(2),e.Q6J("disabled",r.form.disabled),e.xp6(1),e.hij(" ",e.lcZ(33,42,"common.save")," "))},dependencies:[p.O5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.sg,i.u,l.ORR,l.Ahv,g.yS,l.X84,p.Ov,s.X$D,s.l2T],encapsulation:2,changeDetection:0}),t})(),Pe=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{UpdatePasswordComponent:{component:Ue,guards:[s.a1M],providers:[{provide:E,useClass:E,deps:[f.LL,s.Znh,s.IWp]}]}}})],imports:[p.ez,i.u5,i.UX,l.Fme,s.LUR,l.Fym,s.bhT,g.Bz,l.Ird]}),t})(),I=(()=>{class t{constructor(o,r){this.userProfile=o,this.globalMessageService=r,this.user$=this.userProfile.get().pipe((0,L.h)(a=>Boolean(a))),this.busy$=new y.X(!1),this.isUpdating$=this.user$.pipe((0,v.b)(a=>this.form.patchValue(a)),(0,U.w)(a=>this.busy$),(0,v.b)(a=>!0===a?this.form.disable():this.form.enable())),this.titles$=this.userProfile.getTitles(),this.form=new i.nJ({customerId:new i.p4(""),titleCode:new i.p4(""),firstName:new i.p4("",i.kI.required),lastName:new i.p4("",i.kI.required)})}updateProfile(){this.form.valid?(this.busy$.next(!0),this.userProfile.update(this.form.value).subscribe({next:()=>this.onSuccess(),error:o=>this.onError(o)})):this.form.markAllAsTouched()}onSuccess(){this.globalMessageService.add({key:"updateProfileForm.profileUpdateSuccess"},s.xUg.MSG_TYPE_CONFIRMATION),this.busy$.next(!1),this.form.reset()}onError(o){this.busy$.next(!1)}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(f.aT),e.LFG(s.IWp))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),Ze=(()=>{class t{constructor(o){this.service=o,this.form=this.service.form,this.isUpdating$=this.service.isUpdating$,this.titles$=this.service.titles$}onSubmit(){this.service.updateProfile()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(I))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cx-update-profile"]],hostAttrs:[1,"user-form"],decls:41,vars:49,consts:[["class","overlay",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"label-content"],["formControlName","titleCode","id","title-select",3,"clearable","searchable","cxNgSelectA11y"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["required","true","type","text","name","firstName","formControlName","firstName",1,"form-control",3,"placeholder"],[3,"control"],["required","true","type","text","name","lastName","formControlName","lastName",1,"form-control",3,"placeholder"],["required","true","type","text","name","customerId","formControlName","customerId","readonly","",1,"form-control"],[1,"btn","btn-block","btn-secondary",3,"routerLink"],[1,"btn","btn-block","btn-primary",3,"disabled"],[1,"overlay"]],template:function(o,r){1&o&&(e.YNc(0,pe,1,0,"cx-spinner",0),e.ALo(1,"async"),e.TgZ(2,"form",1),e.NdJ("ngSubmit",function(){return r.onSubmit()}),e.TgZ(3,"label")(4,"span",2),e._uU(5),e.ALo(6,"cxTranslate"),e.qZA(),e.TgZ(7,"ng-select",3),e.ALo(8,"cxTranslate"),e.TgZ(9,"ng-option",4),e._uU(10),e.ALo(11,"cxTranslate"),e.qZA(),e.YNc(12,me,2,2,"ng-option",5),e.ALo(13,"async"),e.qZA()(),e.TgZ(14,"label")(15,"span",2),e._uU(16),e.ALo(17,"cxTranslate"),e.qZA(),e._UZ(18,"input",6),e.ALo(19,"cxTranslate"),e._UZ(20,"cx-form-errors",7),e.qZA(),e.TgZ(21,"label")(22,"span",2),e._uU(23),e.ALo(24,"cxTranslate"),e.qZA(),e._UZ(25,"input",8),e.ALo(26,"cxTranslate"),e._UZ(27,"cx-form-errors",7),e.qZA(),e.TgZ(28,"label")(29,"span",2),e._uU(30),e.ALo(31,"cxTranslate"),e.qZA(),e._UZ(32,"input",9)(33,"cx-form-errors",7),e.qZA(),e.TgZ(34,"a",10),e.ALo(35,"cxUrl"),e._uU(36),e.ALo(37,"cxTranslate"),e.qZA(),e.TgZ(38,"button",11),e._uU(39),e.ALo(40,"cxTranslate"),e.qZA()()),2&o&&(e.Q6J("ngIf",e.lcZ(1,20,r.isUpdating$)),e.xp6(2),e.Q6J("formGroup",r.form),e.xp6(3),e.Oqu(e.lcZ(6,22,"updateProfileForm.title")),e.xp6(2),e.Q6J("clearable",!1)("searchable",!1)("cxNgSelectA11y",e.VKq(46,$,e.lcZ(8,24,"updateProfileForm.title"))),e.xp6(3),e.Oqu(e.lcZ(11,26,"updateProfileForm.none")),e.xp6(2),e.Q6J("ngForOf",e.lcZ(13,28,r.titles$)),e.xp6(4),e.Oqu(e.lcZ(17,30,"updateProfileForm.firstName.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(19,32,"updateProfileForm.firstName.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("firstName")),e.xp6(3),e.Oqu(e.lcZ(24,34,"updateProfileForm.lastName.label")),e.xp6(2),e.s9C("placeholder",e.lcZ(26,36,"updateProfileForm.lastName.placeholder")),e.xp6(2),e.Q6J("control",r.form.get("lastName")),e.xp6(3),e.Oqu(e.lcZ(31,38,"updateProfileForm.customerId")),e.xp6(3),e.Q6J("control",r.form.get("lastName")),e.xp6(1),e.Q6J("routerLink",e.lcZ(35,40,e.DdM(48,F))),e.xp6(2),e.hij(" ",e.lcZ(37,42,"common.cancel")," "),e.xp6(2),e.Q6J("disabled",r.form.disabled),e.xp6(1),e.hij(" ",e.lcZ(40,44,"common.save")," "))},dependencies:[p.sg,p.O5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.sg,i.u,l.ORR,l.Ahv,g.yS,P.w9,P.jq,l.VnX,p.Ov,s.X$D,s.l2T],encapsulation:2,changeDetection:0}),t})(),Se=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{UpdateProfileComponent:{component:Ze,guards:[s.a1M],providers:[{provide:I,useClass:I,deps:[f.aT,s.IWp]}]}}})],imports:[p.ez,i.u5,i.UX,l.Fme,s.LUR,l.Fym,g.Bz,s.bhT,P.A0,l.LcC]}),t})(),_e=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[xe,Se,Ae,Pe,ve,be,he]}),t})();var w=u(1737),Te=u(6787),D=u(8555);let Fe=(()=>{class t extends _{constructor(o,r,a,c,d,m,h){super(o,d),this.userRegisterFacade=o,this.command=r,this.store=a,this.cdcJSService=c,this.globalMessageService=d,this.authService=m,this.eventService=h,this.registerCommand=this.command.create(({user:C})=>this.cdcJSService.registerUserWithoutScreenSet(C)),this.loadUserTokenFailed$=this.eventService.get(Z.yB).pipe((0,A.U)(C=>!!C),(0,v.b)(C=>{if(C)throw new Error("User token failed to load.")})),this.isLoggedIn$=this.authService.isUserLoggedIn().pipe((0,L.h)(C=>C))}register(o){return o.firstName&&o.lastName&&o.uid&&o.password?this.cdcJSService.didLoad().pipe((0,v.b)(r=>{if(!r)throw this.globalMessageService.add({key:"errorHandlers.scriptFailedToLoad"},s.xUg.MSG_TYPE_ERROR),new Error("CDC script didn't load.")}),(0,U.w)(()=>this.registerCommand.execute({user:o})),(0,U.w)(r=>(0,Te.T)(this.loadUserTokenFailed$,this.isLoggedIn$).pipe((0,A.U)(()=>r)))):(0,w._)(`The provided user is not valid: ${o}`)}postRegisterMessage(){}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(f.zm),e.LFG(s.VDr),e.LFG(D.yh),e.LFG(Z.bF),e.LFG(s.IWp),e.LFG(s.e80),e.LFG(s.POd))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),Le=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{RegisterCustomerComponent:{providers:[{provide:_,useClass:Fe,deps:[f.zm,s.VDr,D.yh,Z.bF,s.IWp,s.e80,s.POd]}]}}})],imports:[p.ez,i.UX,g.Bz,s.bhT,s.LUR,l.Fme,l.Fym,P.A0,l.LcC]}),t})(),Me=(()=>{class t extends S{constructor(o,r,a,c,d){super(o,r,a,c),this.userPasswordService=o,this.routingService=r,this.authConfigService=a,this.globalMessage=c,this.cdcJsService=d,this.subscription=new J.w}requestEmail(){this.form.valid?(this.busy$.next(!0),this.subscription.add(this.cdcJsService.didLoad().subscribe(o=>{o?this.cdcJsService.resetPasswordWithoutScreenSet(this.form.value.userEmail).subscribe({next:r=>{this.busy$.next(!1),"OK"===r.status&&this.redirect()},error:()=>this.busy$.next(!1)}):(this.busy$.next(!1),this.globalMessage.add({key:"errorHandlers.scriptFailedToLoad"},s.xUg.MSG_TYPE_ERROR))}))):this.form.markAllAsTouched()}ngOnDestroy(){this.subscription.unsubscribe()}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(f.LL),e.LFG(s.Znh),e.LFG(s.dSP),e.LFG(s.IWp),e.LFG(Z.bF))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),Re=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)({cmsComponents:{ForgotPasswordComponent:{component:Y,providers:[{provide:S,useClass:Me,deps:[f.LL,s.Znh,s.dSP,s.IWp,Z.bF]}]}}})],imports:[p.ez,i.UX,g.Bz,s.bhT,s.LUR,l.Fym,l.Fme]}),t})(),Ee=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[Le,Re]}),t})();var Q=u(9309);const j=new e.OlP("UserProfileNormalizer"),Ie=new e.OlP("UserProfileSerializer"),De=(new e.OlP("UserSerializer"),new e.OlP("UserSignUpSerializer")),qe=new e.OlP("TitleNormalizer");class z{}let T=(()=>{class t{constructor(o){this.userProfileAdapter=o}update(o,r){return this.userProfileAdapter.update(o,r)}register(o){return this.userProfileAdapter.register(o)}registerGuest(o,r){return this.userProfileAdapter.registerGuest(o,r)}requestForgotPasswordEmail(o){return this.userProfileAdapter.requestForgotPasswordEmail(o)}resetPassword(o,r){return this.userProfileAdapter.resetPassword(o,r)}updateEmail(o,r,a){return this.userProfileAdapter.updateEmail(o,r,a)}updatePassword(o,r,a){return this.userProfileAdapter.updatePassword(o,r,a)}remove(o){return this.userProfileAdapter.close(o)}getTitles(){return this.userProfileAdapter.loadTitles()}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(z))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),X=(()=>{class t{constructor(o,r,a){this.userIdService=o,this.userProfileConnector=r,this.command=a,this.updateCommand=this.command.create(c=>this.userIdService.takeUserId(!0).pipe((0,U.w)(d=>this.userProfileConnector.updateEmail(d,c.password,c.newUid))),{strategy:s.flE.Queue})}update(o,r){return this.updateCommand.execute({password:o,newUid:r})}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(s.XBV),e.LFG(T),e.LFG(s.VDr))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),W=(()=>{class t{constructor(o,r,a){this.userProfileConnector=o,this.userIdService=r,this.command=a,this.updateCommand=this.command.create(c=>this.userIdService.takeUserId(!0).pipe((0,N.q)(1),(0,U.w)(d=>this.userProfileConnector.updatePassword(d,c.oldPassword,c.newPassword)))),this.resetCommand=this.command.create(c=>this.userProfileConnector.resetPassword(c.token,c.password)),this.requestForgotPasswordEmailCommand=this.command.create(c=>this.userProfileConnector.requestForgotPasswordEmail(c.email))}update(o,r){return this.updateCommand.execute({oldPassword:o,newPassword:r})}reset(o,r){return this.resetCommand.execute({token:o,password:r})}requestForgotPasswordEmail(o){return this.requestForgotPasswordEmailCommand.execute({email:o})}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(T),e.LFG(s.XBV),e.LFG(s.VDr))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),q=(()=>{class t{constructor(o,r,a,c,d,m,h){this.userAccountService=o,this.authService=r,this.userProfileConnector=a,this.eventService=c,this.userIdService=d,this.query=m,this.command=h,this.updateCommand=this.command.create(C=>this.userIdService.takeUserId(!0).pipe((0,U.w)(je=>this.userProfileConnector.update(je,C.details).pipe((0,v.b)(()=>{this.eventService.dispatch({user:C.details},Q.x7)})))),{strategy:s.flE.Queue}),this.closeCommand=this.command.create(()=>this.userIdService.takeUserId(!0).pipe((0,U.w)(C=>this.userProfileConnector.remove(C).pipe((0,v.b)(()=>this.authService.logout()))))),this.titleQuery=this.query.create(()=>this.userProfileConnector.getTitles(),{reloadOn:[s.QRE]})}get(){return this.userAccountService.get()}update(o){return this.updateCommand.execute({details:o})}close(){return this.closeCommand.execute(void 0)}getTitles(){return this.titleQuery.get().pipe((0,A.U)(o=>o??[]))}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(Q.gf),e.LFG(s.e80),e.LFG(T),e.LFG(s.POd),e.LFG(s.XBV),e.LFG(s._7J),e.LFG(s.VDr))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),B=(()=>{class t{constructor(o,r,a,c,d){this.userProfile=o,this.userConnector=r,this.authService=a,this.command=c,this.store=d,this.registerCommand=this.command.create(({user:m})=>this.userConnector.register(m).pipe((0,v.b)(()=>{this.store.dispatch(new s.EJN.RegisterUserSuccess)}))),this.registerGuestCommand=this.command.create(m=>this.userConnector.registerGuest(m.guid,m.password).pipe((0,v.b)(h=>{this.authService.loginWithCredentials(h.uid,m.password)})))}register(o){return this.registerCommand.execute({user:o})}registerGuest(o,r){return this.registerGuestCommand.execute({guid:o,password:r})}getTitles(){return this.userProfile.getTitles()}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(q),e.LFG(T),e.LFG(s.e80),e.LFG(s.VDr),e.LFG(D.yh))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})();const ke=[X,W,q,B,{provide:f.PF,useExisting:X},{provide:f.LL,useExisting:W},{provide:f.aT,useExisting:q},{provide:f.zm,useExisting:B}];let Je=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[T,...ke]}),t})();var x=u(529),b=u(7221);const Oe={backend:{occ:{endpoints:{userRegister:"users",userForgotPassword:"forgottenpasswordtokens",userResetPassword:"resetpassword",userUpdateLoginId:"users/${userId}/login",userUpdatePassword:"users/${userId}/password",titles:"titles"}}}};let Ne=(()=>{class t{constructor(o,r,a){this.http=o,this.occEndpoints=r,this.converter=a}update(o,r){const a=this.occEndpoints.isConfigured("userUpdateProfile")?"userUpdateProfile":"user",c=this.occEndpoints.buildUrl(a,{urlParams:{userId:o}});return r=this.converter.convert(r,Ie),this.http.patch(c,r).pipe((0,b.K)(d=>(0,w._)((0,s.cxH)(d))))}register(o){const r=this.occEndpoints.buildUrl("userRegister");let a=new x.WM({"Content-Type":"application/json"});return a=s.Fox.createHeader(s._Re,!0,a),o=this.converter.convert(o,De),this.http.post(r,o,{headers:a}).pipe((0,b.K)(c=>(0,w._)((0,s.cxH)(c))),this.converter.pipeable(j))}registerGuest(o,r){const a=this.occEndpoints.buildUrl("userRegister");let c=new x.WM({"Content-Type":"application/x-www-form-urlencoded"});c=s.Fox.createHeader(s._Re,!0,c);const d=(new x.LE).set("guid",o).set("password",r);return this.http.post(a,d,{headers:c}).pipe((0,b.K)(m=>(0,w._)((0,s.cxH)(m))),this.converter.pipeable(j))}requestForgotPasswordEmail(o){const r=this.occEndpoints.buildUrl("userForgotPassword"),a=(new x.LE).set("userId",o);let c=new x.WM({"Content-Type":"application/x-www-form-urlencoded"});return c=s.Fox.createHeader(s._Re,!0,c),this.http.post(r,a,{headers:c}).pipe((0,b.K)(d=>(0,w._)((0,s.cxH)(d))))}resetPassword(o,r){const a=this.occEndpoints.buildUrl("userResetPassword");let c=new x.WM({"Content-Type":"application/json"});return c=s.Fox.createHeader(s._Re,!0,c),this.http.post(a,{token:o,newPassword:r},{headers:c}).pipe((0,b.K)(d=>(0,w._)((0,s.cxH)(d))))}updateEmail(o,r,a){const c=this.occEndpoints.buildUrl("userUpdateLoginId",{urlParams:{userId:o}}),d=(new x.LE).set("password",r).set("newLogin",a),m=new x.WM({"Content-Type":"application/x-www-form-urlencoded"});return this.http.put(c,d,{headers:m}).pipe((0,b.K)(h=>(0,w._)((0,s.cxH)(h))))}updatePassword(o,r,a){const c=this.occEndpoints.buildUrl("userUpdatePassword",{urlParams:{userId:o}}),d=(new x.LE).set("old",r).set("new",a),m=new x.WM({"Content-Type":"application/x-www-form-urlencoded"});return this.http.put(c,d,{headers:m}).pipe((0,b.K)(h=>(0,w._)((0,s.cxH)(h))))}close(o){const r=this.occEndpoints.isConfigured("userCloseAccount")?"userCloseAccount":"user",a=this.occEndpoints.buildUrl(r,{urlParams:{userId:o}});return this.http.delete(a).pipe((0,b.K)(c=>(0,w._)((0,s.cxH)(c))))}loadTitles(){const o=this.occEndpoints.buildUrl("titles");return this.http.get(o).pipe((0,b.K)(r=>(0,w._)((0,s.cxH)(r))),(0,A.U)(r=>r.titles??[]),this.converter.pipeableMany(qe))}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(x.eN),e.LFG(s.Lz0),e.LFG(s.IXI))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),Ge=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[(0,s.i51)(Oe),{provide:z,useClass:Ne}]}),t})(),$e=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[Je,Ge,_e]}),t})();var Ye=u(988);const V=[];Ye.N.cdc&&V.push(Ee);let Qe=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[$e,V]}),t})()}}]);